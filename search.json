[{"path":"https://rodrigozepeda.github.io/diseasenowcasting/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2024 Columbia University City New York Permission hereby granted, free charge, person obtaining copy software associated documentation files (‚ÄúSoftware‚Äù), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED ‚Äú‚Äù, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://rodrigozepeda.github.io/diseasenowcasting/articles/Comparison-to-other-methods.html","id":"nobbs","dir":"Articles","previous_headings":"","what":"NobBS","title":"Comparison to other methods","text":"reproduce example README.md file: compare diseasenowcasting package: , formating, Result better prediction NobBS default one:","code":"library(NobBS) data(\"denguedat\") now <- as.Date(\"1990-10-01\")  test_nowcast <- NobBS(data = denguedat, units = \"1 week\", now = now,                       onset_date = \"onset_week\", report_date = \"report_week\") #> Computing a nowcast for  1990-10-01 library(diseasenowcasting) library(posterior) #> This is posterior version 1.6.0 #>  #> Attaching package: 'posterior' #> The following objects are masked from 'package:stats': #>  #>     mad, sd, var #> The following objects are masked from 'package:base': #>  #>     %in%, match library(tidyverse) #> ‚îÄ‚îÄ Attaching core tidyverse packages ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ tidyverse 2.0.0 ‚îÄ‚îÄ #> ‚úî dplyr     1.1.4     ‚úî readr     2.1.5 #> ‚úî forcats   1.0.0     ‚úî stringr   1.5.1 #> ‚úî ggplot2   3.5.1     ‚úî tibble    3.2.1 #> ‚úî lubridate 1.9.3     ‚úî tidyr     1.3.1 #> ‚úî purrr     1.0.2 #> ‚îÄ‚îÄ Conflicts ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ tidyverse_conflicts() ‚îÄ‚îÄ #> ‚úñ dplyr::filter() masks stats::filter() #> ‚úñ dplyr::lag()    masks stats::lag() #> ‚Ñπ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors  predictions <- nowcast(denguedat, \"onset_week\", \"report_week\",                        now = now, method = \"variational\",                        priors = set_priors(nu_is_constant = F)) #> ‚Ñπ Computing a nowcast for 1990-10-01 per \"weeks\" #> ‚Ñπ Assuming data is linelist-data where each observation is a test. If you are working with count-data set `data_type = \"count\"` #> Warning: Pareto k diagnostic value is 3.33. Resampling is disabled. Decreasing #> tol_rel_obj may help if variational algorithm has terminated prematurely. #> Otherwise consider using sampling instead. #Get the predicted values in a nice format predicted_values <- predictions$generated_quantities |>   posterior::as_draws() |>   posterior::subset_draws(\"N_predict\") |>   posterior::summarise_draws() |>   dplyr::mutate(.strata = as.numeric(stringr::str_remove_all(variable,\".*\\\\[.*,|\\\\]\"))) |>   dplyr::mutate(.tval = as.numeric(stringr::str_remove_all(variable,\".*\\\\[|,.*\\\\]\"))) |>   dplyr::left_join(     predictions$data$preprocessed_data |>       dplyr::distinct(.tval, onset_week)   ) #> Joining with `by = join_by(.tval)`  obs <- predictions$data$preprocessed_data |>   dplyr::group_by(onset_week) |>   dplyr::summarise(n = sum(n)) # Create plot ggplot() +   geom_ribbon(aes(x = onset_week, ymin = q5, ymax = q95, fill = \"diseasenowcasting\"),               data = predicted_values, alpha = 0.25) +   geom_ribbon(aes(x = onset_date, ymin = lower, ymax = upper, fill = \"NobBS\"),               data = test_nowcast$estimates, alpha = 0.25) +   geom_line(aes(x = onset_week, y = n, color = \"Train data\", fill = \"Train data\"), data = obs) +   geom_line(aes(x = onset_week, y = mean, color = \"diseasenowcasting\"),             data = predicted_values, linetype = \"dotted\") +   geom_line(aes(x = onset_date, y = estimate, color = \"NobBS\"), data = test_nowcast$estimates) +   geom_point(aes(x = onset_week, y = n, color = \"All data\", fill = \"All data\"), data =               denguedat |>                dplyr::group_by(onset_week) |>                dplyr::count() |>                dplyr::filter(onset_week <= !!now)) +   theme_bw() +   scale_color_manual(\"Package\",         values = c(\"NobBS\" = \"#3B9AB2\", \"diseasenowcasting\" = \"#E1AF00\",                    \"All data\" = \"#F21A00\",                    \"Train data\" = \"black\")) +   scale_fill_manual(\"Package\",         values = c(\"NobBS\" = \"#3B9AB2\", \"diseasenowcasting\" = \"#E1AF00\",                    \"All data\" = \"#F21A00\",                    \"Train data\" = \"black\"))"},{"path":"https://rodrigozepeda.github.io/diseasenowcasting/articles/Nowcasting-methods.html","id":"intuitive-explanation","dir":"Articles","previous_headings":"","what":"Intuitive explanation","title":"Nowcasting methods","text":"consider problem reporting number cases certain disease. Results disease‚Äôs tests reported delay. day see disease-cases day; disease-cases day reported upcoming days. Delay ladder shows day reports come subsequent days thus forming ladder. Figure 1 shows idea assume maximum delay corresponds 66 days. can see today, April 11th, data April 2nd already arrived: data arrived zero delay (report Apr.¬†2) well data arrived delay 11 (report Apr.¬†3), 22 (report Apr.¬†4), 33 (report Apr.¬†5), etc data reported April 8th maximum delay 6. dates data yet arrived. can see April 9th see data delay 0 till 3 (corresponding April 11th). Data delay larger 3 seen future. idea model predict number cases seen time tt denoted ntn_{t} sum delayed cases. includes cases ‚Äôve already observed nt,dn_{t,d} cases haven‚Äôt yet observed nÃÉt,d\\tilde{n}_{t,d}. number cases time tt, ntn_t can decomposed observed delays 00 (delay), 1,2,31,2,3, nt,0,nt,1,nt,2,nt,3n_{t,0},n_{t,1},n_{t,2},n_{t,3} predicted delays 4,5,64,5,6: nt,4,nt,5,nt,6n_{t,4},n_{t,5},n_{t,6} main objective model nt,dn_{t,d}, number cases time tt appear delay dd. actually model log expected value nt,dn_{t,d}, denoted ‚Ñìt,d\\ell_{t,d}. average variable driven process composed two elements: time-dependent process delay-time-dependent process. can think time-dependent process process drives epidemic curve delay-time-dependent process process drives testing (changes testing). log expected number cases time tt reported delay dd, ‚Ñìt,d\\ell_{t,d} function time-dependent process Œºt\\mu_t delay-time-dependent process ŒΩt,d\\nu_{t,d}. processes can decomposed trend, season (multiple seasons), cycle: decomposition time-dependent process Œºt\\mu_t. delay-time-dependent process ŒΩt,d\\nu_{t,d} decomposed similar fashion. model thus captures seasonality epidemic curve delay curve well trends noise.","code":""},{"path":"https://rodrigozepeda.github.io/diseasenowcasting/articles/Nowcasting-methods.html","id":"mathematical-explanation","dir":"Articles","previous_headings":"","what":"Mathematical explanation","title":"Nowcasting methods","text":"Let nt,dsn_{t,d}^s denote number incident cases (individuals) stratum ss (say race/gender) time tt reported delay dd. , nt,0n_{t,0} denotes number individuals diseased time tt reported moment tt, nt,1n_{t,1} number individuals diseased time tt reported moment t+1t + 1 general nt,dn_{t,d} number individuals diseased time tt reported moment t+dt + d. assume expected value nt,dsn_{t,d}^s given : ùîº[nt,ds]=Œªt,ds \\mathbb{E}\\left[n_{t,d}^s\\right] = \\lambda_{t,d}^s  ‚Ñìt,ds=lnŒªt,ds\\ell_{t,d}^s = \\ln\\lambda_{t,d}^s follows linear state-space model covariates (see Durbin Koopman (2012)): ‚Ñìt,ds=LŒº‚ãÖŒºts+LdŒΩ‚ãÖŒΩt,ds+Bd‚ãÖXt,ds+œµt,dsŒºt+1s=AŒºŒºts+RŒºŒæts,Œº(time-dependent process)ŒΩt+1,ds=AdŒΩŒΩt,ds+RdŒΩŒæt,ds,ŒΩ(delay-dependent process)\\begin{equation} \\begin{aligned}   \\ell_{t,d}^s & = L^{\\mu} \\cdot \\mu_{t}^s + L_{d}^{\\nu}  \\cdot \\nu_{t,d}^s + B_{d}  \\cdot X_{t,d}^s + \\epsilon_{t,d}^s \\\\   \\mu_{t+1}^s & = ^{\\mu} \\mu_{t}^s + R^{\\mu} \\xi_{t}^{s,\\mu} \\quad & \\text{(time-dependent process)}\\\\   \\nu_{t+1,d}^s & = A_{d}^{\\nu}\\nu_{t,d}^s + R_d^{\\nu} \\xi_{t,d}^{s,\\nu} \\quad & \\text{(delay-dependent process)}\\\\ \\end{aligned}   \\end{equation} Œºts\\mu_{t}^s represents time-dependent latent process ŒΩt,ds\\nu_{t,d}^s delay-dependent latent process. system defined t=1,‚Ä¶,Tt = 1,\\dots, T (time), d=0,‚Ä¶,Dd = 0,\\dots, D (delays) s=1,‚Ä¶,Ss = 1,\\dots,S (strata). Table 1 describes variables dimensions. Dimensions variables. model, AŒºA^{\\mu},AdŒΩA_{d}^{\\nu}, RŒºR^{\\mu},RdŒΩR_d^{\\nu},LŒºL^{\\mu}, LdŒΩL_d^{\\nu} given. Variables œµt,ds\\epsilon_{t,d}^s, Œæts,Œº\\xi_{t}^{s,\\mu}, Œæt,ds,ŒΩ\\xi_{t,d}^{s,\\nu} represent random (correlated) noise; Xt,dsX_{t,d}^s vector known covariates, BdB_d vector unknown parameters. Additionally, Œº0\\mu_{0} ŒΩ0,d\\nu_{0,d} also unknown parameters. total number incident cases stratum ss expected time tt given : nts=‚àëd=0‚àûnt,ds=nt,D+s+‚àëd=0Dnt,ds‚âà‚àëd=0Dnt,ds\\begin{equation} n_t^s = \\sum\\limits_{d = 0}^{\\infty} n_{t,d}^s = n_{t,D+}^s  + \\sum\\limits_{d = 0}^{D} n_{t,d}^s \\approx \\sum\\limits_{d = 0}^{D} n_{t,d}^s \\end{equation} time tt, predicted number cases delay dd stratum ss denoted nÃÉt,ds\\tilde{n}_{t,d}^s. Finally, predicted number cases (nowcasted cases) stratum ss time tt estimated : nÃÉts=‚àëd=0d*nt,ds‚èüAlready observed+‚àëd=d*+1DnÃÉt,ds‚èüPredicted\\begin{equation} \\tilde{n}_t^s =  \\underbrace{\\sum\\limits_{d = 0}^{d^{*}} n_{t,d}^s}_{\\text{Already observed}}  + \\underbrace{\\sum\\limits_{d = d^{*} + 1}^{D} \\tilde{n}_{t,d}^s}_{\\text{Predicted}}  \\end{equation} d*d^* denotes latest delay observed current data. add option zero-inflation","code":""},{"path":"https://rodrigozepeda.github.io/diseasenowcasting/articles/Nowcasting-methods.html","id":"construction-of-the-l_d-a_d-mu_ts-and-nu_tds","dir":"Articles","previous_headings":"Mathematical explanation","what":"Construction of the LdL_{d}, AdA_{d}, Œºts\\mu_{t}^s, and ŒΩt,ds\\nu_{t,d}^s","title":"Nowcasting methods","text":"LŒºL^{\\mu}, LdŒΩL_d^{\\nu}, AŒºA^{\\mu}, AdŒΩA_{d}^{\\nu}, RŒºR^{\\mu}, RdŒΩR_{d}^{\\nu}, Œºts\\mu_{t}^s, ŒΩt,ds\\nu_{t,d}^s matrices can constructed blocks. follows ‚Äôll show construction works general matrices Œ±‚Üít,ds\\vec{\\alpha}_{t,d}^s, LdL_{d}, AdA_d, RdR_{d} stand either ŒΩt,ds\\nu_{t,d}^s , LdŒΩL_d^{\\nu}, AdŒΩA_{d}^{\\nu} RdŒΩR_{d}^{\\nu}; Œºts\\mu_{t}^s, LŒºL^{\\mu}, AŒºA^{\\mu} RŒºR^{\\mu}. general idea vectors Œ±‚Üít,ds\\vec{\\alpha}_{t,d}^s LdL_{d}, matrices AdA_d RdR_{d} can constructed three blocks: trend, seasonality, cyclical component: Ld=(LdTrend,LdSeason,LdCycle)‚ä§,Ad=diag(AdTrend,AdSeason,AdCycle),Rd=diag(RdTrend,RdSeason,RdCycle), andŒ±‚Üít,ds=(Œ±t,ds,Trend,Œ±t,ds,Season,Œ±t,ds,Cycle)‚ä§.\\begin{equation} \\begin{aligned} L_{d} & = \\left(L_{d}^{\\text{Trend}}, L_{d}^{\\text{Season}}, L_{d}^{\\text{Cycle}} \\right)^{\\top}, \\\\ A_{d} & = \\text{diag}\\left(A_{d}^{\\text{Trend}}, A_{d}^{\\text{Season}}, A_{d}^{\\text{Cycle}}\\right),\\\\ R_{d} & = \\text{diag}\\left(R_{d}^{\\text{Trend}}, R_{d}^{\\text{Season}}, R_{d}^{\\text{Cycle}}\\right), \\text{ } \\\\  \\vec{\\alpha}_{t,d}^s & = \\left(\\alpha_{t,d}^{s,\\text{Trend}}, \\alpha_{t,d}^{s,\\text{Season}}, \\alpha_{t,d}^{s,\\text{Cycle}} \\right)^{\\top}. \\end{aligned} \\end{equation} notation, section model specified empty block considered. example, model without seasonality might following LdL_d: Ld=(LdTrend,LdCycle)‚ä§ L_{d} = \\left(L_{d}^{\\text{Trend}}, L_{d}^{\\text{Cycle}} \\right)^{\\top}  definitions Ad,RdA_{d}, R_{d}, Œ±t,ds\\alpha_{t,d}^s case follow pattern. trend describes general direction ‚Ñìt,ds\\ell_{t,d}^s. three trend options: Constant Local linear trend Local trend degree kk constant trend model given : ‚Ñìt,ds=Œ±t,ds+œµt,dsŒ±t+1,ds=Œ±t,ds\\begin{equation} \\begin{aligned} \\ell_{t,d}^s & = \\alpha_{t,d}^s + \\epsilon_{t,d}^s \\\\ \\alpha_{t+1,d}^s & = \\alpha_{t,d}^s \\\\ \\end{aligned}   \\end{equation} case LdTrend=1L_{d}^{\\text{Trend}} = 1, Œ±t,ds,Trend=Œ±t,ds\\alpha_{t,d}^{s,\\text{Trend}} = \\alpha_{t,d}^s, AdTrend=1A_{d}^{\\text{Trend}} = 1, Rd=0R_d = 0. simplest local linear trend model given : ‚Ñìt,ds=Œ±t,ds+œµt,dsŒΩt+1,ds=ŒΩt,ds+RdŒæt,ds\\begin{equation} \\begin{aligned} \\ell_{t,d}^s & = \\alpha_{t,d}^s  + \\epsilon_{t,d}^s \\\\ \\nu_{t+1,d}^s & = \\nu_{t,d}^s + R_d \\xi_{t,d}^s \\end{aligned}   \\end{equation} case LdTrend=1L_{d}^{\\text{Trend}} = 1, Œ±t,ds,Trend=Œ±t,ds\\alpha_{t,d}^{s,\\text{Trend}} = \\alpha_{t,d}^s, AdTrend=1A_{d}^{\\text{Trend}} = 1, RdTrend‚àà{0,1}R_d^{\\text{Trend}} \\\\{0,1\\}. Notice Rd=0R_d = 0 recover constant trend model. general (smoothing purposes), can adjust local linear trend degree kk fitting model: ‚Ñìt,ds=Œ±t,ds+œµt,dsŒîkŒ±t+1,ds=RdŒæt,ds\\begin{equation} \\begin{aligned} \\ell_{t,d}^s & = \\alpha_{t,d}^s + \\epsilon_{t,d}^s \\\\ \\Delta^{k} \\alpha_{t+1,d}^s & = R_d\\xi_{t,d}^s \\end{aligned}   \\end{equation} ŒîŒ±t+1=Œ±t+1‚àíŒ±t\\Delta \\alpha_{t+1} = \\alpha_{t+1} - \\alpha_{t} general ŒîkŒ±t+1=Œî(Œîk‚àí1Œ±t+1)\\Delta^k \\alpha_{t+1} = \\Delta\\big(\\Delta^{k-1} \\alpha_{t+1}\\big). model can rewritten using general formula higher order (backward) differences : ‚Ñìt,ds=Œ±t,ds+œµt,dsŒ±t+1,ds=‚àëj=1k(‚àí1)j+1(kj)Œ±t‚àíj,ds+RdŒæt,ds\\begin{equation} \\begin{aligned} \\ell_{t,d}^s & = \\alpha_{t,d}^s + \\epsilon_{t,d}^s \\\\ \\alpha_{t+1,d}^s & = \\sum\\limits_{j=1}^{k} (-1)^{j+1} \\binom{k}{j} \\alpha_{t - j,d}^s  + R_d\\xi_{t,d}^s \\end{aligned}   \\end{equation} Œ±t,ds,Trend=(Œ±ts,Œ±t‚àí1s,‚Ä¶,Œ±t‚àí(k‚àí1)s)‚ä§\\alpha_{t,d}^{s,\\text{Trend}} = (\\alpha_t^s,\\alpha_{t-1}^s,\\dots,\\alpha_{t-(k-1)}^s)^{\\top}, RdTrend=diag(1,0,0,‚Ä¶,0)R_d^{\\text{Trend}} = \\textrm{diag}(1,0,0,\\dots,0), LdTrend=(1,0,0,‚Ä¶,0)‚ä§L_{d}^{\\text{Trend}} = (1, 0, 0, \\dots, 0)^{\\top} vector zeroes one first entry, AdTrend=((k1)‚àí(k2)‚Ä¶(‚àí1)j+1(kj)‚Ä¶(‚àí1)k(kk‚àí1)(‚àí1)k+1(kk)10‚Ä¶0‚Ä¶0001‚Ä¶0‚Ä¶00‚ãÆ00‚Ä¶0‚Ä¶10) A_{d}^{\\text{Trend}} = \\begin{pmatrix} \\binom{k}{1} &  -\\binom{k}{2} & \\dots & (-1)^{j + 1} \\binom{k}{j} & \\dots & (-1)^{k} \\binom{k}{k-1} & (-1)^{k + 1} \\binom{k}{k} \\\\ 1 &  0 & \\dots & 0 & \\dots & 0 & 0\\\\ 0 & 1 & \\dots & 0 & \\dots & 0 & 0\\\\ \\vdots & & & \\\\ 0 & 0 & \\dots & 0 & \\dots & 1 & 0\\\\ \\end{pmatrix} Delvelopers Local trend degree kk encompasses constant trend Rd=0R_d = 0 local linear trend k=1k = 1 Rd=1R_d = 1. general option one programmed. two types seasonality considered model: Discrete Trigonometric assume zz given seasons length ll. example tt represents days can z=52z = 52 (weekly) seasons length 77 (week contains 77 days). represented following baseline model: ‚Ñìt,ds=Œ±t,ds+œµt,dsŒ≥k+1,ds=‚àí‚àëj=1z‚àí1Œ≥k+1‚àíj,ds+wkŒ±t+1,ds=Œ≥‚åàt+1l‚åâ,ds\\begin{equation} \\begin{aligned} \\ell_{t,d}^s & = \\alpha_{t,d}^s + \\epsilon_{t,d}^s \\\\ \\gamma_{k+1,d}^s & = - \\sum\\limits_{j=1}^{z-1} \\gamma_{k+1-j, d}^s + w_k\\\\ \\alpha_{t+1,d}^s & = \\gamma_{\\lceil \\frac{t+1}{l} \\rceil,d}^s \\end{aligned}   \\end{equation} wkw_k gaussian white noise. expression can represented matrix form LdSeason=(1,0,0,‚Ä¶,0)‚ä§L_{d}^{\\text{Season}} = (1,0,0,\\dots,0)^{\\top} Rd=(0,0,‚Ä¶,0,rt)‚ä§R_d = (0, 0, \\dots, 0,r_t)^{\\top} rt=1r_t = 1 tl\\frac{t}{l} integer 00 otherwise. vector Œ±t,ds,Season\\alpha_{t,d}^{s,\\text{Season}} length zl+1z l + 1. defined initially tt ‚åàt/l‚åâ=z\\lceil t/l \\rceil = z Œ±t,ds,Season=(Œ≥z,Œ≥z,‚Ä¶,Œ≥z‚èül times,Œ≥z‚àí1,Œ≥z‚àí1,‚Ä¶,Œ≥z‚àí1‚èül times,‚Ä¶Œ≥1,‚Ä¶,Œ≥1‚èül times,w1)‚ä§. \\alpha_{t,d}^{s,\\text{Season}} = \\Big( \\underbrace{\\gamma_{z}, \\gamma_{z}, \\dots,  \\gamma_{z}}_{l\\text{ times}},  \\underbrace{\\gamma_{z-1}, \\gamma_{z-1},\\dots,\\gamma_{z-1}}_{l\\text{ times}}, \\dots \\underbrace{\\gamma_{1}, \\dots, \\gamma_{1}}_{l\\text{ times}}, w_1 \\Big)^{\\top}. Matrix AdSeasonA_d^{\\text{Season}} given following expression: Ad=(000‚Ä¶‚àí100‚Ä¶‚àí100‚Ä¶‚àí100‚Ä¶001100‚Ä¶000‚Ä¶000‚Ä¶000‚Ä¶000010‚Ä¶000‚Ä¶000‚Ä¶000‚Ä¶000001‚Ä¶000‚Ä¶000‚Ä¶000‚Ä¶000‚ãÆ‚ãÆ‚ãÆ000‚Ä¶000‚Ä¶000‚Ä¶000‚Ä¶100000‚Ä¶000‚Ä¶000‚Ä¶000‚Ä¶001) A_d = \\begin{pmatrix} 0 & 0 & 0 & \\dots & -1 & 0  & 0 & \\dots & -1 & 0 & 0 & \\dots & -1 & 0 & 0 & \\dots & 0 & 0 & 1\\\\ 1 & 0 & 0 & \\dots & 0 & 0 & 0 & \\dots & 0 & 0 & 0 & \\dots & 0 & 0 & 0 & \\dots & 0 & 0 & 0 \\\\ 0 & 1 & 0 & \\dots & 0 & 0 & 0 & \\dots & 0 & 0 & 0 & \\dots & 0 & 0 & 0 & \\dots & 0 & 0 & 0 \\\\ 0 & 0 & 1 & \\dots & 0 & 0 & 0 & \\dots & 0 & 0 & 0 & \\dots & 0 & 0 & 0 & \\dots & 0 & 0 & 0 \\\\ \\vdots & &&& &&&& \\vdots &&&&&& \\vdots\\\\ 0 & 0 & 0 & \\dots & 0 & 0 & 0 & \\dots & 0 & 0 & 0 & \\dots & 0 & 0 & 0 & \\dots & 1 & 0 & 0\\\\ 0 & 0 & 0 & \\dots & 0 & 0 & 0 & \\dots & 0 & 0 & 0 & \\dots & 0 & 0 & 0 & \\dots & 0 & 0 & 1\\\\ \\end{pmatrix}  first row AdA_d ‚àí1-1 every llth column starting column ll column l√ó(z‚àí1)l\\times (z-1). last entry first row AdA_d 11. rest entries, AdA_d zeroes except entries Ai,‚àí1A_{,-1} (>1i > 1) value 11. last entry last row column AdA_d also 11. Consider seasonality z=3z = 3 seasons length l=2l = 2. Œ±6=(Œ≥3,Œ≥3,Œ≥2,Œ≥2,Œ≥1,Œ≥1,0)‚ä§ \\alpha_6 = (\\gamma_3, \\gamma_3, \\gamma_2, \\gamma_2, \\gamma_1, \\gamma_1, 0)^{\\top}  Ad=(0‚àí10‚àí1001100000001000000010000000100000001000000001) A_d = \\begin{pmatrix} 0 & -1 & 0 & -1 & 0 & 0 & 1\\\\ 1 & 0 & 0 & 0 & 0 & 0 & 0 \\\\ 0 & 1 & 0 & 0 & 0 & 0 & 0 \\\\ 0 & 0 & 1 & 0 & 0 & 0 & 0 \\\\ 0 & 0 & 0 & 1 & 0 & 0 & 0 \\\\ 0 & 0 & 0 & 0 & 1 & 0 & 0 \\\\ 0 & 0 & 0 & 0 & 0 & 0 & 1 \\\\ \\end{pmatrix}  : Œ±7=(0‚àí10‚àí1001100000001000000010000000100000001000000001)‚èüAd(Œ≥3Œ≥3Œ≥2Œ≥2Œ≥1Œ≥1w1)‚èüŒ±6+(0000000)‚èüRdŒæ6,d=(‚àíŒ≥3‚àíŒ≥2+w1Œ≥3Œ≥3Œ≥2Œ≥2Œ≥1w1) \\alpha_7 =\\underbrace{\\begin{pmatrix} 0 & -1 & 0 & -1 & 0 & 0 & 1\\\\ 1 & 0 & 0 & 0 & 0 & 0 & 0 \\\\ 0 & 1 & 0 & 0 & 0 & 0 & 0 \\\\ 0 & 0 & 1 & 0 & 0 & 0 & 0 \\\\ 0 & 0 & 0 & 1 & 0 & 0 & 0 \\\\ 0 & 0 & 0 & 0 & 1 & 0 & 0 \\\\ 0 & 0 & 0 & 0 & 0 & 0 & 1 \\\\ \\end{pmatrix}}_{A_d} \\underbrace{\\begin{pmatrix} \\gamma_3\\\\  \\gamma_3\\\\  \\gamma_2\\\\  \\gamma_2\\\\  \\gamma_1\\\\  \\gamma_1\\\\ w_1  \\end{pmatrix}}_{ \\alpha_6} + \\underbrace{\\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ \\end{pmatrix}}_{R_d} \\xi_{6,d} = \\begin{pmatrix} -\\gamma_3 - \\gamma_2 + w_1\\\\  \\gamma_3\\\\  \\gamma_3\\\\  \\gamma_2\\\\  \\gamma_2\\\\  \\gamma_1\\\\  w_1  \\end{pmatrix}  Substituting Œ≥4=‚àíŒ≥3‚àíŒ≥2+w1\\gamma_4 = -\\gamma_3 - \\gamma_2 + w_1 obtain next component : Œ±8=(0‚àí10‚àí1001100000001000000010000000100000001000000001)(Œ≥4Œ≥3Œ≥3Œ≥2Œ≥2Œ≥1w1)+(0000001)‚èüRdŒæ7,d=(‚àíŒ≥3‚àíŒ≥2+w1Œ≥4Œ≥3Œ≥3Œ≥2Œ≥2w1+Œæ7,d) \\alpha_8 =\\begin{pmatrix} 0 & -1 & 0 & -1 & 0 & 0 & 1\\\\ 1 & 0 & 0 & 0 & 0 & 0 & 0 \\\\ 0 & 1 & 0 & 0 & 0 & 0 & 0 \\\\ 0 & 0 & 1 & 0 & 0 & 0 & 0 \\\\ 0 & 0 & 0 & 1 & 0 & 0 & 0 \\\\ 0 & 0 & 0 & 0 & 1 & 0 & 0 \\\\ 0 & 0 & 0 & 0 & 0 & 0 & 1 \\\\ \\end{pmatrix} \\begin{pmatrix} \\gamma_4 \\\\  \\gamma_3\\\\  \\gamma_3\\\\  \\gamma_2\\\\  \\gamma_2\\\\  \\gamma_1\\\\  w_1  \\end{pmatrix} + \\underbrace{\\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 1 \\\\ \\end{pmatrix}}_{R_d} \\xi_{7,d} = \\begin{pmatrix} -\\gamma_3 - \\gamma_2 + w_1\\\\  \\gamma_4 \\\\ \\gamma_3\\\\  \\gamma_3\\\\  \\gamma_2\\\\  \\gamma_2\\\\  w_1 + \\xi_{7,d} \\end{pmatrix}  defining w2=w1+Œæ7,dw_2 = w_1 + \\xi_{7,d} using fact sum independent gaussians independent one summands recover original expression. different approach use harmonic functions. particular, let ll define period (number time frames cycle) define Œªk=2œÄkl\\lambda_k = \\frac{2\\pi k}{l} use following baseline model ‚Ñìt,ds=Œ±t,ds+œµt,dsŒ±t,ds=‚àëj=1‚åäl2‚åãŒ≥t,ds,jŒ≥t,ds,j=Œ≥t‚àí1,ds,jcosŒªj+Œ≥ÃÉt,ds,jsinŒªj+wt,ds,jŒ≥ÃÉt,ds,j=‚àíŒ≥t‚àí1,ds,jsinŒªj+Œ≥ÃÉt,ds,jcosŒªj+wÃÉt,ds,j\\begin{equation} \\begin{aligned} \\ell_{t,d}^s & = \\alpha_{t,d}^s + \\epsilon_{t,d}^s \\\\ \\alpha_{t,d}^s & = \\sum\\limits_{j=1}^{\\lfloor \\frac{l}{2} \\rfloor} \\gamma_{t,d}^{s,j}\\\\ \\gamma_{t,d}^{s,j} & = \\gamma_{t-1,d}^{s,j}\\cos\\lambda_j + \\tilde{\\gamma}_{t,d}^{s,j}\\sin\\lambda_j + w_{t,d}^{s,j}\\\\ \\tilde{\\gamma}_{t,d}^{s,j} & = -\\gamma_{t-1,d}^{s,j}\\sin\\lambda_j + \\tilde{\\gamma}_{t,d}^{s,j}\\cos\\lambda_j + \\tilde{w}_{t,d}^{s,j}\\\\ \\end{aligned}   \\end{equation} Following Durbin Koopman (2012) can write: Œ±t,ds=(Œ≥t,ds,1,Œ≥ÃÉt,ds,1,Œ≥t,ds,2,Œ≥ÃÉt,ds,2,‚Ä¶,Œ≥t,ds,l,Œ≥ÃÉt,ds,l)‚ä§ \\alpha_{t,d}^s = (\\gamma_{t,d}^{s,1},\\tilde{\\gamma}_{t,d}^{s,1},\\gamma_{t,d}^{s,2},\\tilde{\\gamma}_{t,d}^{s,2},\\dots, \\gamma_{t,d}^{s,l},\\tilde{\\gamma}_{t,d}^{s,l})^{\\top}  Ld=(1,0,1,0,1,0,‚Ä¶)‚ä§L_d = (1,0,1,0,1,0,\\dots)^{\\top}, Rd=Il‚àí1R_d = I_{l-1} identity, Ad={diag(C1,C2,‚Ä¶,Cl*,‚àí1)l even,diag(C1,C2,‚Ä¶,Cl*)l odd. A_d = \\begin{cases} \\text{diag}(C_1, C_2, \\dots, C_{l^*}, -1) & \\text{} l \\text{ even,}\\\\ \\text{diag}(C_1, C_2, \\dots, C_{l^*}) & \\text{} l \\text{ odd.} \\end{cases}  l*=‚åäz/2‚åãl^* = \\lfloor z/2 \\rfloor Cj=(cosŒªjsinŒªj‚àísinŒªjcosŒªj) C_j = \\begin{pmatrix} \\cos \\lambda_j & \\sin \\lambda_j \\\\ - \\sin \\lambda_j & \\cos\\lambda_j \\end{pmatrix} Multiple seasonalities can adjusted blocks construct seasonal block: LdSeason=(LdSeason1,LdSeason2,‚Ä¶,LdSeasonk)‚ä§,AdSeason=diag(AdSeason1,AdSeason2,‚Ä¶,AdSeasonk),RdSeason=diag(RdSeason1,RdSeason2,‚Ä¶,RdSeasonk),Œ±t,ds,Season=(Œ±t,ds,Season1,Œ±t,ds,Season2,‚Ä¶,Œ±t,ds,Seasonk)‚ä§.\\begin{equation} \\begin{aligned} L_{d}^{\\text{Season}} & = \\left(L_{d}^{\\text{Season}_1}, L_{d}^{\\text{Season}_2}, \\dots, L_{d}^{\\text{Season}_k} \\right)^{\\top}, \\\\ A_{d}^{\\text{Season}} & = \\text{diag}\\left(A_{d}^{\\text{Season}_1}, A_{d}^{\\text{Season}_2}, \\dots, A_{d}^{\\text{Season}_k}\\right),\\\\ R_{d}^{\\text{Season}} & = \\text{diag}\\left(R_{d}^{\\text{Season}_1}, R_{d}^{\\text{Season}_2}, \\dots, R_{d}^{\\text{Season}_k}\\right), \\\\ \\alpha_{t,d}^{s,\\text{Season}} & = \\left(\\alpha_{t,d}^{s,\\text{Season}_1}, \\alpha_{t,d}^{s,\\text{Season}_2}, \\dots, \\alpha_{t,d}^{s,\\text{Season}_k}\\right)^{\\top}. \\end{aligned} \\end{equation} used definitions Ld,Ad,RdL_d, A_d, R_d, Œ±t,ds\\alpha_{t,d}^{s} respectively. Cycles represent fluctuations rises falls fixed period. Usually greater length seasonal cycles. example epidemic wave might cycle daily effects seasonal. cycle modelled trigonometric seasons unknown Œªc\\lambda_c damping factor œÅc\\rho_c. Hence: Ld=(1,0)‚ä§,Ad=Cc,Rd=I2 L_d = (1,0)^{\\top}, \\quad A_d = C_c, \\quad R_d = I_2  Cc=œÅc(cosŒªcsinŒªc‚àísinŒªccosŒªc) C_c = \\rho_c \\begin{pmatrix} \\cos \\lambda_c & \\sin \\lambda_c \\\\ -\\sin\\lambda_c & \\cos\\lambda_c \\end{pmatrix}","code":""},{"path":[]},{"path":[]},{"path":[]},{"path":"https://rodrigozepeda.github.io/diseasenowcasting/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Rodrigo Zepeda-Tello. Author, maintainer. Rami Yaari. Author. Matteo Perini. Author. Tal Robin. Contributor. Teresa Yamana. Contributor. Columbia University City New York. Copyright holder, funder.","code":""},{"path":"https://rodrigozepeda.github.io/diseasenowcasting/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Zepeda-Tello R, Yaari R, Perini M (2024). diseasenowcasting: Nowcasting disease onset cases given report dates. R package version 0.1.0, https://rodrigozepeda.github.io/diseasenowcasting/.","code":"@Manual{,   title = {diseasenowcasting: Nowcasting disease onset cases given report dates},   author = {Rodrigo Zepeda-Tello and Rami Yaari and Matteo Perini},   year = {2024},   note = {R package version 0.1.0},   url = {https://rodrigozepeda.github.io/diseasenowcasting/}, }"},{"path":[]},{"path":"https://rodrigozepeda.github.io/diseasenowcasting/index.html","id":"example","dir":"","previous_headings":"","what":"Example","title":"Nowcasting disease onset cases given report dates","text":"","code":"library(diseasenowcasting) library(ggplot2) library(dplyr) library(posterior)  set.seed(32658235)  # Create a fake disease process num_steps  <- 15 num_strata <- 2 num_delays <- 10 sims       <- simulate_process_for_testing(num_steps = num_steps,                                             num_strata = num_strata, num_delays = num_delays)  # Now use model to predict disease process. If no strata is required omit the strata option predictions <- nowcast(sims, \"onset_date\", \"report_date\", strata = \".strata\",                        method = \"variational\") #> Warning: Pareto k diagnostic value is 2.11. Resampling is disabled. Decreasing #> tol_rel_obj may help if variational algorithm has terminated prematurely. #> Otherwise consider using sampling instead.  #Get the predicted values in a nice format predicted_values <- predictions$generated_quantities |>   as_draws() |>   subset_draws(\"N_predict\") |>   summarise_draws() |>   mutate(.strata = as.numeric(stringr::str_remove_all(variable,\".*\\\\[.*,|\\\\]\"))) |>   mutate(.tval = as.numeric(stringr::str_remove_all(variable,\".*\\\\[|,.*\\\\]\"))) |>    left_join(     predictions$data$preprocessed_data |> distinct(.tval, onset_date)   ) |>   left_join(     predictions$data$strata_dict   ) |>    mutate(.strata = .strata_unified)     # Sum over all delays data_delays <- sims |>   group_by(onset_date, .strata) |>   summarise(n = sum(n))   # Create plot ggplot(data_delays) +   geom_ribbon(aes(x = onset_date, ymin = q5, ymax = q95, fill = as.character(.strata)),                data = predicted_values, linetype = \"dotted\", alpha = 0.5) +   geom_line(aes(x = onset_date, y = n, color = as.character(.strata))) +   geom_line(aes(x = onset_date, y = mean, color = as.character(.strata)),              data = predicted_values, linetype = \"dotted\") +   theme_bw() +   scale_color_manual(\"Strata\", values = c(\"tomato3\", \"forestgreen\")) +   scale_fill_manual(\"Strata\", values = c(\"tomato3\", \"forestgreen\")) +   labs(     x = \"Time\",     y = \"Cases\"   )"},{"path":"https://rodrigozepeda.github.io/diseasenowcasting/reference/array_to_list.html","id":null,"dir":"Reference","previous_headings":"","what":"Transforms an array into a list of lists ‚Äî array_to_list","title":"Transforms an array into a list of lists ‚Äî array_to_list","text":"Function takes array transforms lists lists mainly interacting [Rcpp::cppFunction()].","code":""},{"path":"https://rodrigozepeda.github.io/diseasenowcasting/reference/array_to_list.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Transforms an array into a list of lists ‚Äî array_to_list","text":"","code":"array_to_list(my_array, last_dim_as = \"vector\")"},{"path":"https://rodrigozepeda.github.io/diseasenowcasting/reference/array_to_list.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Transforms an array into a list of lists ‚Äî array_to_list","text":"my_array array transform last_dim_as Either 'vector', 'matrix'  'scalar'  depending want last dimension","code":""},{"path":"https://rodrigozepeda.github.io/diseasenowcasting/reference/array_to_list.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Transforms an array into a list of lists ‚Äî array_to_list","text":"list lists structure array","code":""},{"path":"https://rodrigozepeda.github.io/diseasenowcasting/reference/check_date_columns.html","id":null,"dir":"Reference","previous_headings":"","what":"Check the onset and report dates ‚Äî check_date_columns","title":"Check the onset and report dates ‚Äî check_date_columns","text":"Check onset report dates","code":""},{"path":"https://rodrigozepeda.github.io/diseasenowcasting/reference/check_date_columns.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Check the onset and report dates ‚Äî check_date_columns","text":"","code":"check_date_columns(.disease_data, onset_date, report_date)"},{"path":"https://rodrigozepeda.github.io/diseasenowcasting/reference/check_date_columns.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Check the onset and report dates ‚Äî check_date_columns","text":".disease_data time series reporting data aggregated line list format row column onset date, report date, onset_date quotations, name column datatype Date designating date case onset. e.g. \"onset_week\" report_date quotations, name column datatype Date designating date case report. e.g. \"report_week\"","code":""},{"path":"https://rodrigozepeda.github.io/diseasenowcasting/reference/check_date_columns.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Check the onset and report dates ‚Äî check_date_columns","text":"`.disease_data` data.frame filtered reports onset.","code":""},{"path":"https://rodrigozepeda.github.io/diseasenowcasting/reference/check_now.html","id":null,"dir":"Reference","previous_headings":"","what":"Check the `now` argument to be date ‚Äî check_now","title":"Check the `now` argument to be date ‚Äî check_now","text":"Check `now` argument date","code":""},{"path":"https://rodrigozepeda.github.io/diseasenowcasting/reference/check_now.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Check the `now` argument to be date ‚Äî check_now","text":"","code":"check_now(.disease_data, now, onset_date)"},{"path":"https://rodrigozepeda.github.io/diseasenowcasting/reference/check_now.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Check the `now` argument to be date ‚Äî check_now","text":".disease_data time series reporting data aggregated line list format row column onset date, report date, now object datatype Date indicating date perform nowcast. onset_date quotations, name column datatype Date designating date case onset. e.g. \"onset_week\"","code":""},{"path":"https://rodrigozepeda.github.io/diseasenowcasting/reference/check_now.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Check the `now` argument to be date ‚Äî check_now","text":"(invisibly) TRUE `now` date achievable","code":""},{"path":"https://rodrigozepeda.github.io/diseasenowcasting/reference/check_proportion_reported.html","id":null,"dir":"Reference","previous_headings":"","what":"Check the `proportion_reported` argument ‚Äî check_proportion_reported","title":"Check the `proportion_reported` argument ‚Äî check_proportion_reported","text":"Check `proportion_reported` argument","code":""},{"path":"https://rodrigozepeda.github.io/diseasenowcasting/reference/check_proportion_reported.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Check the `proportion_reported` argument ‚Äî check_proportion_reported","text":"","code":"check_proportion_reported(proportion_reported)"},{"path":"https://rodrigozepeda.github.io/diseasenowcasting/reference/check_proportion_reported.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Check the `proportion_reported` argument ‚Äî check_proportion_reported","text":"proportion_reported decimal greater 0 less equal 1 representing proportion cases expected reported. Default: 1, e.g. 100 percent cases eventually reported. asymptomatic diseases cases ever reported, outbreaks severe -reporting expected, change  less 1.","code":""},{"path":"https://rodrigozepeda.github.io/diseasenowcasting/reference/check_proportion_reported.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Check the `proportion_reported` argument ‚Äî check_proportion_reported","text":"(invisibly) `TRUE` proportion valid","code":""},{"path":"https://rodrigozepeda.github.io/diseasenowcasting/reference/check_units.html","id":null,"dir":"Reference","previous_headings":"","what":"Check the `units` argument among the options ‚Äî check_units","title":"Check the `units` argument among the options ‚Äî check_units","text":"Check `units` argument among options","code":""},{"path":"https://rodrigozepeda.github.io/diseasenowcasting/reference/check_units.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Check the `units` argument among the options ‚Äî check_units","text":"","code":"check_units(units)"},{"path":"https://rodrigozepeda.github.io/diseasenowcasting/reference/check_units.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Check the `units` argument among the options ‚Äî check_units","text":"units Time scale reporting. Options: \"1 day\", \"1 week\".","code":""},{"path":"https://rodrigozepeda.github.io/diseasenowcasting/reference/check_units.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Check the `units` argument among the options ‚Äî check_units","text":"(invisibly) `TRUE` units valid","code":""},{"path":"https://rodrigozepeda.github.io/diseasenowcasting/reference/control_default.html","id":null,"dir":"Reference","previous_headings":"","what":"Return the default `STAN` control parameters for nowcasting ‚Äî control_default","title":"Return the default `STAN` control parameters for nowcasting ‚Äî control_default","text":"function estimates default control parameters running [rstan::sampling()].","code":""},{"path":"https://rodrigozepeda.github.io/diseasenowcasting/reference/control_default.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Return the default `STAN` control parameters for nowcasting ‚Äî control_default","text":"","code":"control_default()"},{"path":"https://rodrigozepeda.github.io/diseasenowcasting/reference/control_default.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Return the default `STAN` control parameters for nowcasting ‚Äî control_default","text":"list default control parameters running sampling algorithm.","code":""},{"path":"https://rodrigozepeda.github.io/diseasenowcasting/reference/denguedat.html","id":null,"dir":"Reference","previous_headings":"","what":"denguedat: Dengue fever reporting data from Puerto Rico ‚Äî denguedat","title":"denguedat: Dengue fever reporting data from Puerto Rico ‚Äî denguedat","text":"Surveillance data CDC Division Vector-Borne Diseases. 1990-2010 case reporting data included.","code":""},{"path":"https://rodrigozepeda.github.io/diseasenowcasting/reference/denguedat.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"denguedat: Dengue fever reporting data from Puerto Rico ‚Äî denguedat","text":"","code":"data(denguedat)"},{"path":"https://rodrigozepeda.github.io/diseasenowcasting/reference/denguedat.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"denguedat: Dengue fever reporting data from Puerto Rico ‚Äî denguedat","text":"data frame.","code":""},{"path":"https://rodrigozepeda.github.io/diseasenowcasting/reference/denguedat.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"denguedat: Dengue fever reporting data from Puerto Rico ‚Äî denguedat","text":"first column, `onset_week`, indicates week symptom onset. second column, `report_week`, indicates week case report. third column, `gender`, indicates gender infected individual (randomly assigned 0.5:0.5 probability \"Male\"/\"Female\").","code":""},{"path":"https://rodrigozepeda.github.io/diseasenowcasting/reference/denguedat.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"denguedat: Dengue fever reporting data from Puerto Rico ‚Äî denguedat","text":"Data originally `NobBS` package.","code":""},{"path":"https://rodrigozepeda.github.io/diseasenowcasting/reference/denguedat.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"denguedat: Dengue fever reporting data from Puerto Rico ‚Äî denguedat","text":"","code":"data(denguedat)"},{"path":"https://rodrigozepeda.github.io/diseasenowcasting/reference/diseasenowcasting-package.html","id":null,"dir":"Reference","previous_headings":"","what":"diseasenowcasting: Nowcasting disease onset cases given report dates ‚Äî diseasenowcasting-package","title":"diseasenowcasting: Nowcasting disease onset cases given report dates ‚Äî diseasenowcasting-package","text":"Implements bayesian state-space models nowcast incident cases disease given report dates controlling strata covariates.","code":""},{"path":[]},{"path":"https://rodrigozepeda.github.io/diseasenowcasting/reference/diseasenowcasting-package.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"diseasenowcasting: Nowcasting disease onset cases given report dates ‚Äî diseasenowcasting-package","text":"Maintainer: Rodrigo Zepeda-Tello rzepeda17@gmail.com (ORCID) Authors: Rami Yaari Matteo Perini contributors: Tal Robin [contributor] Teresa Yamana [contributor] Columbia University City New York [copyright holder, funder]","code":""},{"path":"https://rodrigozepeda.github.io/diseasenowcasting/reference/get_prior_code_sim_R.html","id":null,"dir":"Reference","previous_headings":"","what":"Function for mapping the priors to numbers ‚Äî get_prior_code_sim_R","title":"Function for mapping the priors to numbers ‚Äî get_prior_code_sim_R","text":"Takes prior one listed `priors.stan` returns function generating random numbers ","code":""},{"path":"https://rodrigozepeda.github.io/diseasenowcasting/reference/get_prior_code_sim_R.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Function for mapping the priors to numbers ‚Äî get_prior_code_sim_R","text":"","code":"get_prior_code_sim_R(prior_name)"},{"path":"https://rodrigozepeda.github.io/diseasenowcasting/reference/get_prior_code_sim_R.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Function for mapping the priors to numbers ‚Äî get_prior_code_sim_R","text":"prior_name (character) name prior distribution. Can one following: `jeffreys` (non-informative), `standard_normal`, `normal`, `student_t`, `cauchy`, `exponential`, `gamma`, `inverse_gamma`, `lognormal`, `weibull`, `frechet`, `double_exponential`, `rayleigh`, `loglogistic`, `gumbel`.","code":""},{"path":"https://rodrigozepeda.github.io/diseasenowcasting/reference/get_prior_code_stan.html","id":null,"dir":"Reference","previous_headings":"","what":"Function for mapping the priors to numbers ‚Äî get_prior_code_stan","title":"Function for mapping the priors to numbers ‚Äî get_prior_code_stan","text":"Takes prior one listed `priors.stan` returns number codes ","code":""},{"path":"https://rodrigozepeda.github.io/diseasenowcasting/reference/get_prior_code_stan.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Function for mapping the priors to numbers ‚Äî get_prior_code_stan","text":"","code":"get_prior_code_stan(prior_name)"},{"path":"https://rodrigozepeda.github.io/diseasenowcasting/reference/get_prior_code_stan.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Function for mapping the priors to numbers ‚Äî get_prior_code_stan","text":"prior_name (character) name prior distribution. Can one following: `jeffreys` (non-informative), `standard_normal`, `normal`, `student_t`, `cauchy`, `exponential`, `gamma`, `inverse_gamma`, `lognormal`, `weibull`, `frechet`, `double_exponential`, `rayleigh`, `loglogistic`, `gumbel`.","code":""},{"path":"https://rodrigozepeda.github.io/diseasenowcasting/reference/infer_data_type.html","id":null,"dir":"Reference","previous_headings":"","what":"Automatically infer the `data_type` ‚Äî infer_data_type","title":"Automatically infer the `data_type` ‚Äî infer_data_type","text":"Infers whether data line-data count-data whether () column named `n`","code":""},{"path":"https://rodrigozepeda.github.io/diseasenowcasting/reference/infer_data_type.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Automatically infer the `data_type` ‚Äî infer_data_type","text":"","code":"infer_data_type(.disease_data, data_type)"},{"path":"https://rodrigozepeda.github.io/diseasenowcasting/reference/infer_data_type.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Automatically infer the `data_type` ‚Äî infer_data_type","text":".disease_data time series reporting data aggregated line list format row column onset date, report date, data_type Either `linedata` row represents test `counts` column named `n` counts many tests onset report dates","code":""},{"path":"https://rodrigozepeda.github.io/diseasenowcasting/reference/infer_data_type.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Automatically infer the `data_type` ‚Äî infer_data_type","text":"Whether data `count` `linelist`","code":""},{"path":"https://rodrigozepeda.github.io/diseasenowcasting/reference/infer_now.html","id":null,"dir":"Reference","previous_headings":"","what":"Automatically infer which value is `now`. ‚Äî infer_now","title":"Automatically infer which value is `now`. ‚Äî infer_now","text":"Function returns maximum onset date `.disease_data` `now = NULL`. Else check whether now possible data.","code":""},{"path":"https://rodrigozepeda.github.io/diseasenowcasting/reference/infer_now.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Automatically infer which value is `now`. ‚Äî infer_now","text":"","code":"infer_now(.disease_data, now, onset_date)"},{"path":"https://rodrigozepeda.github.io/diseasenowcasting/reference/infer_now.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Automatically infer which value is `now`. ‚Äî infer_now","text":".disease_data time series reporting data aggregated line list format row column onset date, report date, now object datatype Date indicating date perform nowcast. onset_date quotations, name column datatype Date designating date case onset. e.g. \"onset_week\"","code":""},{"path":"https://rodrigozepeda.github.io/diseasenowcasting/reference/infer_now.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Automatically infer which value is `now`. ‚Äî infer_now","text":"`now` value [nowcasting()] can last date data specified user","code":""},{"path":"https://rodrigozepeda.github.io/diseasenowcasting/reference/infer_units.html","id":null,"dir":"Reference","previous_headings":"","what":"Automatically infer which value is `units`. ‚Äî infer_units","title":"Automatically infer which value is `units`. ‚Äî infer_units","text":"Function returns whether data daily, weekly, monthly yearly `date_column`.","code":""},{"path":"https://rodrigozepeda.github.io/diseasenowcasting/reference/infer_units.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Automatically infer which value is `units`. ‚Äî infer_units","text":"","code":"infer_units(.disease_data, units, date_column)"},{"path":"https://rodrigozepeda.github.io/diseasenowcasting/reference/infer_units.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Automatically infer which value is `units`. ‚Äî infer_units","text":".disease_data time series reporting data aggregated line list format row column onset date, report date, units Time scale reporting. Options: \"1 day\", \"1 week\". date_column Name column `.disease_data` contains dates.","code":""},{"path":"https://rodrigozepeda.github.io/diseasenowcasting/reference/infer_units.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Automatically infer which value is `units`. ‚Äî infer_units","text":"Whether data's units `days` `weeks`","code":""},{"path":"https://rodrigozepeda.github.io/diseasenowcasting/reference/nowcast.html","id":null,"dir":"Reference","previous_headings":"","what":"Nowcasting ‚Äî nowcast","title":"Nowcasting ‚Äî nowcast","text":"Function uses [rstan::sampling()] engine generate nowcasts.","code":""},{"path":"https://rodrigozepeda.github.io/diseasenowcasting/reference/nowcast.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Nowcasting ‚Äî nowcast","text":"","code":"nowcast(   .disease_data,   onset_date,   report_date,   strata = NULL,   dist = c(\"NegativeBinomial\", \"Poisson\"),   now = NULL,   units = NULL,   max_delay = Inf,   prior_only = FALSE,   proportion_reported = 1,   refresh = 250 * rlang::is_interactive(),   control = control_default(),   method = c(\"sampling\", \"variational\", \"optimization\"),   priors = set_priors(),   ... )"},{"path":"https://rodrigozepeda.github.io/diseasenowcasting/reference/nowcast.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Nowcasting ‚Äî nowcast","text":".disease_data time series reporting data aggregated line list format row column onset date, report date, onset_date quotations, name column datatype Date designating date case onset. e.g. \"onset_week\" report_date quotations, name column datatype Date designating date case report. e.g. \"report_week\" strata Character vector names strata included data. dist Distribution. Either \"NegativeBinomial\"  \"Poisson\" now object datatype Date indicating date perform nowcast. units Time scale reporting. Options: \"1 day\", \"1 week\". max_delay Maximum possible delay observed considered estimation delay distribution (numeric). Default: `Inf` prior_only Boolean variable indicating whether compute prior distribution proportion_reported decimal greater 0 less equal 1 representing proportion cases expected reported. Default: 1, e.g. 100 percent cases eventually reported. asymptomatic diseases cases ever reported, outbreaks severe -reporting expected, change  less 1. refresh Refresh parameter [rstan::sampling()] control Control parameter [rstan::sampling()] method Fitting method either `sampling` (recommended inference), `variational` (recommended testing) `optimization`. `sampling` method calls [rstan::sampling()] `variational` calls [rstan::vb()] `optimization` calls [rstan::optimizing()] priors list nowcast priors. can use [set_priors()] change priors function (see details) ... Additional arguments pass [rstan::sampling()]","code":""},{"path":"https://rodrigozepeda.github.io/diseasenowcasting/reference/nowcast.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Nowcasting ‚Äî nowcast","text":"","code":"# Load the data data(denguedat)  # Create a fake disease process sims <- simulate_process_for_testing() #> ! This function will disappear in future versions please call `simulate_disease` #> ‚Ñπ Computing a nowcast for 2024-09-13 per \"days\" #> ‚Ñπ Assuming data is count-data where counts are in column `n`. To change this set `data_type = \"linelist\"`  # Run a nowcast with very few iterations # change to 4 chains and 2000 iter when doing inference nowcast(sims, \"onset_date\", \"report_date\", method = \"optimization\", seed = 2524) #> ‚Ñπ Computing a nowcast for 2024-09-14 per \"days\" #> ‚Ñπ Assuming data is count-data where counts are in column `n`. To change this set `data_type = \"linelist\"` #> $data #> $data$stan_data #> $data$stan_data$num_steps #> [1] 10 #>  #> $data$stan_data$num_delays #> [1] 8 #>  #> $data$stan_data$num_strata #> [1] 1 #>  #> $data$stan_data$n_rows #> [1] 52 #>  #> $data$stan_data$N_cases #>         n .tval .delay .strata #>  [1,] 200     1      1       1 #>  [2,] 200     1      2       1 #>  [3,] 200     1      3       1 #>  [4,] 200     1      4       1 #>  [5,] 200     1      5       1 #>  [6,] 200     1      6       1 #>  [7,] 200     1      7       1 #>  [8,] 200     1      8       1 #>  [9,] 200     2      1       1 #> [10,] 200     2      2       1 #> [11,] 200     2      3       1 #> [12,] 200     2      4       1 #> [13,] 200     2      5       1 #> [14,] 200     2      6       1 #> [15,] 200     2      7       1 #> [16,] 200     2      8       1 #> [17,] 200     3      1       1 #> [18,] 200     3      2       1 #> [19,] 200     3      3       1 #> [20,] 200     3      4       1 #> [21,] 200     3      5       1 #> [22,] 200     3      6       1 #> [23,] 200     3      7       1 #> [24,] 200     3      8       1 #> [25,] 200     4      1       1 #> [26,] 200     4      2       1 #> [27,] 200     4      3       1 #> [28,] 200     4      4       1 #> [29,] 200     4      5       1 #> [30,] 200     4      6       1 #> [31,] 200     4      7       1 #> [32,] 200     5      1       1 #> [33,] 200     5      2       1 #> [34,] 200     5      3       1 #> [35,] 200     5      4       1 #> [36,] 200     5      5       1 #> [37,] 200     5      6       1 #> [38,] 200     6      1       1 #> [39,] 200     6      2       1 #> [40,] 200     6      3       1 #> [41,] 200     6      4       1 #> [42,] 200     6      5       1 #> [43,] 200     7      1       1 #> [44,] 200     7      2       1 #> [45,] 200     7      3       1 #> [46,] 200     7      4       1 #> [47,] 200     8      1       1 #> [48,] 200     8      2       1 #> [49,] 200     8      3       1 #> [50,] 200     9      1       1 #> [51,] 200     9      2       1 #> [52,] 200    10      1       1 #>  #> $data$stan_data$prior_only #> [1] 0 #>  #> $data$stan_data$mu_degree #> [1] 1 #>  #> $data$stan_data$nu_degree #> [1] 1 #>  #> $data$stan_data$mu_is_constant #> [1] FALSE #>  #> $data$stan_data$nu_is_constant #> [1] TRUE #>  #> $data$stan_data$p #> [1] 3 #>  #> $data$stan_data$q #> [1] 2 #>  #> $data$stan_data$phi_AR_param_1 #> [1] 0 #>  #> $data$stan_data$phi_AR_param_2 #> [1] 1 #>  #> $data$stan_data$phi_AR_prior #> [1] 4 #>  #> $data$stan_data$theta_MA_param_1 #> [1] 0 #>  #> $data$stan_data$theta_MA_param_2 #> [1] 1 #>  #> $data$stan_data$theta_MA_prior #> [1] 4 #>  #> $data$stan_data$xi_sd_param_1 #> [1] 0 #>  #> $data$stan_data$xi_sd_param_2 #> [1] 1 #>  #> $data$stan_data$xi_sd_prior #> [1] 1 #>  #> $data$stan_data$is_negative_binomial #> [1] 1 #>  #> $data$stan_data$mu_sd_prior #> [1] 1 #>  #> $data$stan_data$nu_sd_prior #> [1] 1 #>  #> $data$stan_data$r_prior #> [1] 1 #>  #> $data$stan_data$r_param_1 #> [1] 0 #>  #> $data$stan_data$r_param_2 #> [1] 1 #>  #> $data$stan_data$mu_sd_param_1 #> [1] 0 #>  #> $data$stan_data$mu_sd_param_2 #> [1] 0.1 #>  #> $data$stan_data$nu_sd_param_1 #> [1] 0 #>  #> $data$stan_data$nu_sd_param_2 #> [1] 0.1 #>  #> $data$stan_data$mu_0_mean_param_1 #> [1] 5.303305 #>  #> $data$stan_data$mu_0_mean_param_2 #> [1] 0.01 #>  #> $data$stan_data$mu_0_sd_param_1 #> [1] 0 #>  #> $data$stan_data$mu_0_sd_param_2 #> [1] 0.01 #>  #> $data$stan_data$nu_0_mean_param_1 #> [1] 0 #>  #> $data$stan_data$nu_0_mean_param_2 #> [1] 0.01 #>  #> $data$stan_data$nu_0_sd_param_1 #> [1] 0 #>  #> $data$stan_data$nu_0_sd_param_2 #> [1] 0.01 #>  #> $data$stan_data$mu_0_mean_hyperprior #> [1] 1 #>  #> $data$stan_data$nu_0_mean_hyperprior #> [1] 1 #>  #> $data$stan_data$mu_0_sd_hyperprior #> [1] 1 #>  #> $data$stan_data$nu_0_sd_hyperprior #> [1] 1 #>  #> $data$stan_data$max_log_tol_val #> [1] 15 #>  #> $data$stan_data$precision_tol #> [1] 0.001 #>  #>  #> $data$preprocessed_data #> # A tibble: 52 √ó 7 #>        n .tval .delay onset_date report_date .strata_unified .strata #>    <dbl> <dbl>  <dbl> <date>     <date>      <chr>             <dbl> #>  1   200     1      1 2024-09-05 2024-09-05  No strata             1 #>  2   200     1      2 2024-09-05 2024-09-06  No strata             1 #>  3   200     1      3 2024-09-05 2024-09-07  No strata             1 #>  4   200     1      4 2024-09-05 2024-09-08  No strata             1 #>  5   200     1      5 2024-09-05 2024-09-09  No strata             1 #>  6   200     1      6 2024-09-05 2024-09-10  No strata             1 #>  7   200     1      7 2024-09-05 2024-09-11  No strata             1 #>  8   200     1      8 2024-09-05 2024-09-12  No strata             1 #>  9   200     2      1 2024-09-06 2024-09-06  No strata             1 #> 10   200     2      2 2024-09-06 2024-09-07  No strata             1 #> # ‚Ñπ 42 more rows #>  #> $data$call_parameters #> $data$call_parameters$onset_date #> [1] \"onset_date\" #>  #> $data$call_parameters$report_date #> [1] \"report_date\" #>  #> $data$call_parameters$strata #> NULL #>  #> $data$call_parameters$now #> [1] \"2024-09-14\" #>  #> $data$call_parameters$units #> [1] \"days\" #>  #> $data$call_parameters$max_delay #> [1] Inf #>  #> $data$call_parameters$num_delays #> [1] 8 #>  #> $data$call_parameters$num_steps #> [1] 10 #>  #> $data$call_parameters$num_strata #> [1] 1 #>  #>  #> $data$strata_dict #> # A tibble: 1 √ó 2 #>   .strata_unified .strata #>   <chr>             <dbl> #> 1 No strata             1 #>  #>  #> $generated_quantities #> Inference for Stan model: generated_quantities. #> 1 chains, each with iter=1000; warmup=0; thin=1;  #> post-warmup draws per chain=1000, total post-warmup draws=1000. #>  #>                                   mean se_mean     sd    2.5%     25%     50% #> lambda_higher_than_maxval_flag    0.00     NaN   0.00    0.00    0.00    0.00 #> N_mat_predict[1,1]              200.00     NaN   0.00  200.00  200.00  200.00 #> N_mat_predict[1,2]              200.00     NaN   0.00  200.00  200.00  200.00 #> N_mat_predict[1,3]              200.00     NaN   0.00  200.00  200.00  200.00 #> N_mat_predict[1,4]              200.00     NaN   0.00  200.00  200.00  200.00 #> N_mat_predict[1,5]              200.00     NaN   0.00  200.00  200.00  200.00 #> N_mat_predict[1,6]              200.00     NaN   0.00  200.00  200.00  200.00 #> N_mat_predict[1,7]              200.00     NaN   0.00  200.00  200.00  200.00 #> N_mat_predict[1,8]              200.00     NaN   0.00  200.00  200.00  200.00 #> N_mat_predict[2,1]              200.00     NaN   0.00  200.00  200.00  200.00 #> N_mat_predict[2,2]              200.00     NaN   0.00  200.00  200.00  200.00 #> N_mat_predict[2,3]              200.00     NaN   0.00  200.00  200.00  200.00 #> N_mat_predict[2,4]              200.00     NaN   0.00  200.00  200.00  200.00 #> N_mat_predict[2,5]              200.00     NaN   0.00  200.00  200.00  200.00 #> N_mat_predict[2,6]              200.00     NaN   0.00  200.00  200.00  200.00 #> N_mat_predict[2,7]              200.00     NaN   0.00  200.00  200.00  200.00 #> N_mat_predict[2,8]              200.00     NaN   0.00  200.00  200.00  200.00 #> N_mat_predict[3,1]              200.00     NaN   0.00  200.00  200.00  200.00 #> N_mat_predict[3,2]              200.00     NaN   0.00  200.00  200.00  200.00 #> N_mat_predict[3,3]              200.00     NaN   0.00  200.00  200.00  200.00 #> N_mat_predict[3,4]              200.00     NaN   0.00  200.00  200.00  200.00 #> N_mat_predict[3,5]              200.00     NaN   0.00  200.00  200.00  200.00 #> N_mat_predict[3,6]              200.00     NaN   0.00  200.00  200.00  200.00 #> N_mat_predict[3,7]              200.00     NaN   0.00  200.00  200.00  200.00 #> N_mat_predict[3,8]              200.00     NaN   0.00  200.00  200.00  200.00 #> N_mat_predict[4,1]              200.00     NaN   0.00  200.00  200.00  200.00 #> N_mat_predict[4,2]              200.00     NaN   0.00  200.00  200.00  200.00 #> N_mat_predict[4,3]              200.00     NaN   0.00  200.00  200.00  200.00 #> N_mat_predict[4,4]              200.00     NaN   0.00  200.00  200.00  200.00 #> N_mat_predict[4,5]              200.00     NaN   0.00  200.00  200.00  200.00 #> N_mat_predict[4,6]              200.00     NaN   0.00  200.00  200.00  200.00 #> N_mat_predict[4,7]              200.00     NaN   0.00  200.00  200.00  200.00 #> N_mat_predict[4,8]                0.96    0.04   1.10    0.00    0.00    1.00 #> N_mat_predict[5,1]              200.00     NaN   0.00  200.00  200.00  200.00 #> N_mat_predict[5,2]              200.00     NaN   0.00  200.00  200.00  200.00 #> N_mat_predict[5,3]              200.00     NaN   0.00  200.00  200.00  200.00 #> N_mat_predict[5,4]              200.00     NaN   0.00  200.00  200.00  200.00 #> N_mat_predict[5,5]              200.00     NaN   0.00  200.00  200.00  200.00 #> N_mat_predict[5,6]              200.00     NaN   0.00  200.00  200.00  200.00 #> N_mat_predict[5,7]              188.63    2.83  84.45   63.98  130.00  176.00 #> N_mat_predict[5,8]              188.46    2.59  85.39   63.00  125.00  177.00 #> N_mat_predict[6,1]              200.00     NaN   0.00  200.00  200.00  200.00 #> N_mat_predict[6,2]              200.00     NaN   0.00  200.00  200.00  200.00 #> N_mat_predict[6,3]              200.00     NaN   0.00  200.00  200.00  200.00 #> N_mat_predict[6,4]              200.00     NaN   0.00  200.00  200.00  200.00 #> N_mat_predict[6,5]              200.00     NaN   0.00  200.00  200.00  200.00 #> N_mat_predict[6,6]              192.33    2.61  84.80   63.00  131.00  182.00 #> N_mat_predict[6,7]              191.69    2.75  85.06   64.00  128.75  179.00 #> N_mat_predict[6,8]              192.47    2.70  86.50   60.95  127.00  181.00 #> N_mat_predict[7,1]              200.00     NaN   0.00  200.00  200.00  200.00 #> N_mat_predict[7,2]              200.00     NaN   0.00  200.00  200.00  200.00 #> N_mat_predict[7,3]              200.00     NaN   0.00  200.00  200.00  200.00 #> N_mat_predict[7,4]              200.00     NaN   0.00  200.00  200.00  200.00 #> N_mat_predict[7,5]              193.26    2.80  84.08   61.98  129.00  184.00 #> N_mat_predict[7,6]              190.65    2.61  83.53   62.98  129.00  179.00 #> N_mat_predict[7,7]              193.10    2.78  86.31   63.00  130.00  180.00 #> N_mat_predict[7,8]              194.75    2.73  85.06   63.95  134.00  182.00 #> N_mat_predict[8,1]              200.00     NaN   0.00  200.00  200.00  200.00 #> N_mat_predict[8,2]              200.00     NaN   0.00  200.00  200.00  200.00 #> N_mat_predict[8,3]              200.00     NaN   0.00  200.00  200.00  200.00 #> N_mat_predict[8,4]              191.12    3.40  88.04   58.00  127.00  178.00 #> N_mat_predict[8,5]              198.85    3.06  91.69   59.00  132.00  183.00 #> N_mat_predict[8,6]              191.06    2.76  85.95   66.00  129.00  175.00 #> N_mat_predict[8,7]              193.96    2.70  87.86   62.98  132.00  179.50 #> N_mat_predict[8,8]                1.01    0.04   1.15    0.00    0.00    1.00 #> N_mat_predict[9,1]              200.00     NaN   0.00  200.00  200.00  200.00 #> N_mat_predict[9,2]              200.00     NaN   0.00  200.00  200.00  200.00 #> N_mat_predict[9,3]              195.23    2.75  88.89   65.00  129.00  181.00 #> N_mat_predict[9,4]              191.32    3.19  84.95   63.00  127.00  176.00 #> N_mat_predict[9,5]              198.36    2.76  86.19   67.97  133.00  185.00 #> N_mat_predict[9,6]              200.66    3.27  89.56   63.95  134.00  188.00 #> N_mat_predict[9,7]              190.32    2.60  83.73   61.98  126.00  180.50 #> N_mat_predict[9,8]              192.45    2.80  86.95   64.97  131.00  178.00 #> N_mat_predict[10,1]             200.00     NaN   0.00  200.00  200.00  200.00 #> N_mat_predict[10,2]             197.54    3.16  92.57   57.98  131.00  187.00 #> N_mat_predict[10,3]             204.42    3.02  93.15   63.98  137.00  190.50 #> N_mat_predict[10,4]             193.45    2.90  90.21   53.00  129.00  179.00 #> N_mat_predict[10,5]             196.37    3.27  91.37   61.95  130.75  184.00 #> N_mat_predict[10,6]             193.63    2.71  86.45   67.97  130.75  181.00 #> N_mat_predict[10,7]             197.61    2.75  85.04   63.98  137.00  186.00 #> N_mat_predict[10,8]             195.18    2.63  85.31   66.98  133.00  183.50 #> lambda_transformed[1,1]           5.23    0.00   0.00    5.23    5.23    5.23 #> lambda_transformed[1,2]           5.26    0.00   0.00    5.26    5.26    5.26 #> lambda_transformed[1,3]           5.26    0.00   0.00    5.26    5.26    5.26 #> lambda_transformed[1,4]           5.26    0.00   0.00    5.26    5.26    5.26 #> lambda_transformed[1,5]           5.30    0.00   0.00    5.30    5.30    5.30 #> lambda_transformed[1,6]           5.30    0.00   0.00    5.30    5.30    5.30 #> lambda_transformed[1,7]           5.30    0.00   0.00    5.30    5.30    5.30 #> lambda_transformed[1,8]           5.30    0.00   0.00    5.30    5.30    5.30 #> lambda_transformed[1,9]           5.30    0.00   0.00    5.30    5.30    5.30 #> lambda_transformed[1,10]          5.30    0.00   0.00    5.30    5.30    5.30 #> lambda_transformed[2,1]           5.23    0.00   0.00    5.23    5.23    5.23 #> lambda_transformed[2,2]           5.26    0.00   0.00    5.26    5.26    5.26 #> lambda_transformed[2,3]           5.26    0.00   0.00    5.26    5.26    5.26 #> lambda_transformed[2,4]           5.26    0.00   0.00    5.26    5.26    5.26 #> lambda_transformed[2,5]           5.30    0.00   0.00    5.30    5.30    5.30 #> lambda_transformed[2,6]           5.30    0.00   0.00    5.30    5.30    5.30 #> lambda_transformed[2,7]           5.30    0.00   0.00    5.30    5.30    5.30 #> lambda_transformed[2,8]           5.30    0.00   0.00    5.30    5.30    5.30 #> lambda_transformed[2,9]           5.30    0.00   0.00    5.30    5.30    5.30 #> lambda_transformed[2,10]          5.30    0.00   0.00    5.30    5.30    5.30 #> lambda_transformed[3,1]           5.23    0.00   0.00    5.23    5.23    5.23 #> lambda_transformed[3,2]           5.26    0.00   0.00    5.26    5.26    5.26 #> lambda_transformed[3,3]           5.26    0.00   0.00    5.26    5.26    5.26 #> lambda_transformed[3,4]           5.26    0.00   0.00    5.26    5.26    5.26 #> lambda_transformed[3,5]           5.30    0.00   0.00    5.30    5.30    5.30 #> lambda_transformed[3,6]           5.30    0.00   0.00    5.30    5.30    5.30 #> lambda_transformed[3,7]           5.30    0.00   0.00    5.30    5.30    5.30 #> lambda_transformed[3,8]           5.30    0.00   0.00    5.30    5.30    5.30 #> lambda_transformed[3,9]           5.30    0.00   0.00    5.30    5.30    5.30 #> lambda_transformed[3,10]          5.30    0.00   0.00    5.30    5.30    5.30 #> lambda_transformed[4,1]           5.23    0.00   0.00    5.23    5.23    5.23 #> lambda_transformed[4,2]           5.26    0.00   0.00    5.26    5.26    5.26 #> lambda_transformed[4,3]           5.26    0.00   0.00    5.26    5.26    5.26 #> lambda_transformed[4,4]           5.26    0.00   0.00    5.26    5.26    5.26 #> lambda_transformed[4,5]           5.30    0.00   0.00    5.30    5.30    5.30 #> lambda_transformed[4,6]           5.30    0.00   0.00    5.30    5.30    5.30 #> lambda_transformed[4,7]           5.30    0.00   0.00    5.30    5.30    5.30 #> lambda_transformed[4,8]           5.26    0.00   0.00    5.26    5.26    5.26 #> lambda_transformed[4,9]           5.30    0.00   0.00    5.30    5.30    5.30 #> lambda_transformed[4,10]          5.30    0.00   0.00    5.30    5.30    5.30 #> lambda_transformed[5,1]           5.23    0.00   0.00    5.23    5.23    5.23 #> lambda_transformed[5,2]           5.26    0.00   0.00    5.26    5.26    5.26 #> lambda_transformed[5,3]           5.26    0.00   0.00    5.26    5.26    5.26 #> lambda_transformed[5,4]           5.26    0.00   0.00    5.26    5.26    5.26 #> lambda_transformed[5,5]           5.30    0.00   0.00    5.30    5.30    5.30 #> lambda_transformed[5,6]           5.30    0.00   0.00    5.30    5.30    5.30 #> lambda_transformed[5,7]           5.26    0.00   0.00    5.26    5.26    5.26 #> lambda_transformed[5,8]           5.26    0.00   0.00    5.26    5.26    5.26 #> lambda_transformed[5,9]           5.30    0.00   0.00    5.30    5.30    5.30 #> lambda_transformed[5,10]          5.30    0.00   0.00    5.30    5.30    5.30 #> lambda_transformed[6,1]           5.23    0.00   0.00    5.23    5.23    5.23 #> lambda_transformed[6,2]           5.26    0.00   0.00    5.26    5.26    5.26 #> lambda_transformed[6,3]           5.26    0.00   0.00    5.26    5.26    5.26 #> lambda_transformed[6,4]           5.26    0.00   0.00    5.26    5.26    5.26 #> lambda_transformed[6,5]           5.30    0.00   0.00    5.30    5.30    5.30 #> lambda_transformed[6,6]           5.26    0.00   0.00    5.26    5.26    5.26 #> lambda_transformed[6,7]           5.26    0.00   0.00    5.26    5.26    5.26 #> lambda_transformed[6,8]           5.26    0.00   0.00    5.26    5.26    5.26 #> lambda_transformed[6,9]           5.30    0.00   0.00    5.30    5.30    5.30 #> lambda_transformed[6,10]          5.26    0.00   0.00    5.26    5.26    5.26 #> lambda_transformed[7,1]           5.23    0.00   0.00    5.23    5.23    5.23 #> lambda_transformed[7,2]           5.26    0.00   0.00    5.26    5.26    5.26 #> lambda_transformed[7,3]           5.26    0.00   0.00    5.26    5.26    5.26 #> lambda_transformed[7,4]           5.26    0.00   0.00    5.26    5.26    5.26 #> lambda_transformed[7,5]           5.24    0.00   0.00    5.24    5.24    5.24 #> lambda_transformed[7,6]           5.26    0.00   0.00    5.26    5.26    5.26 #> lambda_transformed[7,7]           5.26    0.00   0.00    5.26    5.26    5.26 #> lambda_transformed[7,8]           5.26    0.00   0.00    5.26    5.26    5.26 #> lambda_transformed[7,9]           5.24    0.00   0.00    5.24    5.24    5.24 #> lambda_transformed[7,10]          5.26    0.00   0.00    5.26    5.26    5.26 #> lambda_transformed[8,1]           5.23    0.00   0.00    5.23    5.23    5.23 #> lambda_transformed[8,2]           5.26    0.00   0.00    5.26    5.26    5.26 #> lambda_transformed[8,3]           5.26    0.00   0.00    5.26    5.26    5.26 #> lambda_transformed[8,4]           0.00    0.00   0.00    0.00    0.00    0.00 #> lambda_transformed[8,5]           5.24     NaN   0.00    5.24    5.24    5.24 #> lambda_transformed[8,6]           5.26    0.00   0.00    5.26    5.26    5.26 #> lambda_transformed[8,7]           5.26    0.00   0.00    5.26    5.26    5.26 #> lambda_transformed[8,8]           0.00    0.00   0.00    0.00    0.00    0.00 #> lambda_transformed[8,9]           5.24    0.00   0.00    5.24    5.24    5.24 #> lambda_transformed[8,10]          5.26    0.00   0.00    5.26    5.26    5.26 #> N_predict[1,1]                 1600.00     NaN   0.00 1600.00 1600.00 1600.00 #> N_predict[2,1]                 1600.00     NaN   0.00 1600.00 1600.00 1600.00 #> N_predict[3,1]                 1600.00     NaN   0.00 1600.00 1600.00 1600.00 #> N_predict[4,1]                 1400.96    0.04   1.10 1400.00 1400.00 1401.00 #> N_predict[5,1]                 1577.09    3.81 121.95 1380.00 1491.00 1560.50 #> N_predict[6,1]                 1576.49    4.61 146.29 1322.00 1472.75 1568.00 #> N_predict[7,1]                 1571.76    5.39 170.89 1286.88 1447.75 1553.00 #> N_predict[8,1]                 1376.01    5.90 183.61 1052.90 1248.00 1359.00 #> N_predict[9,1]                 1568.34    6.80 215.73 1188.90 1414.00 1553.50 #> N_predict[10,1]                1578.21    7.53 234.36 1150.75 1412.75 1564.00 #>                                    75%   97.5% n_eff Rhat #> lambda_higher_than_maxval_flag    0.00    0.00   NaN  NaN #> N_mat_predict[1,1]              200.00  200.00   NaN  NaN #> N_mat_predict[1,2]              200.00  200.00   NaN  NaN #> N_mat_predict[1,3]              200.00  200.00   NaN  NaN #> N_mat_predict[1,4]              200.00  200.00   NaN  NaN #> N_mat_predict[1,5]              200.00  200.00   NaN  NaN #> N_mat_predict[1,6]              200.00  200.00   NaN  NaN #> N_mat_predict[1,7]              200.00  200.00   NaN  NaN #> N_mat_predict[1,8]              200.00  200.00   NaN  NaN #> N_mat_predict[2,1]              200.00  200.00   NaN  NaN #> N_mat_predict[2,2]              200.00  200.00   NaN  NaN #> N_mat_predict[2,3]              200.00  200.00   NaN  NaN #> N_mat_predict[2,4]              200.00  200.00   NaN  NaN #> N_mat_predict[2,5]              200.00  200.00   NaN  NaN #> N_mat_predict[2,6]              200.00  200.00   NaN  NaN #> N_mat_predict[2,7]              200.00  200.00   NaN  NaN #> N_mat_predict[2,8]              200.00  200.00   NaN  NaN #> N_mat_predict[3,1]              200.00  200.00   NaN  NaN #> N_mat_predict[3,2]              200.00  200.00   NaN  NaN #> N_mat_predict[3,3]              200.00  200.00   NaN  NaN #> N_mat_predict[3,4]              200.00  200.00   NaN  NaN #> N_mat_predict[3,5]              200.00  200.00   NaN  NaN #> N_mat_predict[3,6]              200.00  200.00   NaN  NaN #> N_mat_predict[3,7]              200.00  200.00   NaN  NaN #> N_mat_predict[3,8]              200.00  200.00   NaN  NaN #> N_mat_predict[4,1]              200.00  200.00   NaN  NaN #> N_mat_predict[4,2]              200.00  200.00   NaN  NaN #> N_mat_predict[4,3]              200.00  200.00   NaN  NaN #> N_mat_predict[4,4]              200.00  200.00   NaN  NaN #> N_mat_predict[4,5]              200.00  200.00   NaN  NaN #> N_mat_predict[4,6]              200.00  200.00   NaN  NaN #> N_mat_predict[4,7]              200.00  200.00   NaN  NaN #> N_mat_predict[4,8]                1.00    4.00   777 1.00 #> N_mat_predict[5,1]              200.00  200.00   NaN  NaN #> N_mat_predict[5,2]              200.00  200.00   NaN  NaN #> N_mat_predict[5,3]              200.00  200.00   NaN  NaN #> N_mat_predict[5,4]              200.00  200.00   NaN  NaN #> N_mat_predict[5,5]              200.00  200.00   NaN  NaN #> N_mat_predict[5,6]              200.00  200.00   NaN  NaN #> N_mat_predict[5,7]              236.00  395.02   891 1.00 #> N_mat_predict[5,8]              234.00  397.17  1089 1.00 #> N_mat_predict[6,1]              200.00  200.00   NaN  NaN #> N_mat_predict[6,2]              200.00  200.00   NaN  NaN #> N_mat_predict[6,3]              200.00  200.00   NaN  NaN #> N_mat_predict[6,4]              200.00  200.00   NaN  NaN #> N_mat_predict[6,5]              200.00  200.00   NaN  NaN #> N_mat_predict[6,6]              240.00  383.17  1056 1.00 #> N_mat_predict[6,7]              241.25  392.07   955 1.00 #> N_mat_predict[6,8]              242.25  379.05  1024 1.00 #> N_mat_predict[7,1]              200.00  200.00   NaN  NaN #> N_mat_predict[7,2]              200.00  200.00   NaN  NaN #> N_mat_predict[7,3]              200.00  200.00   NaN  NaN #> N_mat_predict[7,4]              200.00  200.00   NaN  NaN #> N_mat_predict[7,5]              246.00  380.10   900 1.00 #> N_mat_predict[7,6]              242.00  380.00  1025 1.00 #> N_mat_predict[7,7]              242.00  393.12   964 1.01 #> N_mat_predict[7,8]              243.25  381.22   969 1.00 #> N_mat_predict[8,1]              200.00  200.00   NaN  NaN #> N_mat_predict[8,2]              200.00  200.00   NaN  NaN #> N_mat_predict[8,3]              200.00  200.00   NaN  NaN #> N_mat_predict[8,4]              240.25  394.17   671 1.00 #> N_mat_predict[8,5]              252.25  417.10   896 1.00 #> N_mat_predict[8,6]              240.00  392.10   968 1.00 #> N_mat_predict[8,7]              243.00  392.10  1056 1.00 #> N_mat_predict[8,8]                2.00    4.00  1067 1.00 #> N_mat_predict[9,1]              200.00  200.00   NaN  NaN #> N_mat_predict[9,2]              200.00  200.00   NaN  NaN #> N_mat_predict[9,3]              245.25  407.00  1042 1.00 #> N_mat_predict[9,4]              243.00  398.05   708 1.00 #> N_mat_predict[9,5]              248.00  400.07   974 1.00 #> N_mat_predict[9,6]              253.25  415.12   749 1.00 #> N_mat_predict[9,7]              238.00  376.02  1033 1.00 #> N_mat_predict[9,8]              239.00  403.17   964 1.00 #> N_mat_predict[10,1]             200.00  200.00   NaN  NaN #> N_mat_predict[10,2]             247.00  415.02   856 1.00 #> N_mat_predict[10,3]             252.25  431.02   954 1.00 #> N_mat_predict[10,4]             243.25  395.07   970 1.00 #> N_mat_predict[10,5]             244.25  416.10   781 1.00 #> N_mat_predict[10,6]             242.00  395.12  1014 1.00 #> N_mat_predict[10,7]             250.00  400.05   954 1.00 #> N_mat_predict[10,8]             245.25  400.00  1053 1.00 #> lambda_transformed[1,1]           5.23    5.23     1 1.00 #> lambda_transformed[1,2]           5.26    5.26     1 1.00 #> lambda_transformed[1,3]           5.26    5.26     1 1.00 #> lambda_transformed[1,4]           5.26    5.26     1 1.00 #> lambda_transformed[1,5]           5.30    5.30     1 1.00 #> lambda_transformed[1,6]           5.30    5.30     1 1.00 #> lambda_transformed[1,7]           5.30    5.30     1 1.00 #> lambda_transformed[1,8]           5.30    5.30     1 1.00 #> lambda_transformed[1,9]           5.30    5.30     1 1.00 #> lambda_transformed[1,10]          5.30    5.30     1 1.00 #> lambda_transformed[2,1]           5.23    5.23     1 1.00 #> lambda_transformed[2,2]           5.26    5.26     1  NaN #> lambda_transformed[2,3]           5.26    5.26     1 1.00 #> lambda_transformed[2,4]           5.26    5.26     1 1.00 #> lambda_transformed[2,5]           5.30    5.30     1 1.00 #> lambda_transformed[2,6]           5.30    5.30     1 1.00 #> lambda_transformed[2,7]           5.30    5.30     1 1.00 #> lambda_transformed[2,8]           5.30    5.30     1 1.00 #> lambda_transformed[2,9]           5.30    5.30     1  NaN #> lambda_transformed[2,10]          5.30    5.30     1 1.00 #> lambda_transformed[3,1]           5.23    5.23     1 1.00 #> lambda_transformed[3,2]           5.26    5.26     1 1.00 #> lambda_transformed[3,3]           5.26    5.26     1 1.00 #> lambda_transformed[3,4]           5.26    5.26     1 1.00 #> lambda_transformed[3,5]           5.30    5.30     1 1.00 #> lambda_transformed[3,6]           5.30    5.30     1 1.00 #> lambda_transformed[3,7]           5.30    5.30     1 1.00 #> lambda_transformed[3,8]           5.30    5.30     1 1.00 #> lambda_transformed[3,9]           5.30    5.30     1 1.00 #> lambda_transformed[3,10]          5.30    5.30     1 1.00 #> lambda_transformed[4,1]           5.23    5.23     1 1.00 #> lambda_transformed[4,2]           5.26    5.26     1 1.00 #> lambda_transformed[4,3]           5.26    5.26     1 1.00 #> lambda_transformed[4,4]           5.26    5.26     1  NaN #> lambda_transformed[4,5]           5.30    5.30     1 1.00 #> lambda_transformed[4,6]           5.30    5.30     1 1.00 #> lambda_transformed[4,7]           5.30    5.30     1 1.00 #> lambda_transformed[4,8]           5.26    5.26     1 1.00 #> lambda_transformed[4,9]           5.30    5.30     1 1.00 #> lambda_transformed[4,10]          5.30    5.30     1 1.00 #> lambda_transformed[5,1]           5.23    5.23     1 1.00 #> lambda_transformed[5,2]           5.26    5.26     1 1.00 #> lambda_transformed[5,3]           5.26    5.26     1 1.00 #> lambda_transformed[5,4]           5.26    5.26     1 1.00 #> lambda_transformed[5,5]           5.30    5.30     1 1.00 #> lambda_transformed[5,6]           5.30    5.30     1 1.00 #> lambda_transformed[5,7]           5.26    5.26     1 1.00 #> lambda_transformed[5,8]           5.26    5.26     1 1.00 #> lambda_transformed[5,9]           5.30    5.30     1 1.00 #> lambda_transformed[5,10]          5.30    5.30     1 1.00 #> lambda_transformed[6,1]           5.23    5.23     1  NaN #> lambda_transformed[6,2]           5.26    5.26     1 1.00 #> lambda_transformed[6,3]           5.26    5.26     1 1.00 #> lambda_transformed[6,4]           5.26    5.26     1 1.00 #> lambda_transformed[6,5]           5.30    5.30     1 1.00 #> lambda_transformed[6,6]           5.26    5.26     1 1.00 #> lambda_transformed[6,7]           5.26    5.26     1 1.00 #> lambda_transformed[6,8]           5.26    5.26     1 1.00 #> lambda_transformed[6,9]           5.30    5.30     1 1.00 #> lambda_transformed[6,10]          5.26    5.26     1 1.00 #> lambda_transformed[7,1]           5.23    5.23     1 1.00 #> lambda_transformed[7,2]           5.26    5.26     1 1.00 #> lambda_transformed[7,3]           5.26    5.26     1 1.00 #> lambda_transformed[7,4]           5.26    5.26     1 1.00 #> lambda_transformed[7,5]           5.24    5.24     1 1.00 #> lambda_transformed[7,6]           5.26    5.26     1  NaN #> lambda_transformed[7,7]           5.26    5.26     1 1.00 #> lambda_transformed[7,8]           5.26    5.26     1 1.00 #> lambda_transformed[7,9]           5.24    5.24     1 1.00 #> lambda_transformed[7,10]          5.26    5.26     1 1.00 #> lambda_transformed[8,1]           5.23    5.23     1 1.00 #> lambda_transformed[8,2]           5.26    5.26     1 1.00 #> lambda_transformed[8,3]           5.26    5.26     1 1.00 #> lambda_transformed[8,4]           0.00    0.00     1 1.00 #> lambda_transformed[8,5]           5.24    5.24   NaN 1.00 #> lambda_transformed[8,6]           5.26    5.26     1 1.00 #> lambda_transformed[8,7]           5.26    5.26     1 1.00 #> lambda_transformed[8,8]           0.00    0.00     1 1.00 #> lambda_transformed[8,9]           5.24    5.24     1 1.00 #> lambda_transformed[8,10]          5.26    5.26     1 1.00 #> N_predict[1,1]                 1600.00 1600.00   NaN  NaN #> N_predict[2,1]                 1600.00 1600.00   NaN  NaN #> N_predict[3,1]                 1600.00 1600.00   NaN  NaN #> N_predict[4,1]                 1401.00 1404.00   777 1.00 #> N_predict[5,1]                 1655.00 1868.05  1024 1.00 #> N_predict[6,1]                 1669.00 1903.05  1009 1.00 #> N_predict[7,1]                 1682.00 1938.05  1004 1.00 #> N_predict[8,1]                 1494.00 1756.07   967 1.00 #> N_predict[9,1]                 1713.25 2010.25  1007 1.00 #> N_predict[10,1]                1741.25 2068.00   968 1.00 #>  #> Samples were drawn using  at Mon Sep 23 20:28:10 2024. #> For each parameter, n_eff is a crude measure of effective sample size, #> and Rhat is the potential scale reduction factor on split chains (at  #> convergence, Rhat=1). #>  #> $model #> $model$par #>    mu_0_centered[1,1]    mu_0_centered[2,1]    mu_0_centered[3,1]  #>          8.695474e-03          9.029034e-03          9.075741e-03  #>    mu_0_centered[4,1]    mu_0_centered[5,1]    mu_0_centered[6,1]  #>          8.707466e-03          8.906273e-03          9.010565e-03  #>    mu_0_centered[7,1]    mu_0_centered[8,1]    nu_0_centered[1,1]  #>          8.814940e-03          8.680038e-03          3.258983e-03  #>    nu_0_centered[2,1]    nu_0_centered[3,1]    nu_0_centered[4,1]  #>          3.340114e-03          3.271248e-03          3.176726e-03  #>    nu_0_centered[5,1]    nu_0_centered[6,1]    nu_0_centered[7,1]  #>          3.211583e-03          3.331721e-03          3.229173e-03  #>    nu_0_centered[8,1]             phi_AR[1]             phi_AR[2]  #>          3.125566e-03         -9.998022e-01         -9.999941e-01  #>             phi_AR[3]           theta_MA[1]           theta_MA[2]  #>         -9.999980e-01         -2.488439e-03         -1.651588e-03  #>             mu_0_mean             nu_0_mean               mu_0_sd  #>          2.617332e+00          2.617241e+00          2.689650e-02  #>               nu_0_sd                 xi_sd              xi_mu_sd  #>          9.718561e-03          1.096011e-02          5.022596e+00  #>              xi_nu_sd      xi_centered[1,1]      xi_centered[2,1]  #>          4.536019e-02          1.944224e-03          2.928083e-03  #>      xi_centered[3,1]      xi_centered[4,1]      xi_centered[5,1]  #>          3.095657e-03          2.159088e-03          2.610599e-03  #>      xi_centered[6,1]      xi_centered[7,1]      xi_centered[8,1]  #>          2.941288e-03          2.566306e-03          2.160728e-03  #>      xi_centered[1,2]      xi_centered[2,2]      xi_centered[3,2]  #>          4.138778e-05         -8.424042e-05         -5.503067e-05  #>      xi_centered[4,2]      xi_centered[5,2]      xi_centered[6,2]  #>          1.517660e-05          2.547710e-04          5.070650e-05  #>      xi_centered[7,2]      xi_centered[8,2]      xi_centered[1,3]  #>          5.597241e-05         -3.706338e-05         -9.610335e-05  #>      xi_centered[2,3]      xi_centered[3,3]      xi_centered[4,3]  #>          1.623791e-05          4.357934e-05         -6.409817e-05  #>      xi_centered[5,3]      xi_centered[6,3]      xi_centered[7,3]  #>         -1.039526e-04          1.304039e-04          2.089455e-05  #>      xi_centered[8,3]      xi_centered[1,4]      xi_centered[2,4]  #>          4.639797e-03          4.705421e-03          4.474714e-03  #>      xi_centered[3,4]      xi_centered[4,4]      xi_centered[5,4]  #>          4.546273e-03          4.650310e-03          4.611072e-03  #>      xi_centered[6,4]      xi_centered[7,4]      xi_centered[8,4]  #>          4.628089e-03          4.565264e-03          2.084986e-05  #>      xi_centered[1,5]      xi_centered[2,5]      xi_centered[3,5]  #>         -1.433519e-04          2.100486e-04          1.797160e-06  #>      xi_centered[4,5]      xi_centered[5,5]      xi_centered[6,5]  #>         -7.717176e-05         -1.745868e-04         -4.937993e-06  #>      xi_centered[7,5]      xi_centered[8,5]      xi_centered[1,6]  #>         -1.009268e-04         -9.351155e-07         -1.928750e-05  #>      xi_centered[2,6]      xi_centered[3,6]      xi_centered[4,6]  #>         -8.106483e-05         -3.741803e-05         -6.640396e-05  #>      xi_centered[5,6]      xi_centered[6,6]      xi_centered[7,6]  #>          2.192875e-04         -1.143008e-04          9.776524e-05  #>      xi_centered[8,6]      xi_centered[1,7]      xi_centered[2,7]  #>         -9.929354e-05         -1.430998e-04          1.527510e-05  #>      xi_centered[3,7]      xi_centered[4,7]      xi_centered[5,7]  #>          2.257386e-05         -7.222529e-06          1.224411e-04  #>      xi_centered[6,7]      xi_centered[7,7]      xi_centered[8,7]  #>          6.808820e-05         -3.333710e-05          1.366203e-04  #>      xi_centered[1,8]      xi_centered[2,8]      xi_centered[3,8]  #>          6.279384e-05          2.125685e-04          1.648718e-04  #>      xi_centered[4,8]      xi_centered[5,8]      xi_centered[6,8]  #>          1.276585e-04         -5.262104e-05         -7.359325e-05  #>      xi_centered[7,8]      xi_centered[8,8]      xi_centered[1,9]  #>          1.468387e-05          3.470440e-05         -5.711419e-05  #>      xi_centered[2,9]      xi_centered[3,9]      xi_centered[4,9]  #>          2.980613e-05         -1.324690e-04         -1.400939e-04  #>      xi_centered[5,9]      xi_centered[6,9]      xi_centered[7,9]  #>         -2.569689e-05          1.182496e-04          1.101539e-04  #>      xi_centered[8,9]     xi_centered[1,10]     xi_centered[2,10]  #>          7.521428e-05          1.018425e-04         -1.683448e-05  #>     xi_centered[3,10]     xi_centered[4,10]     xi_centered[5,10]  #>          8.955073e-05         -7.670760e-06          9.477144e-05  #>     xi_centered[6,10]     xi_centered[7,10]     xi_centered[8,10]  #>          5.569858e-06         -1.890997e-05         -7.381511e-05  #> xi_mu_centered[1,1,1] xi_mu_centered[2,1,1] xi_mu_centered[3,1,1]  #>          1.046732e+00          1.046795e+00          1.046570e+00  #> xi_mu_centered[4,1,1] xi_mu_centered[5,1,1] xi_mu_centered[6,1,1]  #>          1.254545e-02          8.139691e-03          8.039588e-03  #> xi_mu_centered[7,1,1] xi_mu_centered[8,1,1] xi_mu_centered[9,1,1]  #>          8.012072e-03          1.806473e-04          4.719783e-05  #> xi_mu_centered[1,2,1] xi_mu_centered[2,2,1] xi_mu_centered[3,2,1]  #>          1.046804e+00          1.046766e+00          1.046574e+00  #> xi_mu_centered[4,2,1] xi_mu_centered[5,2,1] xi_mu_centered[6,2,1]  #>          1.251466e-02          7.995411e-03          8.052604e-03  #> xi_mu_centered[7,2,1] xi_mu_centered[8,2,1] xi_mu_centered[9,2,1]  #>          8.014796e-03          1.545633e-04          8.736249e-05  #> xi_mu_centered[1,3,1] xi_mu_centered[2,3,1] xi_mu_centered[3,3,1]  #>          1.046793e+00          1.046754e+00          1.046574e+00  #> xi_mu_centered[4,3,1] xi_mu_centered[5,3,1] xi_mu_centered[6,3,1]  #>          1.256677e-02          8.041342e-03          8.063744e-03  #> xi_mu_centered[7,3,1] xi_mu_centered[8,3,1] xi_mu_centered[9,3,1]  #>          8.035976e-03         -1.294317e-04         -9.889491e-05  #> xi_mu_centered[1,4,1] xi_mu_centered[2,4,1] xi_mu_centered[3,4,1]  #>          1.046791e+00          1.046793e+00          1.046504e+00  #> xi_mu_centered[4,4,1] xi_mu_centered[5,4,1] xi_mu_centered[6,4,1]  #>          1.251992e-02          8.044365e-03          8.026837e-03  #> xi_mu_centered[7,4,1] xi_mu_centered[8,4,1] xi_mu_centered[9,4,1]  #>          1.357902e-04         -5.952635e-05         -1.293317e-04  #> xi_mu_centered[1,5,1] xi_mu_centered[2,5,1] xi_mu_centered[3,5,1]  #>          1.046795e+00          1.046704e+00          1.046506e+00  #> xi_mu_centered[4,5,1] xi_mu_centered[5,5,1] xi_mu_centered[6,5,1]  #>          1.258810e-02          8.006614e-03          8.187813e-05  #> xi_mu_centered[7,5,1] xi_mu_centered[8,5,1] xi_mu_centered[9,5,1]  #>          8.806164e-05         -2.849298e-05          1.115674e-06  #> xi_mu_centered[1,6,1] xi_mu_centered[2,6,1] xi_mu_centered[3,6,1]  #>          1.046720e+00          1.046706e+00          1.046499e+00  #> xi_mu_centered[4,6,1] xi_mu_centered[5,6,1] xi_mu_centered[6,6,1]  #>          1.261713e-02         -7.778759e-05         -1.436990e-05  #> xi_mu_centered[7,6,1] xi_mu_centered[8,6,1] xi_mu_centered[9,6,1]  #>         -4.524340e-05          2.233704e-05          7.828878e-05  #> xi_mu_centered[1,7,1] xi_mu_centered[2,7,1] xi_mu_centered[3,7,1]  #>          1.046718e+00          1.046712e+00          1.046494e+00  #> xi_mu_centered[4,7,1] xi_mu_centered[5,7,1] xi_mu_centered[6,7,1]  #>          7.302978e-05         -5.030137e-05          1.491505e-04  #> xi_mu_centered[7,7,1] xi_mu_centered[8,7,1] xi_mu_centered[9,7,1]  #>         -1.213841e-04          1.492409e-04         -6.629775e-05  #> xi_mu_centered[1,8,1] xi_mu_centered[2,8,1] xi_mu_centered[3,8,1]  #>          1.046722e+00          1.046695e+00         -1.307718e-04  #> xi_mu_centered[4,8,1] xi_mu_centered[5,8,1] xi_mu_centered[6,8,1]  #>          1.204406e-04          1.166293e-04          1.136438e-04  #> xi_mu_centered[7,8,1] xi_mu_centered[8,8,1] xi_mu_centered[9,8,1]  #>         -1.343228e-04          2.021882e-05          1.126589e-05  #> xi_nu_centered[1,1,1] xi_nu_centered[2,1,1] xi_nu_centered[3,1,1]  #>          1.215239e-04          7.797692e-05         -1.082363e-04  #> xi_nu_centered[4,1,1] xi_nu_centered[5,1,1] xi_nu_centered[6,1,1]  #>          3.248288e-05          1.121011e-04         -1.085679e-04  #> xi_nu_centered[7,1,1] xi_nu_centered[8,1,1] xi_nu_centered[9,1,1]  #>         -3.389769e-05          4.964206e-05         -1.162788e-04  #> xi_nu_centered[1,2,1] xi_nu_centered[2,2,1] xi_nu_centered[3,2,1]  #>         -4.135815e-05         -1.026665e-04         -1.410809e-04  #> xi_nu_centered[4,2,1] xi_nu_centered[5,2,1] xi_nu_centered[6,2,1]  #>         -1.459752e-04         -5.860814e-05         -1.446093e-04  #> xi_nu_centered[7,2,1] xi_nu_centered[8,2,1] xi_nu_centered[9,2,1]  #>         -1.491185e-04          1.343553e-04         -1.017297e-04  #> xi_nu_centered[1,3,1] xi_nu_centered[2,3,1] xi_nu_centered[3,3,1]  #>          1.395034e-04         -2.686342e-05         -1.051181e-04  #> xi_nu_centered[4,3,1] xi_nu_centered[5,3,1] xi_nu_centered[6,3,1]  #>          1.374700e-05          5.936720e-05         -7.435469e-05  #> xi_nu_centered[7,3,1] xi_nu_centered[8,3,1] xi_nu_centered[9,3,1]  #>          1.343733e-04          1.336507e-04          1.272684e-04  #> xi_nu_centered[1,4,1] xi_nu_centered[2,4,1] xi_nu_centered[3,4,1]  #>         -1.056534e-04          3.588127e-05         -3.744517e-05  #> xi_nu_centered[4,4,1] xi_nu_centered[5,4,1] xi_nu_centered[6,4,1]  #>          5.372678e-06          1.412279e-04         -6.690106e-05  #> xi_nu_centered[7,4,1] xi_nu_centered[8,4,1] xi_nu_centered[9,4,1]  #>          7.813344e-05         -6.292066e-05         -1.242217e-04  #> xi_nu_centered[1,5,1] xi_nu_centered[2,5,1] xi_nu_centered[3,5,1]  #>          7.947148e-05         -2.246328e-05         -9.515654e-05  #> xi_nu_centered[4,5,1] xi_nu_centered[5,5,1] xi_nu_centered[6,5,1]  #>         -6.839311e-05          1.398618e-04         -6.673449e-05  #> xi_nu_centered[7,5,1] xi_nu_centered[8,5,1] xi_nu_centered[9,5,1]  #>         -8.840356e-05          8.000024e-05         -6.797529e-05  #> xi_nu_centered[1,6,1] xi_nu_centered[2,6,1] xi_nu_centered[3,6,1]  #>          1.316235e-04         -7.040280e-05          3.277567e-05  #> xi_nu_centered[4,6,1] xi_nu_centered[5,6,1] xi_nu_centered[6,6,1]  #>          4.680114e-05         -1.171915e-04         -3.082885e-05  #> xi_nu_centered[7,6,1] xi_nu_centered[8,6,1] xi_nu_centered[9,6,1]  #>          3.072352e-05         -3.402543e-05         -4.347596e-05  #> xi_nu_centered[1,7,1] xi_nu_centered[2,7,1] xi_nu_centered[3,7,1]  #>         -1.401938e-04          5.389230e-05          3.131899e-07  #> xi_nu_centered[4,7,1] xi_nu_centered[5,7,1] xi_nu_centered[6,7,1]  #>         -1.128452e-04          1.058293e-04          1.125770e-04  #> xi_nu_centered[7,7,1] xi_nu_centered[8,7,1] xi_nu_centered[9,7,1]  #>          1.289084e-04          9.731231e-05          6.325383e-05  #> xi_nu_centered[1,8,1] xi_nu_centered[2,8,1] xi_nu_centered[3,8,1]  #>          3.761906e-05          1.185822e-04          3.840908e-05  #> xi_nu_centered[4,8,1] xi_nu_centered[5,8,1] xi_nu_centered[6,8,1]  #>          8.004224e-05         -3.832781e-05          1.164757e-04  #> xi_nu_centered[7,8,1] xi_nu_centered[8,8,1] xi_nu_centered[9,8,1]  #>         -6.570239e-05         -6.235481e-05          1.014363e-05  #>                  r[1]               xi[1,1]               xi[2,1]  #>          5.101515e+00          2.130891e-05          3.209212e-05  #>               xi[3,1]               xi[4,1]               xi[5,1]  #>          3.392875e-05          2.366385e-05          2.861247e-05  #>               xi[6,1]               xi[7,1]               xi[8,1]  #>          3.223686e-05          2.812701e-05          2.368183e-05  #>               xi[1,2]               xi[2,2]               xi[3,2]  #>          4.536148e-07         -9.232846e-07         -6.031424e-07  #>               xi[4,2]               xi[5,2]               xi[6,2]  #>          1.663373e-07          2.792320e-06          5.557490e-07  #>               xi[7,2]               xi[8,2]               xi[1,3]  #>          6.134639e-07         -4.062188e-07         -1.053304e-06  #>               xi[2,3]               xi[3,3]               xi[4,3]  #>          1.779693e-07          4.776345e-07         -7.025233e-07  #>               xi[5,3]               xi[6,3]               xi[7,3]  #>         -1.139332e-06          1.429242e-06          2.290066e-07  #>               xi[8,3]               xi[1,4]               xi[2,4]  #>          5.085271e-05          5.157195e-05          4.904337e-05  #>               xi[3,4]               xi[4,4]               xi[5,4]  #>          4.982767e-05          5.096793e-05          5.053788e-05  #>               xi[6,4]               xi[7,4]               xi[8,4]  #>          5.072438e-05          5.003581e-05          2.285169e-07  #>               xi[1,5]               xi[2,5]               xi[3,5]  #>         -1.571153e-06          2.302156e-06          1.969708e-08  #>               xi[4,5]               xi[5,5]               xi[6,5]  #>         -8.458113e-07         -1.913492e-06         -5.412097e-08  #>               xi[7,5]               xi[8,5]               xi[1,6]  #>         -1.106169e-06         -1.024897e-08         -2.113932e-07  #>               xi[2,6]               xi[3,6]               xi[4,6]  #>         -8.884798e-07         -4.101059e-07         -7.277950e-07  #>               xi[5,6]               xi[6,6]               xi[7,6]  #>          2.403416e-06         -1.252750e-06          1.071518e-06  #>               xi[8,6]               xi[1,7]               xi[2,7]  #>         -1.088268e-06         -1.568390e-06          1.674168e-07  #>               xi[3,7]               xi[4,7]               xi[5,7]  #>          2.474121e-07         -7.915974e-08          1.341968e-06  #>               xi[6,7]               xi[7,7]               xi[8,7]  #>          7.462544e-07         -3.653784e-07          1.497374e-06  #>               xi[1,8]               xi[2,8]               xi[3,8]  #>          6.882276e-07          2.329774e-06          1.807014e-06  #>               xi[4,8]               xi[5,8]               xi[6,8]  #>          1.399152e-06         -5.767326e-07         -8.065904e-07  #>               xi[7,8]               xi[8,8]               xi[1,9]  #>          1.609369e-07          3.803641e-07         -6.259780e-07  #>               xi[2,9]               xi[3,9]               xi[4,9]  #>          3.266786e-07         -1.451876e-06         -1.535445e-06  #>               xi[5,9]               xi[6,9]               xi[7,9]  #>         -2.816408e-07          1.296029e-06          1.207299e-06  #>               xi[8,9]              xi[1,10]              xi[2,10]  #>          8.243570e-07          1.116205e-06         -1.845078e-07  #>              xi[3,10]              xi[4,10]              xi[5,10]  #>          9.814862e-07         -8.407241e-08          1.038706e-06  #>              xi[6,10]              xi[7,10]              xi[8,10]  #>          6.104628e-08         -2.072554e-07         -8.090220e-07  #>           lambda[1,1]           lambda[2,1]           lambda[3,1]  #>          5.234861e+00          5.234881e+00          5.234883e+00  #>           lambda[4,1]           lambda[5,1]           lambda[6,1]  #>          5.234862e+00          5.234873e+00          5.234881e+00  #>           lambda[7,1]           lambda[8,1]           lambda[1,2]  #>          5.234870e+00          5.234861e+00          5.257300e+00  #>           lambda[2,2]           lambda[3,2]           lambda[4,2]  #>          5.257653e+00          5.257595e+00          5.257594e+00  #>           lambda[5,2]           lambda[6,2]           lambda[7,2]  #>          5.257614e+00          5.257231e+00          5.257226e+00  #>           lambda[8,2]           lambda[1,3]           lambda[2,3]  #>          5.257251e+00          5.257658e+00          5.257517e+00  #>           lambda[3,3]           lambda[4,3]           lambda[5,3]  #>          5.257452e+00          5.257650e+00          5.257201e+00  #>           lambda[6,3]           lambda[7,3]           lambda[8,3]  #>          5.257214e+00          5.257240e+00          5.257208e+00  #>           lambda[1,4]           lambda[2,4]           lambda[3,4]  #>          5.257585e+00          5.257602e+00          5.257605e+00  #>           lambda[4,4]           lambda[5,4]           lambda[6,4]  #>          5.257256e+00          5.257262e+00          5.257228e+00  #>           lambda[7,4]           lambda[8,4]           lambda[1,5]  #>          5.257201e+00          3.282603e-04          5.297822e+00  #>           lambda[2,5]           lambda[3,5]           lambda[4,5]  #>          5.297695e+00          5.297956e+00          5.297698e+00  #>           lambda[5,5]           lambda[6,5]           lambda[7,5]  #>          5.298050e+00          5.298205e+00          5.235190e+00  #>           lambda[8,5]           lambda[1,6]           lambda[2,6]  #>          5.235460e+00          5.298184e+00          5.297807e+00  #>           lambda[3,6]           lambda[4,6]           lambda[5,6]  #>          5.297983e+00          5.297998e+00          5.297832e+00  #>           lambda[6,6]           lambda[7,6]           lambda[8,6]  #>          5.256840e+00          5.256976e+00          5.257815e+00  #>           lambda[1,7]           lambda[2,7]           lambda[3,7]  #>          5.298037e+00          5.297963e+00          5.297954e+00  #>           lambda[4,7]           lambda[5,7]           lambda[6,7]  #>          5.297967e+00          5.257611e+00          5.257144e+00  #>           lambda[7,7]           lambda[8,7]           lambda[1,8]  #>          5.257988e+00          5.256773e+00          5.297837e+00  #>           lambda[2,8]           lambda[3,8]           lambda[4,8]  #>          5.297867e+00          5.297976e+00          5.257947e+00  #>           lambda[5,8]           lambda[6,8]           lambda[7,8]  #>          5.257710e+00          5.257007e+00          5.256588e+00  #>           lambda[8,8]           lambda[1,9]           lambda[2,9]  #>          6.882667e-04          5.298729e+00          5.298469e+00  #>           lambda[3,9]           lambda[4,9]           lambda[5,9]  #>          5.297303e+00          5.297396e+00          5.297907e+00  #>           lambda[6,9]           lambda[7,9]           lambda[8,9]  #>          5.298311e+00          5.235945e+00          5.235555e+00  #>          lambda[1,10]          lambda[2,10]          lambda[3,10]  #>          5.298423e+00          5.298246e+00          5.297488e+00  #>          lambda[4,10]          lambda[5,10]          lambda[6,10]  #>          5.297349e+00          5.297831e+00          5.257232e+00  #>          lambda[7,10]          lambda[8,10]        lambda_mean[1]  #>          5.256641e+00          5.257849e+00          5.234861e+00  #>        lambda_mean[2]        lambda_mean[3]        lambda_mean[4]  #>          5.234881e+00          5.234883e+00          5.234862e+00  #>        lambda_mean[5]        lambda_mean[6]        lambda_mean[7]  #>          5.234873e+00          5.234881e+00          5.234870e+00  #>        lambda_mean[8]        lambda_mean[9]       lambda_mean[10]  #>          5.234861e+00          5.257300e+00          5.257653e+00  #>       lambda_mean[11]       lambda_mean[12]       lambda_mean[13]  #>          5.257595e+00          5.257594e+00          5.257614e+00  #>       lambda_mean[14]       lambda_mean[15]       lambda_mean[16]  #>          5.257231e+00          5.257226e+00          5.257251e+00  #>       lambda_mean[17]       lambda_mean[18]       lambda_mean[19]  #>          5.257658e+00          5.257517e+00          5.257452e+00  #>       lambda_mean[20]       lambda_mean[21]       lambda_mean[22]  #>          5.257650e+00          5.257201e+00          5.257214e+00  #>       lambda_mean[23]       lambda_mean[24]       lambda_mean[25]  #>          5.257240e+00          5.257208e+00          5.257585e+00  #>       lambda_mean[26]       lambda_mean[27]       lambda_mean[28]  #>          5.257602e+00          5.257605e+00          5.257256e+00  #>       lambda_mean[29]       lambda_mean[30]       lambda_mean[31]  #>          5.257262e+00          5.257228e+00          5.257201e+00  #>       lambda_mean[32]       lambda_mean[33]       lambda_mean[34]  #>          5.297822e+00          5.297695e+00          5.297956e+00  #>       lambda_mean[35]       lambda_mean[36]       lambda_mean[37]  #>          5.297698e+00          5.298050e+00          5.298205e+00  #>       lambda_mean[38]       lambda_mean[39]       lambda_mean[40]  #>          5.298184e+00          5.297807e+00          5.297983e+00  #>       lambda_mean[41]       lambda_mean[42]       lambda_mean[43]  #>          5.297998e+00          5.297832e+00          5.298037e+00  #>       lambda_mean[44]       lambda_mean[45]       lambda_mean[46]  #>          5.297963e+00          5.297954e+00          5.297967e+00  #>       lambda_mean[47]       lambda_mean[48]       lambda_mean[49]  #>          5.297837e+00          5.297867e+00          5.297976e+00  #>       lambda_mean[50]       lambda_mean[51]       lambda_mean[52]  #>          5.298729e+00          5.298469e+00          5.298423e+00  #>                lprior  #>         -2.807774e+02  #>  #> $model$value #> [1] -563.3893 #>  #> $model$return_code #> [1] 0 #>  #> $model$theta_tilde #>      mu_0_centered[1,1] mu_0_centered[2,1] mu_0_centered[3,1] #> [1,]        0.008695474        0.009029034        0.009075741 #>      mu_0_centered[4,1] mu_0_centered[5,1] mu_0_centered[6,1] #> [1,]        0.008707466        0.008906273        0.009010565 #>      mu_0_centered[7,1] mu_0_centered[8,1] nu_0_centered[1,1] #> [1,]         0.00881494        0.008680038        0.003258983 #>      nu_0_centered[2,1] nu_0_centered[3,1] nu_0_centered[4,1] #> [1,]        0.003340114        0.003271248        0.003176726 #>      nu_0_centered[5,1] nu_0_centered[6,1] nu_0_centered[7,1] #> [1,]        0.003211583        0.003331721        0.003229173 #>      nu_0_centered[8,1]  phi_AR[1]  phi_AR[2] phi_AR[3]  theta_MA[1] #> [1,]        0.003125566 -0.9998022 -0.9999941 -0.999998 -0.002488439 #>       theta_MA[2] mu_0_mean nu_0_mean   mu_0_sd     nu_0_sd      xi_sd xi_mu_sd #> [1,] -0.001651588  2.617332  2.617241 0.0268965 0.009718561 0.01096011 5.022596 #>        xi_nu_sd xi_centered[1,1] xi_centered[2,1] xi_centered[3,1] #> [1,] 0.04536019      0.001944224      0.002928083      0.003095657 #>      xi_centered[4,1] xi_centered[5,1] xi_centered[6,1] xi_centered[7,1] #> [1,]      0.002159088      0.002610599      0.002941288      0.002566306 #>      xi_centered[8,1] xi_centered[1,2] xi_centered[2,2] xi_centered[3,2] #> [1,]      0.002160728     4.138778e-05    -8.424042e-05    -5.503067e-05 #>      xi_centered[4,2] xi_centered[5,2] xi_centered[6,2] xi_centered[7,2] #> [1,]      1.51766e-05      0.000254771      5.07065e-05     5.597241e-05 #>      xi_centered[8,2] xi_centered[1,3] xi_centered[2,3] xi_centered[3,3] #> [1,]    -3.706338e-05    -9.610335e-05     1.623791e-05     4.357934e-05 #>      xi_centered[4,3] xi_centered[5,3] xi_centered[6,3] xi_centered[7,3] #> [1,]    -6.409817e-05    -0.0001039526     0.0001304039     2.089455e-05 #>      xi_centered[8,3] xi_centered[1,4] xi_centered[2,4] xi_centered[3,4] #> [1,]      0.004639797      0.004705421      0.004474714      0.004546273 #>      xi_centered[4,4] xi_centered[5,4] xi_centered[6,4] xi_centered[7,4] #> [1,]       0.00465031      0.004611072      0.004628089      0.004565264 #>      xi_centered[8,4] xi_centered[1,5] xi_centered[2,5] xi_centered[3,5] #> [1,]     2.084986e-05    -0.0001433519     0.0002100486      1.79716e-06 #>      xi_centered[4,5] xi_centered[5,5] xi_centered[6,5] xi_centered[7,5] #> [1,]    -7.717176e-05    -0.0001745868    -4.937993e-06    -0.0001009268 #>      xi_centered[8,5] xi_centered[1,6] xi_centered[2,6] xi_centered[3,6] #> [1,]    -9.351155e-07     -1.92875e-05    -8.106483e-05    -3.741803e-05 #>      xi_centered[4,6] xi_centered[5,6] xi_centered[6,6] xi_centered[7,6] #> [1,]    -6.640396e-05     0.0002192875    -0.0001143008     9.776524e-05 #>      xi_centered[8,6] xi_centered[1,7] xi_centered[2,7] xi_centered[3,7] #> [1,]    -9.929354e-05    -0.0001430998      1.52751e-05     2.257386e-05 #>      xi_centered[4,7] xi_centered[5,7] xi_centered[6,7] xi_centered[7,7] #> [1,]    -7.222529e-06     0.0001224411      6.80882e-05     -3.33371e-05 #>      xi_centered[8,7] xi_centered[1,8] xi_centered[2,8] xi_centered[3,8] #> [1,]     0.0001366203     6.279384e-05     0.0002125685     0.0001648718 #>      xi_centered[4,8] xi_centered[5,8] xi_centered[6,8] xi_centered[7,8] #> [1,]     0.0001276585    -5.262104e-05    -7.359325e-05     1.468387e-05 #>      xi_centered[8,8] xi_centered[1,9] xi_centered[2,9] xi_centered[3,9] #> [1,]      3.47044e-05    -5.711419e-05     2.980613e-05     -0.000132469 #>      xi_centered[4,9] xi_centered[5,9] xi_centered[6,9] xi_centered[7,9] #> [1,]    -0.0001400939    -2.569689e-05     0.0001182496     0.0001101539 #>      xi_centered[8,9] xi_centered[1,10] xi_centered[2,10] xi_centered[3,10] #> [1,]     7.521428e-05      0.0001018425     -1.683448e-05      8.955073e-05 #>      xi_centered[4,10] xi_centered[5,10] xi_centered[6,10] xi_centered[7,10] #> [1,]      -7.67076e-06      9.477144e-05      5.569858e-06     -1.890997e-05 #>      xi_centered[8,10] xi_mu_centered[1,1,1] xi_mu_centered[2,1,1] #> [1,]     -7.381511e-05              1.046732              1.046795 #>      xi_mu_centered[3,1,1] xi_mu_centered[4,1,1] xi_mu_centered[5,1,1] #> [1,]               1.04657            0.01254545           0.008139691 #>      xi_mu_centered[6,1,1] xi_mu_centered[7,1,1] xi_mu_centered[8,1,1] #> [1,]           0.008039588           0.008012072          0.0001806473 #>      xi_mu_centered[9,1,1] xi_mu_centered[1,2,1] xi_mu_centered[2,2,1] #> [1,]          4.719783e-05              1.046804              1.046766 #>      xi_mu_centered[3,2,1] xi_mu_centered[4,2,1] xi_mu_centered[5,2,1] #> [1,]              1.046574            0.01251466           0.007995411 #>      xi_mu_centered[6,2,1] xi_mu_centered[7,2,1] xi_mu_centered[8,2,1] #> [1,]           0.008052604           0.008014796          0.0001545633 #>      xi_mu_centered[9,2,1] xi_mu_centered[1,3,1] xi_mu_centered[2,3,1] #> [1,]          8.736249e-05              1.046793              1.046754 #>      xi_mu_centered[3,3,1] xi_mu_centered[4,3,1] xi_mu_centered[5,3,1] #> [1,]              1.046574            0.01256677           0.008041342 #>      xi_mu_centered[6,3,1] xi_mu_centered[7,3,1] xi_mu_centered[8,3,1] #> [1,]           0.008063744           0.008035976         -0.0001294317 #>      xi_mu_centered[9,3,1] xi_mu_centered[1,4,1] xi_mu_centered[2,4,1] #> [1,]         -9.889491e-05              1.046791              1.046793 #>      xi_mu_centered[3,4,1] xi_mu_centered[4,4,1] xi_mu_centered[5,4,1] #> [1,]              1.046504            0.01251992           0.008044365 #>      xi_mu_centered[6,4,1] xi_mu_centered[7,4,1] xi_mu_centered[8,4,1] #> [1,]           0.008026837          0.0001357902         -5.952635e-05 #>      xi_mu_centered[9,4,1] xi_mu_centered[1,5,1] xi_mu_centered[2,5,1] #> [1,]         -0.0001293317              1.046795              1.046704 #>      xi_mu_centered[3,5,1] xi_mu_centered[4,5,1] xi_mu_centered[5,5,1] #> [1,]              1.046506             0.0125881           0.008006614 #>      xi_mu_centered[6,5,1] xi_mu_centered[7,5,1] xi_mu_centered[8,5,1] #> [1,]          8.187813e-05          8.806164e-05         -2.849298e-05 #>      xi_mu_centered[9,5,1] xi_mu_centered[1,6,1] xi_mu_centered[2,6,1] #> [1,]          1.115674e-06               1.04672              1.046706 #>      xi_mu_centered[3,6,1] xi_mu_centered[4,6,1] xi_mu_centered[5,6,1] #> [1,]              1.046499            0.01261713         -7.778759e-05 #>      xi_mu_centered[6,6,1] xi_mu_centered[7,6,1] xi_mu_centered[8,6,1] #> [1,]          -1.43699e-05          -4.52434e-05          2.233704e-05 #>      xi_mu_centered[9,6,1] xi_mu_centered[1,7,1] xi_mu_centered[2,7,1] #> [1,]          7.828878e-05              1.046718              1.046712 #>      xi_mu_centered[3,7,1] xi_mu_centered[4,7,1] xi_mu_centered[5,7,1] #> [1,]              1.046494          7.302978e-05         -5.030137e-05 #>      xi_mu_centered[6,7,1] xi_mu_centered[7,7,1] xi_mu_centered[8,7,1] #> [1,]          0.0001491505         -0.0001213841          0.0001492409 #>      xi_mu_centered[9,7,1] xi_mu_centered[1,8,1] xi_mu_centered[2,8,1] #> [1,]         -6.629775e-05              1.046722              1.046695 #>      xi_mu_centered[3,8,1] xi_mu_centered[4,8,1] xi_mu_centered[5,8,1] #> [1,]         -0.0001307718          0.0001204406          0.0001166293 #>      xi_mu_centered[6,8,1] xi_mu_centered[7,8,1] xi_mu_centered[8,8,1] #> [1,]          0.0001136438         -0.0001343228          2.021882e-05 #>      xi_mu_centered[9,8,1] xi_nu_centered[1,1,1] xi_nu_centered[2,1,1] #> [1,]          1.126589e-05          0.0001215239          7.797692e-05 #>      xi_nu_centered[3,1,1] xi_nu_centered[4,1,1] xi_nu_centered[5,1,1] #> [1,]         -0.0001082363          3.248288e-05          0.0001121011 #>      xi_nu_centered[6,1,1] xi_nu_centered[7,1,1] xi_nu_centered[8,1,1] #> [1,]         -0.0001085679         -3.389769e-05          4.964206e-05 #>      xi_nu_centered[9,1,1] xi_nu_centered[1,2,1] xi_nu_centered[2,2,1] #> [1,]         -0.0001162788         -4.135815e-05         -0.0001026665 #>      xi_nu_centered[3,2,1] xi_nu_centered[4,2,1] xi_nu_centered[5,2,1] #> [1,]         -0.0001410809         -0.0001459752         -5.860814e-05 #>      xi_nu_centered[6,2,1] xi_nu_centered[7,2,1] xi_nu_centered[8,2,1] #> [1,]         -0.0001446093         -0.0001491185          0.0001343553 #>      xi_nu_centered[9,2,1] xi_nu_centered[1,3,1] xi_nu_centered[2,3,1] #> [1,]         -0.0001017297          0.0001395034         -2.686342e-05 #>      xi_nu_centered[3,3,1] xi_nu_centered[4,3,1] xi_nu_centered[5,3,1] #> [1,]         -0.0001051181            1.3747e-05           5.93672e-05 #>      xi_nu_centered[6,3,1] xi_nu_centered[7,3,1] xi_nu_centered[8,3,1] #> [1,]         -7.435469e-05          0.0001343733          0.0001336507 #>      xi_nu_centered[9,3,1] xi_nu_centered[1,4,1] xi_nu_centered[2,4,1] #> [1,]          0.0001272684         -0.0001056534          3.588127e-05 #>      xi_nu_centered[3,4,1] xi_nu_centered[4,4,1] xi_nu_centered[5,4,1] #> [1,]         -3.744517e-05          5.372678e-06          0.0001412279 #>      xi_nu_centered[6,4,1] xi_nu_centered[7,4,1] xi_nu_centered[8,4,1] #> [1,]         -6.690106e-05          7.813344e-05         -6.292066e-05 #>      xi_nu_centered[9,4,1] xi_nu_centered[1,5,1] xi_nu_centered[2,5,1] #> [1,]         -0.0001242217          7.947148e-05         -2.246328e-05 #>      xi_nu_centered[3,5,1] xi_nu_centered[4,5,1] xi_nu_centered[5,5,1] #> [1,]         -9.515654e-05         -6.839311e-05          0.0001398618 #>      xi_nu_centered[6,5,1] xi_nu_centered[7,5,1] xi_nu_centered[8,5,1] #> [1,]         -6.673449e-05         -8.840356e-05          8.000024e-05 #>      xi_nu_centered[9,5,1] xi_nu_centered[1,6,1] xi_nu_centered[2,6,1] #> [1,]         -6.797529e-05          0.0001316235          -7.04028e-05 #>      xi_nu_centered[3,6,1] xi_nu_centered[4,6,1] xi_nu_centered[5,6,1] #> [1,]          3.277567e-05          4.680114e-05         -0.0001171915 #>      xi_nu_centered[6,6,1] xi_nu_centered[7,6,1] xi_nu_centered[8,6,1] #> [1,]         -3.082885e-05          3.072352e-05         -3.402543e-05 #>      xi_nu_centered[9,6,1] xi_nu_centered[1,7,1] xi_nu_centered[2,7,1] #> [1,]         -4.347596e-05         -0.0001401938           5.38923e-05 #>      xi_nu_centered[3,7,1] xi_nu_centered[4,7,1] xi_nu_centered[5,7,1] #> [1,]          3.131899e-07         -0.0001128452          0.0001058293 #>      xi_nu_centered[6,7,1] xi_nu_centered[7,7,1] xi_nu_centered[8,7,1] #> [1,]           0.000112577          0.0001289084          9.731231e-05 #>      xi_nu_centered[9,7,1] xi_nu_centered[1,8,1] xi_nu_centered[2,8,1] #> [1,]          6.325383e-05          3.761906e-05          0.0001185822 #>      xi_nu_centered[3,8,1] xi_nu_centered[4,8,1] xi_nu_centered[5,8,1] #> [1,]          3.840908e-05          8.004224e-05         -3.832781e-05 #>      xi_nu_centered[6,8,1] xi_nu_centered[7,8,1] xi_nu_centered[8,8,1] #> [1,]          0.0001164757         -6.570239e-05         -6.235481e-05 #>      xi_nu_centered[9,8,1]     r[1]      xi[1,1]      xi[2,1]      xi[3,1] #> [1,]          1.014363e-05 5.101515 2.130891e-05 3.209212e-05 3.392875e-05 #>           xi[4,1]      xi[5,1]      xi[6,1]      xi[7,1]      xi[8,1] #> [1,] 2.366385e-05 2.861247e-05 3.223686e-05 2.812701e-05 2.368183e-05 #>           xi[1,2]       xi[2,2]       xi[3,2]      xi[4,2]     xi[5,2] #> [1,] 4.536148e-07 -9.232846e-07 -6.031424e-07 1.663373e-07 2.79232e-06 #>          xi[6,2]      xi[7,2]       xi[8,2]       xi[1,3]      xi[2,3] #> [1,] 5.55749e-07 6.134639e-07 -4.062188e-07 -1.053304e-06 1.779693e-07 #>           xi[3,3]       xi[4,3]       xi[5,3]      xi[6,3]      xi[7,3] #> [1,] 4.776345e-07 -7.025233e-07 -1.139332e-06 1.429242e-06 2.290066e-07 #>           xi[8,3]      xi[1,4]      xi[2,4]      xi[3,4]      xi[4,4] #> [1,] 5.085271e-05 5.157195e-05 4.904337e-05 4.982767e-05 5.096793e-05 #>           xi[5,4]      xi[6,4]      xi[7,4]      xi[8,4]       xi[1,5] #> [1,] 5.053788e-05 5.072438e-05 5.003581e-05 2.285169e-07 -1.571153e-06 #>           xi[2,5]      xi[3,5]       xi[4,5]       xi[5,5]       xi[6,5] #> [1,] 2.302156e-06 1.969708e-08 -8.458113e-07 -1.913492e-06 -5.412097e-08 #>            xi[7,5]       xi[8,5]       xi[1,6]       xi[2,6]       xi[3,6] #> [1,] -1.106169e-06 -1.024897e-08 -2.113932e-07 -8.884798e-07 -4.101059e-07 #>           xi[4,6]      xi[5,6]      xi[6,6]      xi[7,6]       xi[8,6] #> [1,] -7.27795e-07 2.403416e-06 -1.25275e-06 1.071518e-06 -1.088268e-06 #>           xi[1,7]      xi[2,7]      xi[3,7]       xi[4,7]      xi[5,7] #> [1,] -1.56839e-06 1.674168e-07 2.474121e-07 -7.915974e-08 1.341968e-06 #>           xi[6,7]       xi[7,7]      xi[8,7]      xi[1,8]      xi[2,8] #> [1,] 7.462544e-07 -3.653784e-07 1.497374e-06 6.882276e-07 2.329774e-06 #>           xi[3,8]      xi[4,8]       xi[5,8]       xi[6,8]      xi[7,8] #> [1,] 1.807014e-06 1.399152e-06 -5.767326e-07 -8.065904e-07 1.609369e-07 #>           xi[8,8]      xi[1,9]      xi[2,9]       xi[3,9]       xi[4,9] #> [1,] 3.803641e-07 -6.25978e-07 3.266786e-07 -1.451876e-06 -1.535445e-06 #>            xi[5,9]      xi[6,9]      xi[7,9]     xi[8,9]     xi[1,10] #> [1,] -2.816408e-07 1.296029e-06 1.207299e-06 8.24357e-07 1.116205e-06 #>           xi[2,10]     xi[3,10]      xi[4,10]     xi[5,10]     xi[6,10] #> [1,] -1.845078e-07 9.814862e-07 -8.407241e-08 1.038706e-06 6.104628e-08 #>           xi[7,10]     xi[8,10] lambda[1,1] lambda[2,1] lambda[3,1] lambda[4,1] #> [1,] -2.072554e-07 -8.09022e-07    5.234861    5.234881    5.234883    5.234862 #>      lambda[5,1] lambda[6,1] lambda[7,1] lambda[8,1] lambda[1,2] lambda[2,2] #> [1,]    5.234873    5.234881     5.23487    5.234861      5.2573    5.257653 #>      lambda[3,2] lambda[4,2] lambda[5,2] lambda[6,2] lambda[7,2] lambda[8,2] #> [1,]    5.257595    5.257594    5.257614    5.257231    5.257226    5.257251 #>      lambda[1,3] lambda[2,3] lambda[3,3] lambda[4,3] lambda[5,3] lambda[6,3] #> [1,]    5.257658    5.257517    5.257452     5.25765    5.257201    5.257214 #>      lambda[7,3] lambda[8,3] lambda[1,4] lambda[2,4] lambda[3,4] lambda[4,4] #> [1,]     5.25724    5.257208    5.257585    5.257602    5.257605    5.257256 #>      lambda[5,4] lambda[6,4] lambda[7,4]  lambda[8,4] lambda[1,5] lambda[2,5] #> [1,]    5.257262    5.257228    5.257201 0.0003282603    5.297822    5.297695 #>      lambda[3,5] lambda[4,5] lambda[5,5] lambda[6,5] lambda[7,5] lambda[8,5] #> [1,]    5.297956    5.297698     5.29805    5.298205     5.23519     5.23546 #>      lambda[1,6] lambda[2,6] lambda[3,6] lambda[4,6] lambda[5,6] lambda[6,6] #> [1,]    5.298184    5.297807    5.297983    5.297998    5.297832     5.25684 #>      lambda[7,6] lambda[8,6] lambda[1,7] lambda[2,7] lambda[3,7] lambda[4,7] #> [1,]    5.256976    5.257815    5.298037    5.297963    5.297954    5.297967 #>      lambda[5,7] lambda[6,7] lambda[7,7] lambda[8,7] lambda[1,8] lambda[2,8] #> [1,]    5.257611    5.257144    5.257988    5.256773    5.297837    5.297867 #>      lambda[3,8] lambda[4,8] lambda[5,8] lambda[6,8] lambda[7,8]  lambda[8,8] #> [1,]    5.297976    5.257947     5.25771    5.257007    5.256588 0.0006882667 #>      lambda[1,9] lambda[2,9] lambda[3,9] lambda[4,9] lambda[5,9] lambda[6,9] #> [1,]    5.298729    5.298469    5.297303    5.297396    5.297907    5.298311 #>      lambda[7,9] lambda[8,9] lambda[1,10] lambda[2,10] lambda[3,10] #> [1,]    5.235945    5.235555     5.298423     5.298246     5.297488 #>      lambda[4,10] lambda[5,10] lambda[6,10] lambda[7,10] lambda[8,10] #> [1,]     5.297349     5.297831     5.257232     5.256641     5.257849 #>      lambda_mean[1] lambda_mean[2] lambda_mean[3] lambda_mean[4] lambda_mean[5] #> [1,]       5.234861       5.234881       5.234883       5.234862       5.234873 #>      lambda_mean[6] lambda_mean[7] lambda_mean[8] lambda_mean[9] #> [1,]       5.234881        5.23487       5.234861         5.2573 #>      lambda_mean[10] lambda_mean[11] lambda_mean[12] lambda_mean[13] #> [1,]        5.257653        5.257595        5.257594        5.257614 #>      lambda_mean[14] lambda_mean[15] lambda_mean[16] lambda_mean[17] #> [1,]        5.257231        5.257226        5.257251        5.257658 #>      lambda_mean[18] lambda_mean[19] lambda_mean[20] lambda_mean[21] #> [1,]        5.257517        5.257452         5.25765        5.257201 #>      lambda_mean[22] lambda_mean[23] lambda_mean[24] lambda_mean[25] #> [1,]        5.257214         5.25724        5.257208        5.257585 #>      lambda_mean[26] lambda_mean[27] lambda_mean[28] lambda_mean[29] #> [1,]        5.257602        5.257605        5.257256        5.257262 #>      lambda_mean[30] lambda_mean[31] lambda_mean[32] lambda_mean[33] #> [1,]        5.257228        5.257201        5.297822        5.297695 #>      lambda_mean[34] lambda_mean[35] lambda_mean[36] lambda_mean[37] #> [1,]        5.297956        5.297698         5.29805        5.298205 #>      lambda_mean[38] lambda_mean[39] lambda_mean[40] lambda_mean[41] #> [1,]        5.298184        5.297807        5.297983        5.297998 #>      lambda_mean[42] lambda_mean[43] lambda_mean[44] lambda_mean[45] #> [1,]        5.297832        5.298037        5.297963        5.297954 #>      lambda_mean[46] lambda_mean[47] lambda_mean[48] lambda_mean[49] #> [1,]        5.297967        5.297837        5.297867        5.297976 #>      lambda_mean[50] lambda_mean[51] lambda_mean[52]    lprior #> [1,]        5.298729        5.298469        5.298423 -280.7774 #>  #>"},{"path":"https://rodrigozepeda.github.io/diseasenowcasting/reference/nowcast.rstan.html","id":null,"dir":"Reference","previous_headings":"","what":"Nowcasting with the `rstan` engine ‚Äî nowcast.rstan","title":"Nowcasting with the `rstan` engine ‚Äî nowcast.rstan","text":"Nowcasting `rstan` engine","code":""},{"path":"https://rodrigozepeda.github.io/diseasenowcasting/reference/nowcast.rstan.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Nowcasting with the `rstan` engine ‚Äî nowcast.rstan","text":"","code":"nowcast.rstan(   .disease_data,   onset_date,   report_date,   num_steps,   num_delays,   num_strata,   dist,   prior_only,   control,   refresh,   method,   priors,   ... )"},{"path":"https://rodrigozepeda.github.io/diseasenowcasting/reference/nowcast.rstan.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Nowcasting with the `rstan` engine ‚Äî nowcast.rstan","text":".disease_data time series reporting data aggregated line list format row column onset date, report date, onset_date quotations, name column datatype Date designating date case onset. e.g. \"onset_week\" report_date quotations, name column datatype Date designating date case report. e.g. \"report_week\" num_steps Number time steps run model num_delays Number delays consider model num_strata Number strata model dist Distribution. Either \"NegativeBinomial\"  \"Poisson\" prior_only Boolean variable indicating whether compute prior distribution control Control parameter [rstan::sampling()] refresh Refresh parameter [rstan::sampling()] method Fitting method either `sampling` (recommended inference), `variational` (recommended testing) `optimization`. `sampling` method calls [rstan::sampling()] `variational` calls [rstan::vb()] `optimization` calls [rstan::optimizing()] priors list nowcast priors. can use [set_priors()] change priors function (see details) ... Additional arguments pass [rstan::sampling()]","code":""},{"path":"https://rodrigozepeda.github.io/diseasenowcasting/reference/preprocess_for_nowcast.html","id":null,"dir":"Reference","previous_headings":"","what":"Preprocess data.frame for generating a nowcast ‚Äî preprocess_for_nowcast","title":"Preprocess data.frame for generating a nowcast ‚Äî preprocess_for_nowcast","text":"Function takes data frame `onset_date` `report_date` generates possible combinations onset_dates report_dates observable controlling covariates specified `...`","code":""},{"path":"https://rodrigozepeda.github.io/diseasenowcasting/reference/preprocess_for_nowcast.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Preprocess data.frame for generating a nowcast ‚Äî preprocess_for_nowcast","text":"","code":"preprocess_for_nowcast(   .disease_data,   onset_date,   report_date,   strata = NULL,   now,   units,   max_delay = Inf,   data_type = c(\"auto\", \"linelist\", \"count\") )"},{"path":"https://rodrigozepeda.github.io/diseasenowcasting/reference/preprocess_for_nowcast.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Preprocess data.frame for generating a nowcast ‚Äî preprocess_for_nowcast","text":".disease_data time series reporting data aggregated line list format row column onset date, report date, onset_date quotations, name column datatype Date designating date case onset. e.g. \"onset_week\" report_date quotations, name column datatype Date designating date case report. e.g. \"report_week\" strata Character vector names strata included data. now object datatype Date indicating date perform nowcast. units Time scale reporting. Options: \"1 day\", \"1 week\". max_delay Maximum possible delay observed considered estimation delay distribution (numeric). Default: `Inf` data_type Either `linedata` row represents test `counts` column named `n` counts many tests onset report dates","code":""},{"path":"https://rodrigozepeda.github.io/diseasenowcasting/reference/preprocess_for_nowcast.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Preprocess data.frame for generating a nowcast ‚Äî preprocess_for_nowcast","text":"`data.frame` possible counts delay-onset combinations. new column counts named `n`. Additional columns `.tval` `.delay` added `.tval` codifies dates numbers (starting 0) delay codifies difference onset report.","code":""},{"path":"https://rodrigozepeda.github.io/diseasenowcasting/reference/preprocess_for_nowcast.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Preprocess data.frame for generating a nowcast ‚Äî preprocess_for_nowcast","text":"","code":"data(denguedat)  # Get counts by onset date and report week consider all possible delays preprocess_for_nowcast(denguedat, \"onset_week\", \"report_week\",   units = \"weeks\", now = as.Date(\"1990-03-05\") ) #> ‚Ñπ Assuming data is linelist-data where each observation is a test. If you are working with count-data set `data_type = \"count\"` #> # A tibble: 55 √ó 5 #>        n .tval .delay onset_week report_week #>    <int> <dbl>  <dbl> <date>     <date>      #>  1     3     1      0 1990-01-01 1990-01-01  #>  2    24     1      1 1990-01-01 1990-01-08  #>  3    23     1      2 1990-01-01 1990-01-15  #>  4     8     1      3 1990-01-01 1990-01-22  #>  5     1     1      4 1990-01-01 1990-01-29  #>  6     0     1      5 1990-01-01 1990-02-05  #>  7     1     1      6 1990-01-01 1990-02-12  #>  8     0     1      7 1990-01-01 1990-02-19  #>  9     0     1      8 1990-01-01 1990-02-26  #> 10     1     1      9 1990-01-01 1990-03-05  #> # ‚Ñπ 45 more rows  # Complete one date when there was no onset week df <- data.frame(   onset_week  = as.Date(c(\"1994-09-19\", \"1994-10-03\", \"1994-10-03\", \"1994-10-10\")),   report_week = as.Date(c(\"1994-09-19\", \"1994-10-03\", \"1994-10-10\", \"1994-10-10\")) ) preprocess_for_nowcast(df, \"onset_week\", \"report_week\",   units = \"weeks\",   now = as.Date(\"1994-10-10\") ) #> ‚Ñπ Assuming data is linelist-data where each observation is a test. If you are working with count-data set `data_type = \"count\"` #> # A tibble: 7 √ó 5 #>       n .tval .delay onset_week report_week #>   <int> <dbl>  <dbl> <date>     <date>      #> 1     1     1      0 1994-09-19 1994-09-19  #> 2     0     1      1 1994-09-19 1994-09-26  #> 3     0     2      0 1994-09-26 1994-09-26  #> 4     0     2      1 1994-09-26 1994-10-03  #> 5     1     3      0 1994-10-03 1994-10-03  #> 6     1     3      1 1994-10-03 1994-10-10  #> 7     1     4      0 1994-10-10 1994-10-10   # Complete one date when there was no report of delay 3 mostly df <- data.frame(   onset_week  = as.Date(c(\"1994-09-19\", \"1994-10-03\", \"1994-10-03\", \"1994-10-10\")),   report_week = as.Date(c(\"1994-10-10\", \"1994-10-03\", \"1994-10-10\", \"1994-10-10\")) ) preprocess_for_nowcast(df, \"onset_week\", \"report_week\",   units = \"weeks\",   now = as.Date(\"1994-10-10\") ) #> ‚Ñπ Assuming data is linelist-data where each observation is a test. If you are working with count-data set `data_type = \"count\"` #> # A tibble: 10 √ó 5 #>        n .tval .delay onset_week report_week #>    <int> <dbl>  <dbl> <date>     <date>      #>  1     0     1      0 1994-09-19 1994-09-19  #>  2     0     1      1 1994-09-19 1994-09-26  #>  3     0     1      2 1994-09-19 1994-10-03  #>  4     1     1      3 1994-09-19 1994-10-10  #>  5     0     2      0 1994-09-26 1994-09-26  #>  6     0     2      1 1994-09-26 1994-10-03  #>  7     0     2      2 1994-09-26 1994-10-10  #>  8     1     3      0 1994-10-03 1994-10-03  #>  9     1     3      1 1994-10-03 1994-10-10  #> 10     1     4      0 1994-10-10 1994-10-10   # Get counts by onset date and report week stratifying by gender and state df <- data.frame(   onset_week = sample(as.Date(c(\"1994-09-19\", \"1994-10-03\", \"1994-10-10\")), 100, replace = TRUE),   gender = sample(c(\"Male\", \"Female\"), 100, replace = TRUE),   state = sample(c(\"A\", \"B\", \"C\", \"D\"), prob = c(0.5, 0.2, 0.2, 0.1), size = 100, replace = TRUE) ) df$report_week <- df$onset_week +   sample(c(lubridate::weeks(1), lubridate::weeks(2)), 100, replace = TRUE) preprocess_for_nowcast(df, \"onset_week\", \"report_week\", c(\"gender\", \"state\"),   units = \"weeks\",   now = as.Date(\"1994-09-26\") ) #> ‚Ñπ Assuming data is linelist-data where each observation is a test. If you are working with count-data set `data_type = \"count\"` #> # A tibble: 8 √ó 7 #>       n .tval .delay onset_week gender state report_week #>   <int> <dbl>  <dbl> <date>     <chr>  <chr> <date>      #> 1     6     1      1 1994-09-19 Male   A     1994-09-26  #> 2     0     1      1 1994-09-19 Male   C     1994-09-26  #> 3     2     1      1 1994-09-19 Male   B     1994-09-26  #> 4     1     1      1 1994-09-19 Male   D     1994-09-26  #> 5     2     1      1 1994-09-19 Female A     1994-09-26  #> 6     3     1      1 1994-09-19 Female C     1994-09-26  #> 7     2     1      1 1994-09-19 Female B     1994-09-26  #> 8     0     1      1 1994-09-19 Female D     1994-09-26"},{"path":"https://rodrigozepeda.github.io/diseasenowcasting/reference/preprocess_strata.html","id":null,"dir":"Reference","previous_headings":"","what":"Get strata ‚Äî preprocess_strata","title":"Get strata ‚Äî preprocess_strata","text":"Function preprocess strata .disease_data","code":""},{"path":"https://rodrigozepeda.github.io/diseasenowcasting/reference/preprocess_strata.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get strata ‚Äî preprocess_strata","text":"","code":"preprocess_strata(.disease_data, strata)"},{"path":"https://rodrigozepeda.github.io/diseasenowcasting/reference/preprocess_strata.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get strata ‚Äî preprocess_strata","text":".disease_data data frame collapse strata strata vector names strata","code":""},{"path":"https://rodrigozepeda.github.io/diseasenowcasting/reference/preprocess_strata.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get strata ‚Äî preprocess_strata","text":"list three entries:","code":""},{"path":"https://rodrigozepeda.github.io/diseasenowcasting/reference/priors_to_numeric.html","id":null,"dir":"Reference","previous_headings":"","what":"Function for setting the priors to numeric ‚Äî priors_to_numeric","title":"Function for setting the priors to numeric ‚Äî priors_to_numeric","text":"Function setting priors numeric","code":""},{"path":"https://rodrigozepeda.github.io/diseasenowcasting/reference/priors_to_numeric.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Function for setting the priors to numeric ‚Äî priors_to_numeric","text":"","code":"priors_to_numeric(.disease_data, priors)"},{"path":"https://rodrigozepeda.github.io/diseasenowcasting/reference/priors_to_numeric.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Function for setting the priors to numeric ‚Äî priors_to_numeric","text":"priors list priors generated `set_priors()`","code":""},{"path":"https://rodrigozepeda.github.io/diseasenowcasting/reference/priors_to_numeric.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Function for setting the priors to numeric ‚Äî priors_to_numeric","text":"list priors numeric codes RStan requires distributions","code":""},{"path":"https://rodrigozepeda.github.io/diseasenowcasting/reference/set_priors.html","id":null,"dir":"Reference","previous_headings":"","what":"Get nowcast priors ‚Äî set_priors","title":"Get nowcast priors ‚Äî set_priors","text":"Function return default values [nowcast()] function list.","code":""},{"path":"https://rodrigozepeda.github.io/diseasenowcasting/reference/set_priors.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get nowcast priors ‚Äî set_priors","text":"","code":"set_priors(   mu_degree = 1,   nu_degree = 1,   p = 3,   q = 2,   mu_is_constant = FALSE,   nu_is_constant = TRUE,   mu_sd_prior = \"standard_normal\",   nu_sd_prior = \"standard_normal\",   mu_sd_param_1 = 0,   mu_sd_param_2 = 0.1,   nu_sd_param_1 = 0,   nu_sd_param_2 = 0.1,   phi_AR_param_1 = 0,   phi_AR_param_2 = 1,   phi_AR_prior = \"cauchy\",   theta_MA_param_1 = 0,   theta_MA_param_2 = 1,   theta_MA_prior = \"cauchy\",   xi_sd_param_1 = 0,   xi_sd_param_2 = 1,   xi_sd_prior = \"standard_normal\",   mu_0_mean_param_1 = \"auto\",   mu_0_mean_param_2 = 0.01,   mu_0_sd_param_1 = \"auto\",   mu_0_sd_param_2 = 0.01,   nu_0_mean_param_1 = 0,   nu_0_mean_param_2 = 0.01,   nu_0_sd_param_1 = 0,   nu_0_sd_param_2 = 0.01,   mu_0_mean_hyperprior = \"standard_normal\",   nu_0_mean_hyperprior = \"standard_normal\",   mu_0_sd_hyperprior = \"standard_normal\",   nu_0_sd_hyperprior = \"standard_normal\",   r_prior = \"standard_normal\",   r_param_1 = 0,   r_param_2 = 1 )"},{"path":"https://rodrigozepeda.github.io/diseasenowcasting/reference/set_priors.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get nowcast priors ‚Äî set_priors","text":"mu_degree Integer. Degree epidemic trend. nu_degree Integer. Degree delay trend. p Integer. number lags consider autocorrelated AR(p) model q Integer. number lags consider moving average MA(q) model mu_is_constant Logical. Indicates whether epidemic trend constant. nu_is_constant Logical. Indicates whether delay trend constant. mu_sd_prior Character. Prior epidemic trend error. nu_sd_prior Character. Prior delay trend error. mu_sd_param_1 Numeric. First parameter epidemic trend error. mu_sd_param_2 Numeric. Second parameter epidemic trend error. nu_sd_param_1 Numeric. First parameter delay trend error. nu_sd_param_2 Numeric. Second parameter delay trend error. phi_AR_param_1 Numeric. Prior AR coefficients' first parameter. phi_AR_param_2 Numeric. Prior AR coefficients' second parameter. phi_AR_prior String Prior distirbution name AR coefficients. theta_MA_param_1 Numeric. Prior MA coefficients' first parameter. theta_MA_param_2 Numeric. Prior MA coefficients' second parameter. theta_MA_prior String Prior distirbution name MA coefficients. xi_sd_param_1 Numeric. Prior error (log-scale) first parameter xi_sd_param_2 Numeric. Prior error (log-scale) second parameter xi_sd_prior String Prior distribution name errors mu_0_mean_param_1 Character. Prior initial epidemic trend mean's first parameter. mu_0_mean_param_2 Character. Prior initial epidemic trend mean's second parameter. mu_0_sd_param_1 Character. Prior initial epidemic trend standard deviation's first parameter. mu_0_sd_param_2 Character. Prior initial epidemic trend standard deviation's second parameter. nu_0_mean_param_1 Character. Prior initial delay trend mean's first parameter. nu_0_mean_param_2 Character. Prior initial delay trend mean's second parameter. nu_0_sd_param_1 Character. Prior initial delay trend standard deviation's first parameter. nu_0_sd_param_2 Character. Prior initial delay trend standard deviation's second parameter. mu_0_mean_hyperprior Prior distribution mean epidemic trend. nu_0_mean_hyperprior Prior distribution mean delay trend. Default normal. mu_0_sd_hyperprior Prior distribution standard deviation epidemic trend. nu_0_sd_hyperprior Prior distribution standard deviation delay trend. r_prior Character. Prior negative binomial precision parameter. r_param_1 Numeric. First parameter dispersion prior negative binomial. r_param_2 Numeric. Second parameter dispersion prior negative binomial.","code":""},{"path":"https://rodrigozepeda.github.io/diseasenowcasting/reference/set_priors.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get nowcast priors ‚Äî set_priors","text":"list priors [nowcast()] function.","code":""},{"path":"https://rodrigozepeda.github.io/diseasenowcasting/reference/set_priors.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get nowcast priors ‚Äî set_priors","text":"","code":"#Get the default priors set_priors() #> $mu_degree #> [1] 1 #>  #> $nu_degree #> [1] 1 #>  #> $p #> [1] 3 #>  #> $q #> [1] 2 #>  #> $mu_is_constant #> [1] FALSE #>  #> $nu_is_constant #> [1] TRUE #>  #> $mu_sd_prior #> [1] \"standard_normal\" #>  #> $nu_sd_prior #> [1] \"standard_normal\" #>  #> $mu_sd_param_1 #> [1] 0 #>  #> $mu_sd_param_2 #> [1] 0.1 #>  #> $nu_sd_param_1 #> [1] 0 #>  #> $nu_sd_param_2 #> [1] 0.1 #>  #> $phi_AR_param_1 #> [1] 0 #>  #> $phi_AR_param_2 #> [1] 1 #>  #> $phi_AR_prior #> [1] \"cauchy\" #>  #> $theta_MA_param_1 #> [1] 0 #>  #> $theta_MA_param_2 #> [1] 1 #>  #> $theta_MA_prior #> [1] \"cauchy\" #>  #> $xi_sd_param_1 #> [1] 0 #>  #> $xi_sd_param_2 #> [1] 1 #>  #> $xi_sd_prior #> [1] \"standard_normal\" #>  #> $mu_0_mean_param_1 #> [1] \"auto\" #>  #> $mu_0_mean_param_2 #> [1] 0.01 #>  #> $mu_0_sd_param_1 #> [1] \"auto\" #>  #> $mu_0_sd_param_2 #> [1] 0.01 #>  #> $nu_0_mean_param_1 #> [1] 0 #>  #> $nu_0_mean_param_2 #> [1] 0.01 #>  #> $nu_0_sd_param_1 #> [1] 0 #>  #> $nu_0_sd_param_2 #> [1] 0.01 #>  #> $mu_0_mean_hyperprior #> [1] \"standard_normal\" #>  #> $nu_0_mean_hyperprior #> [1] \"standard_normal\" #>  #> $mu_0_sd_hyperprior #> [1] \"standard_normal\" #>  #> $nu_0_sd_hyperprior #> [1] \"standard_normal\" #>  #> $r_prior #> [1] \"standard_normal\" #>  #> $r_param_1 #> [1] 0 #>  #> $r_param_2 #> [1] 1 #>   #Change the distribution of the priors sd for the epidemic trend as well as the degree of the delays set_priors(nu_degree = 2, mu_sd_prior = \"cauchy\") #> $mu_degree #> [1] 1 #>  #> $nu_degree #> [1] 2 #>  #> $p #> [1] 3 #>  #> $q #> [1] 2 #>  #> $mu_is_constant #> [1] FALSE #>  #> $nu_is_constant #> [1] TRUE #>  #> $mu_sd_prior #> [1] \"cauchy\" #>  #> $nu_sd_prior #> [1] \"standard_normal\" #>  #> $mu_sd_param_1 #> [1] 0 #>  #> $mu_sd_param_2 #> [1] 0.1 #>  #> $nu_sd_param_1 #> [1] 0 #>  #> $nu_sd_param_2 #> [1] 0.1 #>  #> $phi_AR_param_1 #> [1] 0 #>  #> $phi_AR_param_2 #> [1] 1 #>  #> $phi_AR_prior #> [1] \"cauchy\" #>  #> $theta_MA_param_1 #> [1] 0 #>  #> $theta_MA_param_2 #> [1] 1 #>  #> $theta_MA_prior #> [1] \"cauchy\" #>  #> $xi_sd_param_1 #> [1] 0 #>  #> $xi_sd_param_2 #> [1] 1 #>  #> $xi_sd_prior #> [1] \"standard_normal\" #>  #> $mu_0_mean_param_1 #> [1] \"auto\" #>  #> $mu_0_mean_param_2 #> [1] 0.01 #>  #> $mu_0_sd_param_1 #> [1] \"auto\" #>  #> $mu_0_sd_param_2 #> [1] 0.01 #>  #> $nu_0_mean_param_1 #> [1] 0 #>  #> $nu_0_mean_param_2 #> [1] 0.01 #>  #> $nu_0_sd_param_1 #> [1] 0 #>  #> $nu_0_sd_param_2 #> [1] 0.01 #>  #> $mu_0_mean_hyperprior #> [1] \"standard_normal\" #>  #> $nu_0_mean_hyperprior #> [1] \"standard_normal\" #>  #> $mu_0_sd_hyperprior #> [1] \"standard_normal\" #>  #> $nu_0_sd_hyperprior #> [1] \"standard_normal\" #>  #> $r_prior #> [1] \"standard_normal\" #>  #> $r_param_1 #> [1] 0 #>  #> $r_param_2 #> [1] 1 #>"},{"path":"https://rodrigozepeda.github.io/diseasenowcasting/reference/simulate_disease.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulate a process ‚Äî simulate_disease","title":"Simulate a process ‚Äî simulate_disease","text":"function simulates state-space process testing purposes model multiple delays strata. estimates process spesupcified number steps,  options trend degrees, priors, error distributions.","code":""},{"path":"https://rodrigozepeda.github.io/diseasenowcasting/reference/simulate_disease.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulate a process ‚Äî simulate_disease","text":"","code":"simulate_disease(   num_steps = 10,   num_delays = 8,   num_strata = 2,   initial_day = NULL,   initial_n = 100,   dist = c(\"NegativeBinomial\", \"Poisson\"),   units = c(\"daily\", \"weekly\"),   priors = set_priors() )"},{"path":"https://rodrigozepeda.github.io/diseasenowcasting/reference/simulate_disease.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Simulate a process ‚Äî simulate_disease","text":"num_steps Integer. Number time steps simulate. Default 10. num_delays Integer. Number delay strata. Default 8. num_strata Integer. Number strata population. Default 2. initial_day Date. simulation start specific day. initial_n Real. initial expected average value cases. dist Distribution. Either \"NegativeBinomial\"  \"Poisson\" units Either `\"daily\"` (default) `\"weekly\"`. priors list nowcast priors. can use [set_priors()] change priors function (see details)","code":""},{"path":"https://rodrigozepeda.github.io/diseasenowcasting/reference/simulate_disease.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Simulate a process ‚Äî simulate_disease","text":"tibble simulated state-space process results, including onset report dates, strata, delays, number observed cases per time step.","code":""},{"path":"https://rodrigozepeda.github.io/diseasenowcasting/reference/simulate_disease.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Simulate a process ‚Äî simulate_disease","text":"","code":"simulate_process_for_testing(num_steps = 20, num_delays = 5, num_strata = 3) #> ! This function will disappear in future versions please call `simulate_disease` #> ‚Ñπ Computing a nowcast for 2024-09-16 per \"days\" #> ‚Ñπ Assuming data is count-data where counts are in column `n`. To change this set `data_type = \"linelist\"` #> # A tibble: 300 √ó 4 #>        n .strata onset_date report_date #>    <dbl> <chr>   <date>     <date>      #>  1   100 s1      2024-08-29 2024-08-29  #>  2   100 s1      2024-08-30 2024-08-30  #>  3   100 s1      2024-08-31 2024-08-31  #>  4   100 s1      2024-09-01 2024-09-01  #>  5   100 s1      2024-09-02 2024-09-02  #>  6   100 s1      2024-09-03 2024-09-03  #>  7   100 s1      2024-09-04 2024-09-04  #>  8   100 s1      2024-09-05 2024-09-05  #>  9   100 s1      2024-09-06 2024-09-06  #> 10   100 s1      2024-09-07 2024-09-07  #> # ‚Ñπ 290 more rows"},{"path":"https://rodrigozepeda.github.io/diseasenowcasting/reference/simulate_process_for_testing.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulate a process ‚Äî simulate_process_for_testing","title":"Simulate a process ‚Äî simulate_process_for_testing","text":"function simulates state-space process testing purposes model multiple delays strata. estimates process specified number steps,  options trend degrees, priors, error distributions.","code":""},{"path":"https://rodrigozepeda.github.io/diseasenowcasting/reference/simulate_process_for_testing.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulate a process ‚Äî simulate_process_for_testing","text":"","code":"simulate_process_for_testing(   num_steps = 10,   num_delays = 8,   num_strata = 2,   initial_day = NULL,   initial_n = 100,   dist = c(\"NegativeBinomial\", \"Poisson\"),   units = c(\"daily\", \"weekly\"),   priors = set_priors() )"},{"path":"https://rodrigozepeda.github.io/diseasenowcasting/reference/simulate_process_for_testing.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Simulate a process ‚Äî simulate_process_for_testing","text":"num_steps Integer. Number time steps simulate. Default 10. num_delays Integer. Number delay strata. Default 8. num_strata Integer. Number strata population. Default 2. initial_day Date. simulation start specific day. initial_n Real. initial expected average value cases. dist Distribution. Either \"NegativeBinomial\"  \"Poisson\" units Either `\"daily\"` (default) `\"weekly\"`. priors list nowcast priors. can use [set_priors()] change priors function (see details)","code":""},{"path":"https://rodrigozepeda.github.io/diseasenowcasting/reference/simulate_process_for_testing.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Simulate a process ‚Äî simulate_process_for_testing","text":"tibble simulated state-space process results, including onset report dates, strata, delays, number observed cases per time step.","code":""},{"path":"https://rodrigozepeda.github.io/diseasenowcasting/reference/simulate_process_for_testing.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Simulate a process ‚Äî simulate_process_for_testing","text":"","code":"simulate_process_for_testing(num_steps = 20, num_delays = 5, num_strata = 3) #> ! This function will disappear in future versions please call `simulate_disease` #> ‚Ñπ Computing a nowcast for 2024-09-16 per \"days\" #> ‚Ñπ Assuming data is count-data where counts are in column `n`. To change this set `data_type = \"linelist\"` #> ! Some values of lambda have been truncated as they are too large. This might be attributed #> to a high variance of your data or on the prior. Consider reducing the prior variance. #> # A tibble: 300 √ó 4 #>        n .strata onset_date report_date #>    <dbl> <chr>   <date>     <date>      #>  1   100 s1      2024-08-29 2024-08-29  #>  2   100 s1      2024-08-30 2024-08-30  #>  3   100 s1      2024-08-31 2024-08-31  #>  4   100 s1      2024-09-01 2024-09-01  #>  5   100 s1      2024-09-02 2024-09-02  #>  6   100 s1      2024-09-03 2024-09-03  #>  7   100 s1      2024-09-04 2024-09-04  #>  8   100 s1      2024-09-05 2024-09-05  #>  9   100 s1      2024-09-06 2024-09-06  #> 10   100 s1      2024-09-07 2024-09-07  #> # ‚Ñπ 290 more rows"},{"path":"https://rodrigozepeda.github.io/diseasenowcasting/news/index.html","id":"diseasenowcasting-010","dir":"Changelog","previous_headings":"","what":"diseasenowcasting 0.1.0","title":"diseasenowcasting 0.1.0","text":"Initial creation.","code":""}]
