<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Nowcasting methods • diseasenowcasting</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Nowcasting methods">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">diseasenowcasting</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/Nowcasting-methods.html">Nowcasting methods</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Nowcasting methods</h1>
            
      

      <div class="d-none name"><code>Nowcasting-methods.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="intuitive-explanation">Intuitive explanation<a class="anchor" aria-label="anchor" href="#intuitive-explanation"></a>
</h2>
<p>We consider the problem of reporting the number of cases for a
certain disease. Results of disease’s tests are reported with a delay.
So for any day we will see only some disease-cases in that day; other
disease-cases for the same day will be reported in the upcoming
days.</p>
<div class="figure" style="text-align: center">
<img src="Nowcasting-methods_files/figure-html/unnamed-chunk-2-1.png" alt="Delay ladder shows that by each day the reports come in the subsequent days thus forming a ladder." width="700"><p class="caption">
Delay ladder shows that by each day the reports come in the subsequent
days thus forming a ladder.
</p>
</div>
<p>Figure 1 shows this idea where we assume that the maximum delay
corresponds to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>6</mn><annotation encoding="application/x-tex">6</annotation></semantics></math>
days. We can see that by <strong>today</strong>, April 11th, all of the
data for April the 2nd has already arrived: the data that arrived with
zero delay (report Apr. 2) as well as the data that arrived with a delay
of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>1</mn><annotation encoding="application/x-tex">1</annotation></semantics></math>
(report Apr. 3),
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>2</mn><annotation encoding="application/x-tex">2</annotation></semantics></math>
(report Apr. 4),
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>3</mn><annotation encoding="application/x-tex">3</annotation></semantics></math>
(report Apr. 5), etc until the data that was reported on April 8th with
the maximum delay of 6. For other dates not all data has yet arrived. We
can see that for April 9th we only see the data with delay 0 up till 3
(corresponding to April 11th). Data with delay larger than 3 will be
seen in the future.</p>
<p>The idea of the model is to predict the number of cases that will be
seen at time
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>
denoted
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>n</mi><mi>t</mi></msub><annotation encoding="application/x-tex">n_{t}</annotation></semantics></math>
as the sum of the delayed cases. This includes both the cases we’ve
already observed
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>n</mi><mrow><mi>t</mi><mo>,</mo><mi>d</mi></mrow></msub><annotation encoding="application/x-tex">n_{t,d}</annotation></semantics></math>
and the cases we haven’t yet observed
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mover><mi>n</mi><mo accent="true">̃</mo></mover><mrow><mi>t</mi><mo>,</mo><mi>d</mi></mrow></msub><annotation encoding="application/x-tex">\tilde{n}_{t,d}</annotation></semantics></math>.</p>
<div class="figure" style="text-align: center">
<img src="Nowcasting-methods_files/figure-html/unnamed-chunk-3-1.png" alt="The log expected number of cases at time $t$ reported with delay $d$, $\ell_{t,d}$ is a function of a **time-dependent** process $\mu_t$ and a **delay-time-dependent** process $\nu_{t,d}$." width="700"><p class="caption">
The log expected number of cases at time
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>
reported with delay
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>d</mi><annotation encoding="application/x-tex">d</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mo>ℓ</mo><mrow><mi>t</mi><mo>,</mo><mi>d</mi></mrow></msub><annotation encoding="application/x-tex">\ell_{t,d}</annotation></semantics></math>
is a function of a <strong>time-dependent</strong> process
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>μ</mi><mi>t</mi></msub><annotation encoding="application/x-tex">\mu_t</annotation></semantics></math>
and a <strong>delay-time-dependent</strong> process
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ν</mi><mrow><mi>t</mi><mo>,</mo><mi>d</mi></mrow></msub><annotation encoding="application/x-tex">\nu_{t,d}</annotation></semantics></math>.
</p>
</div>
<p>The main variable of the model is the (log) expected number of cases
at time
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>
that will be reported with delay
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>d</mi><annotation encoding="application/x-tex">d</annotation></semantics></math>:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mo>ℓ</mo><mrow><mi>t</mi><mo>,</mo><mi>d</mi></mrow></msub><annotation encoding="application/x-tex">\ell_{t,d}</annotation></semantics></math>.
The average of this variable is driven by a process composed of two
elements: a <strong>time-dependent</strong> process and a
<strong>delay-time-dependent</strong> process. You can think of the
time-dependent process as the process that drives the epidemic curve
while the delay-time-dependent process is the process that drives the
testing (or changes in the testing).</p>
<div class="figure" style="text-align: center">
<img src="Nowcasting-methods_files/figure-html/unnamed-chunk-4-1.png" alt="The log expected number of cases at time $t$ reported with delay $d$, $\ell_{t,d}$ is a function of a **time-dependent** process $\mu_t$ and a **delay-time-dependent** process $\nu_{t,d}$." width="700"><p class="caption">
The log expected number of cases at time
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>
reported with delay
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>d</mi><annotation encoding="application/x-tex">d</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mo>ℓ</mo><mrow><mi>t</mi><mo>,</mo><mi>d</mi></mrow></msub><annotation encoding="application/x-tex">\ell_{t,d}</annotation></semantics></math>
is a function of a <strong>time-dependent</strong> process
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>μ</mi><mi>t</mi></msub><annotation encoding="application/x-tex">\mu_t</annotation></semantics></math>
and a <strong>delay-time-dependent</strong> process
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ν</mi><mrow><mi>t</mi><mo>,</mo><mi>d</mi></mrow></msub><annotation encoding="application/x-tex">\nu_{t,d}</annotation></semantics></math>.
</p>
</div>
<p>Each of the processes can be further decomposed into a
<strong>trend</strong>, a <strong>season</strong> (or multiple seasons),
and a cycle:</p>
<div class="figure" style="text-align: center">
<img src="Nowcasting-methods_files/figure-html/unnamed-chunk-5-1.png" alt="The decomposition of the **time-dependent** process $\mu_t$. The **delay-time-dependent** process $\nu_{t,d}$ is decomposed in a similar fashion." width="700"><p class="caption">
The decomposition of the <strong>time-dependent</strong> process
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>μ</mi><mi>t</mi></msub><annotation encoding="application/x-tex">\mu_t</annotation></semantics></math>.
The <strong>delay-time-dependent</strong> process
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ν</mi><mrow><mi>t</mi><mo>,</mo><mi>d</mi></mrow></msub><annotation encoding="application/x-tex">\nu_{t,d}</annotation></semantics></math>
is decomposed in a similar fashion.
</p>
</div>
<p>The model thus captures seasonality both for the epidemic curve and
for the delay curve as well as their own trends and noise.</p>
</div>
<div class="section level2">
<h2 id="mathematical-explanation">Mathematical explanation<a class="anchor" aria-label="anchor" href="#mathematical-explanation"></a>
</h2>
<p>Let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>n</mi><mrow><mi>t</mi><mo>,</mo><mi>d</mi></mrow><mi>s</mi></msubsup><annotation encoding="application/x-tex">n_{t,d}^s</annotation></semantics></math>
denote the number of incident cases (individuals) in stratum
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>s</mi><annotation encoding="application/x-tex">s</annotation></semantics></math>
(say race/gender) at time
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>
who were reported with a delay
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>d</mi><annotation encoding="application/x-tex">d</annotation></semantics></math>.
That is,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>n</mi><mrow><mi>t</mi><mo>,</mo><mn>0</mn></mrow></msub><annotation encoding="application/x-tex">n_{t,0}</annotation></semantics></math>
denotes the the number of individuals diseased at time
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>
that were reported at moment
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>n</mi><mrow><mi>t</mi><mo>,</mo><mn>1</mn></mrow></msub><annotation encoding="application/x-tex">n_{t,1}</annotation></semantics></math>
the number of individuals diseased at time
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>
that were reported at moment
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">t + 1</annotation></semantics></math>
and in general
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>n</mi><mrow><mi>t</mi><mo>,</mo><mi>d</mi></mrow></msub><annotation encoding="application/x-tex">n_{t,d}</annotation></semantics></math>
the number of individuals diseased at time
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>
that were reported at moment
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mo>+</mo><mi>d</mi></mrow><annotation encoding="application/x-tex">t + d</annotation></semantics></math>.</p>
<p>We assume that the expected value of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>n</mi><mrow><mi>t</mi><mo>,</mo><mi>d</mi></mrow><mi>s</mi></msubsup><annotation encoding="application/x-tex">n_{t,d}^s</annotation></semantics></math>
is given by:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>𝔼</mi><mrow><mo stretchy="true" form="prefix">[</mo><msubsup><mi>n</mi><mrow><mi>t</mi><mo>,</mo><mi>d</mi></mrow><mi>s</mi></msubsup><mo stretchy="true" form="postfix">]</mo></mrow><mo>=</mo><msubsup><mi>λ</mi><mrow><mi>t</mi><mo>,</mo><mi>d</mi></mrow><mi>s</mi></msubsup></mrow><annotation encoding="application/x-tex">
\mathbb{E}\left[n_{t,d}^s\right] = \lambda_{t,d}^s
</annotation></semantics></math> where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mo>ℓ</mo><mrow><mi>t</mi><mo>,</mo><mi>d</mi></mrow><mi>s</mi></msubsup><mo>=</mo><mo>ln</mo><msubsup><mi>λ</mi><mrow><mi>t</mi><mo>,</mo><mi>d</mi></mrow><mi>s</mi></msubsup></mrow><annotation encoding="application/x-tex">\ell_{t,d}^s = \ln\lambda_{t,d}^s</annotation></semantics></math>
follows a linear state-space model with covariates (see <span class="citation">Durbin and Koopman (2012)</span>):</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><msubsup><mo>ℓ</mo><mrow><mi>t</mi><mo>,</mo><mi>d</mi></mrow><mi>s</mi></msubsup></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msup><mi>L</mi><mi>μ</mi></msup><mo>⋅</mo><msubsup><mi>μ</mi><mi>t</mi><mi>s</mi></msubsup><mo>+</mo><msubsup><mi>L</mi><mi>d</mi><mi>ν</mi></msubsup><mo>⋅</mo><msubsup><mi>ν</mi><mrow><mi>t</mi><mo>,</mo><mi>d</mi></mrow><mi>s</mi></msubsup><mo>+</mo><msub><mi>B</mi><mi>d</mi></msub><mo>⋅</mo><msubsup><mi>X</mi><mrow><mi>t</mi><mo>,</mo><mi>d</mi></mrow><mi>s</mi></msubsup><mo>+</mo><msubsup><mi>ϵ</mi><mrow><mi>t</mi><mo>,</mo><mi>d</mi></mrow><mi>s</mi></msubsup></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msubsup><mi>μ</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow><mi>s</mi></msubsup></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msup><mi>A</mi><mi>μ</mi></msup><msubsup><mi>μ</mi><mi>t</mi><mi>s</mi></msubsup><mo>+</mo><msup><mi>R</mi><mi>μ</mi></msup><msubsup><mi>ξ</mi><mi>t</mi><mrow><mi>s</mi><mo>,</mo><mi>μ</mi></mrow></msubsup><mspace width="1.0em"></mspace></mtd><mtd columnalign="right" style="text-align: right"><mtext mathvariant="normal">(time-dependent process)</mtext></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msubsup><mi>ν</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn><mo>,</mo><mi>d</mi></mrow><mi>s</mi></msubsup></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msubsup><mi>A</mi><mi>d</mi><mi>ν</mi></msubsup><msubsup><mi>ν</mi><mrow><mi>t</mi><mo>,</mo><mi>d</mi></mrow><mi>s</mi></msubsup><mo>+</mo><msubsup><mi>R</mi><mi>d</mi><mi>ν</mi></msubsup><msubsup><mi>ξ</mi><mrow><mi>t</mi><mo>,</mo><mi>d</mi></mrow><mrow><mi>s</mi><mo>,</mo><mi>ν</mi></mrow></msubsup><mspace width="1.0em"></mspace></mtd><mtd columnalign="right" style="text-align: right"><mtext mathvariant="normal">(delay-dependent process)</mtext></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{equation}
\begin{aligned}
  \ell_{t,d}^s &amp; = L^{\mu} \cdot \mu_{t}^s + L_{d}^{\nu}  \cdot \nu_{t,d}^s + B_{d}  \cdot X_{t,d}^s + \epsilon_{t,d}^s \\
  \mu_{t+1}^s &amp; = A^{\mu} \mu_{t}^s + R^{\mu} \xi_{t}^{s,\mu} \quad &amp; \text{(time-dependent process)}\\
  \nu_{t+1,d}^s &amp; = A_{d}^{\nu}\nu_{t,d}^s + R_d^{\nu} \xi_{t,d}^{s,\nu} \quad &amp; \text{(delay-dependent process)}\\
\end{aligned}  
\end{equation}</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>μ</mi><mi>t</mi><mi>s</mi></msubsup><annotation encoding="application/x-tex">\mu_{t}^s</annotation></semantics></math>
represents the time-dependent latent process and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>ν</mi><mrow><mi>t</mi><mo>,</mo><mi>d</mi></mrow><mi>s</mi></msubsup><annotation encoding="application/x-tex">\nu_{t,d}^s</annotation></semantics></math>
the delay-dependent latent process. The system is defined for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>…</mi><mo>,</mo><mi>T</mi></mrow><annotation encoding="application/x-tex">t = 1,\dots, T</annotation></semantics></math>
(time),
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mo>=</mo><mn>0</mn><mo>,</mo><mi>…</mi><mo>,</mo><mi>D</mi></mrow><annotation encoding="application/x-tex">d = 0,\dots, D</annotation></semantics></math>
(delays) and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>…</mi><mo>,</mo><mi>S</mi></mrow><annotation encoding="application/x-tex">s = 1,\dots,S</annotation></semantics></math>
(strata). Table 1 describes each of the variables and their
dimensions.</p>
<table class="table">
<caption>Dimensions of variables.</caption>
<thead><tr class="header">
<th>Variable(s)</th>
<th>Dimension</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>A</mi><mi>μ</mi></msup><annotation encoding="application/x-tex">A^{\mu}</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>r</mi><mi>μ</mi></msub><mo>×</mo><msub><mi>p</mi><mi>μ</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(r_{\mu} \times p_{\mu})</annotation></semantics></math></td>
</tr>
<tr class="even">
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>A</mi><mi>d</mi><mi>ν</mi></msubsup><annotation encoding="application/x-tex">A_{d}^{\nu}</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>r</mi><mi>ν</mi></msub><mo>×</mo><msub><mi>p</mi><mi>ν</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(r_{\nu} \times p_{\nu})</annotation></semantics></math></td>
</tr>
<tr class="odd">
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>R</mi><mi>μ</mi></msup><annotation encoding="application/x-tex">R^{\mu}</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>r</mi><mi>μ</mi></msub><mo>×</mo><msub><mi>r</mi><mi>μ</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(r_{\mu} \times r_{\mu})</annotation></semantics></math></td>
</tr>
<tr class="even">
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>R</mi><mi>d</mi><mi>ν</mi></msubsup><annotation encoding="application/x-tex">R_d^{\nu}</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>r</mi><mi>ν</mi></msub><mo>×</mo><msub><mi>r</mi><mi>ν</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(r_{\nu} \times r_{\nu})</annotation></semantics></math></td>
</tr>
<tr class="odd">
<td>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>B</mi><mi>d</mi></msub><annotation encoding="application/x-tex">B_{d}</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>X</mi><mrow><mi>t</mi><mo>,</mo><mi>d</mi></mrow><mi>s</mi></msubsup><annotation encoding="application/x-tex">X_{t,d}^s</annotation></semantics></math>
</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mi>q</mi><mo>×</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(q \times 1)</annotation></semantics></math></td>
</tr>
<tr class="even">
<td>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>L</mi><mi>μ</mi></msup><annotation encoding="application/x-tex">L^{\mu}</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>μ</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow><mi>s</mi></msubsup><annotation encoding="application/x-tex">\mu_{t+1}^s</annotation></semantics></math>
</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>r</mi><mi>μ</mi></msub><mo>×</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(r_{\mu} \times 1)</annotation></semantics></math></td>
</tr>
<tr class="odd">
<td>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>L</mi><mi>d</mi><mi>ν</mi></msubsup><annotation encoding="application/x-tex">L_d^{\nu}</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>ν</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn><mo>,</mo><mi>d</mi></mrow><mi>s</mi></msubsup><annotation encoding="application/x-tex">\nu_{t+1,d}^s</annotation></semantics></math>
</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>r</mi><mi>ν</mi></msub><mo>×</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(r_{\nu} \times 1)</annotation></semantics></math></td>
</tr>
<tr class="even">
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>ϵ</mi><mrow><mi>d</mi><mo>,</mo><mi>t</mi></mrow><mi>s</mi></msubsup><annotation encoding="application/x-tex">\epsilon_{d,t}^{s}</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>×</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(1 \times 1)</annotation></semantics></math></td>
</tr>
<tr class="odd">
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>ξ</mi><mrow><mi>d</mi><mo>,</mo><mi>t</mi></mrow><mrow><mi>s</mi><mo>,</mo><mi>μ</mi></mrow></msubsup><annotation encoding="application/x-tex">\xi_{d,t}^{s,\mu}</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>r</mi><mi>μ</mi></msub><mo>×</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(r_{\mu} \times 1)</annotation></semantics></math></td>
</tr>
<tr class="even">
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>ξ</mi><mrow><mi>d</mi><mo>,</mo><mi>t</mi></mrow><mrow><mi>s</mi><mo>,</mo><mi>n</mi><mi>u</mi></mrow></msubsup><annotation encoding="application/x-tex">\xi_{d,t}^{s,nu}</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>r</mi><mi>ν</mi></msub><mo>×</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(r_{\nu} \times 1)</annotation></semantics></math></td>
</tr>
</tbody>
</table>
<p>In this model,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>A</mi><mi>μ</mi></msup><annotation encoding="application/x-tex">A^{\mu}</annotation></semantics></math>,<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>A</mi><mi>d</mi><mi>ν</mi></msubsup><annotation encoding="application/x-tex">A_{d}^{\nu}</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>R</mi><mi>μ</mi></msup><annotation encoding="application/x-tex">R^{\mu}</annotation></semantics></math>,<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>R</mi><mi>d</mi><mi>ν</mi></msubsup><annotation encoding="application/x-tex">R_d^{\nu}</annotation></semantics></math>,<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>L</mi><mi>μ</mi></msup><annotation encoding="application/x-tex">L^{\mu}</annotation></semantics></math>,
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>L</mi><mi>d</mi><mi>ν</mi></msubsup><annotation encoding="application/x-tex">L_d^{\nu}</annotation></semantics></math>
are given. Variables
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>ϵ</mi><mrow><mi>t</mi><mo>,</mo><mi>d</mi></mrow><mi>s</mi></msubsup><annotation encoding="application/x-tex">\epsilon_{t,d}^s</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>ξ</mi><mi>t</mi><mrow><mi>s</mi><mo>,</mo><mi>μ</mi></mrow></msubsup><annotation encoding="application/x-tex">\xi_{t}^{s,\mu}</annotation></semantics></math>,
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>ξ</mi><mrow><mi>t</mi><mo>,</mo><mi>d</mi></mrow><mrow><mi>s</mi><mo>,</mo><mi>ν</mi></mrow></msubsup><annotation encoding="application/x-tex">\xi_{t,d}^{s,\nu}</annotation></semantics></math>
represent random (correlated) noise;
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>X</mi><mrow><mi>t</mi><mo>,</mo><mi>d</mi></mrow><mi>s</mi></msubsup><annotation encoding="application/x-tex">X_{t,d}^s</annotation></semantics></math>
is a vector of known covariates,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>B</mi><mi>d</mi></msub><annotation encoding="application/x-tex">B_d</annotation></semantics></math>
is a vector of unknown parameters. Additionally,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>μ</mi><mn>0</mn></msub><annotation encoding="application/x-tex">\mu_{0}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ν</mi><mrow><mn>0</mn><mo>,</mo><mi>d</mi></mrow></msub><annotation encoding="application/x-tex">\nu_{0,d}</annotation></semantics></math>
are also unknown parameters.</p>
<p>The total number of incident cases for stratum
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>s</mi><annotation encoding="application/x-tex">s</annotation></semantics></math>
expected to at time
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>
is given by:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>n</mi><mi>t</mi><mi>s</mi></msubsup><mo>=</mo><munderover><mo>∑</mo><mrow><mi>d</mi><mo>=</mo><mn>0</mn></mrow><mo accent="false">∞</mo></munderover><msubsup><mi>n</mi><mrow><mi>t</mi><mo>,</mo><mi>d</mi></mrow><mi>s</mi></msubsup><mo>=</mo><msubsup><mi>n</mi><mrow><mi>t</mi><mo>,</mo><mi>D</mi><mo>+</mo></mrow><mi>s</mi></msubsup><mo>+</mo><munderover><mo>∑</mo><mrow><mi>d</mi><mo>=</mo><mn>0</mn></mrow><mi>D</mi></munderover><msubsup><mi>n</mi><mrow><mi>t</mi><mo>,</mo><mi>d</mi></mrow><mi>s</mi></msubsup><mo>≈</mo><munderover><mo>∑</mo><mrow><mi>d</mi><mo>=</mo><mn>0</mn></mrow><mi>D</mi></munderover><msubsup><mi>n</mi><mrow><mi>t</mi><mo>,</mo><mi>d</mi></mrow><mi>s</mi></msubsup></mrow><annotation encoding="application/x-tex">\begin{equation}
n_t^s = \sum\limits_{d = 0}^{\infty} n_{t,d}^s = n_{t,D+}^s  + \sum\limits_{d = 0}^{D} n_{t,d}^s \approx \sum\limits_{d = 0}^{D} n_{t,d}^s
\end{equation}</annotation></semantics></math> At time
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>,
the predicted number of cases with delay
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>d</mi><annotation encoding="application/x-tex">d</annotation></semantics></math>
of stratum
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>s</mi><annotation encoding="application/x-tex">s</annotation></semantics></math>
is denoted by
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mover><mi>n</mi><mo accent="true">̃</mo></mover><mrow><mi>t</mi><mo>,</mo><mi>d</mi></mrow><mi>s</mi></msubsup><annotation encoding="application/x-tex">\tilde{n}_{t,d}^s</annotation></semantics></math>.
Finally, the predicted number of cases (nowcasted cases) in stratum
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>s</mi><annotation encoding="application/x-tex">s</annotation></semantics></math>
for time
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>
is estimated by:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mover><mi>n</mi><mo accent="true">̃</mo></mover><mi>t</mi><mi>s</mi></msubsup><mo>=</mo><munder><munder><mrow><munderover><mo>∑</mo><mrow><mi>d</mi><mo>=</mo><mn>0</mn></mrow><msup><mi>d</mi><mo>*</mo></msup></munderover><msubsup><mi>n</mi><mrow><mi>t</mi><mo>,</mo><mi>d</mi></mrow><mi>s</mi></msubsup></mrow><mo accent="true">⏟</mo></munder><mtext mathvariant="normal">Already observed</mtext></munder><mo>+</mo><munder><munder><mrow><munderover><mo>∑</mo><mrow><mi>d</mi><mo>=</mo><msup><mi>d</mi><mo>*</mo></msup><mo>+</mo><mn>1</mn></mrow><mi>D</mi></munderover><msubsup><mover><mi>n</mi><mo accent="true">̃</mo></mover><mrow><mi>t</mi><mo>,</mo><mi>d</mi></mrow><mi>s</mi></msubsup></mrow><mo accent="true">⏟</mo></munder><mtext mathvariant="normal">Predicted</mtext></munder></mrow><annotation encoding="application/x-tex">\begin{equation}
\tilde{n}_t^s =  \underbrace{\sum\limits_{d = 0}^{d^{*}} n_{t,d}^s}_{\text{Already observed}}  + \underbrace{\sum\limits_{d = d^{*} + 1}^{D} \tilde{n}_{t,d}^s}_{\text{Predicted}} 
\end{equation}</annotation></semantics></math> where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>d</mi><mo>*</mo></msup><annotation encoding="application/x-tex">d^*</annotation></semantics></math>
denotes the latest delay observed with the current data.</p>
<div class="callout-warning">
<p>We should add the option for zero-inflation</p>
</div>
<div class="section level3">
<h3 id="construction-of-the-l_d-a_d-mu_ts-and-nu_tds">Construction of the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>L</mi><mi>d</mi></msub><annotation encoding="application/x-tex">L_{d}</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>A</mi><mi>d</mi></msub><annotation encoding="application/x-tex">A_{d}</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>μ</mi><mi>t</mi><mi>s</mi></msubsup><annotation encoding="application/x-tex">\mu_{t}^s</annotation></semantics></math>,
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>ν</mi><mrow><mi>t</mi><mo>,</mo><mi>d</mi></mrow><mi>s</mi></msubsup><annotation encoding="application/x-tex">\nu_{t,d}^s</annotation></semantics></math><a class="anchor" aria-label="anchor" href="#construction-of-the-l_d-a_d-mu_ts-and-nu_tds"></a>
</h3>
<p>The
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>L</mi><mi>μ</mi></msup><annotation encoding="application/x-tex">L^{\mu}</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>L</mi><mi>d</mi><mi>ν</mi></msubsup><annotation encoding="application/x-tex">L_d^{\nu}</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>A</mi><mi>μ</mi></msup><annotation encoding="application/x-tex">A^{\mu}</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>A</mi><mi>d</mi><mi>ν</mi></msubsup><annotation encoding="application/x-tex">A_{d}^{\nu}</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>R</mi><mi>μ</mi></msup><annotation encoding="application/x-tex">R^{\mu}</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>R</mi><mi>d</mi><mi>ν</mi></msubsup><annotation encoding="application/x-tex">R_{d}^{\nu}</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>μ</mi><mi>t</mi><mi>s</mi></msubsup><annotation encoding="application/x-tex">\mu_{t}^s</annotation></semantics></math>,
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>ν</mi><mrow><mi>t</mi><mo>,</mo><mi>d</mi></mrow><mi>s</mi></msubsup><annotation encoding="application/x-tex">\nu_{t,d}^s</annotation></semantics></math>
matrices can be constructed by blocks. In what follows we’ll only show
how the construction works for general matrices
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mover><mi>α</mi><mo accent="true">→</mo></mover><mrow><mi>t</mi><mo>,</mo><mi>d</mi></mrow><mi>s</mi></msubsup><annotation encoding="application/x-tex">\vec{\alpha}_{t,d}^s</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>L</mi><mi>d</mi></msub><annotation encoding="application/x-tex">L_{d}</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>A</mi><mi>d</mi></msub><annotation encoding="application/x-tex">A_d</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>R</mi><mi>d</mi></msub><annotation encoding="application/x-tex">R_{d}</annotation></semantics></math>
which stand for either
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>ν</mi><mrow><mi>t</mi><mo>,</mo><mi>d</mi></mrow><mi>s</mi></msubsup><annotation encoding="application/x-tex">\nu_{t,d}^s</annotation></semantics></math>
,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>L</mi><mi>d</mi><mi>ν</mi></msubsup><annotation encoding="application/x-tex">L_d^{\nu}</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>A</mi><mi>d</mi><mi>ν</mi></msubsup><annotation encoding="application/x-tex">A_{d}^{\nu}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>R</mi><mi>d</mi><mi>ν</mi></msubsup><annotation encoding="application/x-tex">R_{d}^{\nu}</annotation></semantics></math>;
or
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>μ</mi><mi>t</mi><mi>s</mi></msubsup><annotation encoding="application/x-tex">\mu_{t}^s</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>L</mi><mi>μ</mi></msup><annotation encoding="application/x-tex">L^{\mu}</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>A</mi><mi>μ</mi></msup><annotation encoding="application/x-tex">A^{\mu}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>R</mi><mi>μ</mi></msup><annotation encoding="application/x-tex">R^{\mu}</annotation></semantics></math>.</p>
<p>The general idea is that the vectors
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mover><mi>α</mi><mo accent="true">→</mo></mover><mrow><mi>t</mi><mo>,</mo><mi>d</mi></mrow><mi>s</mi></msubsup><annotation encoding="application/x-tex">\vec{\alpha}_{t,d}^s</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>L</mi><mi>d</mi></msub><annotation encoding="application/x-tex">L_{d}</annotation></semantics></math>,
and the matrices
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>A</mi><mi>d</mi></msub><annotation encoding="application/x-tex">A_d</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>R</mi><mi>d</mi></msub><annotation encoding="application/x-tex">R_{d}</annotation></semantics></math>
can be constructed by three blocks: a <a href="#trend">trend</a>, a <a href="#seasonality">seasonality</a>, and a <a href="#cycle">cyclical
component</a>:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>L</mi><mi>d</mi></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>L</mi><mi>d</mi><mtext mathvariant="normal">Trend</mtext></msubsup><mo>,</mo><msubsup><mi>L</mi><mi>d</mi><mtext mathvariant="normal">Season</mtext></msubsup><mo>,</mo><msubsup><mi>L</mi><mi>d</mi><mtext mathvariant="normal">Cycle</mtext></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mi>⊤</mi></msup><mo>,</mo></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>A</mi><mi>d</mi></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mtext mathvariant="normal">diag</mtext><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>A</mi><mi>d</mi><mtext mathvariant="normal">Trend</mtext></msubsup><mo>,</mo><msubsup><mi>A</mi><mi>d</mi><mtext mathvariant="normal">Season</mtext></msubsup><mo>,</mo><msubsup><mi>A</mi><mi>d</mi><mtext mathvariant="normal">Cycle</mtext></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>R</mi><mi>d</mi></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mtext mathvariant="normal">diag</mtext><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>R</mi><mi>d</mi><mtext mathvariant="normal">Trend</mtext></msubsup><mo>,</mo><msubsup><mi>R</mi><mi>d</mi><mtext mathvariant="normal">Season</mtext></msubsup><mo>,</mo><msubsup><mi>R</mi><mi>d</mi><mtext mathvariant="normal">Cycle</mtext></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mrow><mspace width="0.333em"></mspace><mtext mathvariant="normal"> and</mtext></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msubsup><mover><mi>α</mi><mo accent="true">→</mo></mover><mrow><mi>t</mi><mo>,</mo><mi>d</mi></mrow><mi>s</mi></msubsup></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>α</mi><mrow><mi>t</mi><mo>,</mo><mi>d</mi></mrow><mrow><mi>s</mi><mo>,</mo><mtext mathvariant="normal">Trend</mtext></mrow></msubsup><mo>,</mo><msubsup><mi>α</mi><mrow><mi>t</mi><mo>,</mo><mi>d</mi></mrow><mrow><mi>s</mi><mo>,</mo><mtext mathvariant="normal">Season</mtext></mrow></msubsup><mo>,</mo><msubsup><mi>α</mi><mrow><mi>t</mi><mo>,</mo><mi>d</mi></mrow><mrow><mi>s</mi><mo>,</mo><mtext mathvariant="normal">Cycle</mtext></mrow></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mi>⊤</mi></msup><mi>.</mi></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{equation}
\begin{aligned}
L_{d} &amp; = \left(L_{d}^{\text{Trend}}, L_{d}^{\text{Season}}, L_{d}^{\text{Cycle}} \right)^{\top}, \\
A_{d} &amp; = \text{diag}\left(A_{d}^{\text{Trend}}, A_{d}^{\text{Season}}, A_{d}^{\text{Cycle}}\right),\\
R_{d} &amp; = \text{diag}\left(R_{d}^{\text{Trend}}, R_{d}^{\text{Season}}, R_{d}^{\text{Cycle}}\right), \text{ and} \\ 
\vec{\alpha}_{t,d}^s &amp; = \left(\alpha_{t,d}^{s,\text{Trend}}, \alpha_{t,d}^{s,\text{Season}}, \alpha_{t,d}^{s,\text{Cycle}} \right)^{\top}.
\end{aligned}
\end{equation}</annotation></semantics></math></p>
<p>In this notation, if a section of the model is not specified then
that empty block is not considered. For example, a model without
seasonality might have the following
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>L</mi><mi>d</mi></msub><annotation encoding="application/x-tex">L_d</annotation></semantics></math>:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mi>d</mi></msub><mo>=</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>L</mi><mi>d</mi><mtext mathvariant="normal">Trend</mtext></msubsup><mo>,</mo><msubsup><mi>L</mi><mi>d</mi><mtext mathvariant="normal">Cycle</mtext></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mi>⊤</mi></msup></mrow><annotation encoding="application/x-tex">
L_{d} = \left(L_{d}^{\text{Trend}}, L_{d}^{\text{Cycle}} \right)^{\top}
</annotation></semantics></math> The definitions for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mi>d</mi></msub><mo>,</mo><msub><mi>R</mi><mi>d</mi></msub></mrow><annotation encoding="application/x-tex">A_{d}, R_{d}</annotation></semantics></math>,
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>α</mi><mrow><mi>t</mi><mo>,</mo><mi>d</mi></mrow><mi>s</mi></msubsup><annotation encoding="application/x-tex">\alpha_{t,d}^s</annotation></semantics></math>
in this case follow the same pattern.</p>
<blockquote>
<h4 id="trend">Trend</h4>
<p>The trend describes the general direction of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mo>ℓ</mo><mrow><mi>t</mi><mo>,</mo><mi>d</mi></mrow><mi>s</mi></msubsup><annotation encoding="application/x-tex">\ell_{t,d}^s</annotation></semantics></math>.
There are three trend options:</p>
<ul>
<li><a href="#constant-trend">Constant</a></li>
<li><a href="#local-linear-trend">Local linear trend</a></li>
<li><a href="#local-trend-of-degree-k">Local trend of degree
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math></a></li>
</ul>
<div class="callout">
<h5 id="constant-trend">Constant trend</h5>
<p>The constant trend model is given by:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><msubsup><mo>ℓ</mo><mrow><mi>t</mi><mo>,</mo><mi>d</mi></mrow><mi>s</mi></msubsup></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msubsup><mi>α</mi><mrow><mi>t</mi><mo>,</mo><mi>d</mi></mrow><mi>s</mi></msubsup><mo>+</mo><msubsup><mi>ϵ</mi><mrow><mi>t</mi><mo>,</mo><mi>d</mi></mrow><mi>s</mi></msubsup></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msubsup><mi>α</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn><mo>,</mo><mi>d</mi></mrow><mi>s</mi></msubsup></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msubsup><mi>α</mi><mrow><mi>t</mi><mo>,</mo><mi>d</mi></mrow><mi>s</mi></msubsup></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{equation}
\begin{aligned}
\ell_{t,d}^s &amp; = \alpha_{t,d}^s + \epsilon_{t,d}^s \\
\alpha_{t+1,d}^s &amp; = \alpha_{t,d}^s \\
\end{aligned}  
\end{equation}</annotation></semantics></math> in which case
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>L</mi><mi>d</mi><mtext mathvariant="normal">Trend</mtext></msubsup><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">L_{d}^{\text{Trend}} = 1</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>α</mi><mrow><mi>t</mi><mo>,</mo><mi>d</mi></mrow><mrow><mi>s</mi><mo>,</mo><mtext mathvariant="normal">Trend</mtext></mrow></msubsup><mo>=</mo><msubsup><mi>α</mi><mrow><mi>t</mi><mo>,</mo><mi>d</mi></mrow><mi>s</mi></msubsup></mrow><annotation encoding="application/x-tex">\alpha_{t,d}^{s,\text{Trend}} = \alpha_{t,d}^s</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>A</mi><mi>d</mi><mtext mathvariant="normal">Trend</mtext></msubsup><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">A_{d}^{\text{Trend}} = 1</annotation></semantics></math>,
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>R</mi><mi>d</mi></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">R_d = 0</annotation></semantics></math>.</p>
</div>
<div class="callout">
<h5 id="local-linear-trend">Local linear trend</h5>
<p>The simplest local linear trend model is given by:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><msubsup><mo>ℓ</mo><mrow><mi>t</mi><mo>,</mo><mi>d</mi></mrow><mi>s</mi></msubsup></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msubsup><mi>α</mi><mrow><mi>t</mi><mo>,</mo><mi>d</mi></mrow><mi>s</mi></msubsup><mo>+</mo><msubsup><mi>ϵ</mi><mrow><mi>t</mi><mo>,</mo><mi>d</mi></mrow><mi>s</mi></msubsup></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msubsup><mi>ν</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn><mo>,</mo><mi>d</mi></mrow><mi>s</mi></msubsup></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msubsup><mi>ν</mi><mrow><mi>t</mi><mo>,</mo><mi>d</mi></mrow><mi>s</mi></msubsup><mo>+</mo><msub><mi>R</mi><mi>d</mi></msub><msubsup><mi>ξ</mi><mrow><mi>t</mi><mo>,</mo><mi>d</mi></mrow><mi>s</mi></msubsup></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{equation}
\begin{aligned}
\ell_{t,d}^s &amp; = \alpha_{t,d}^s  + \epsilon_{t,d}^s \\
\nu_{t+1,d}^s &amp; = \nu_{t,d}^s + R_d \xi_{t,d}^s
\end{aligned}  
\end{equation}</annotation></semantics></math> in which case
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>L</mi><mi>d</mi><mtext mathvariant="normal">Trend</mtext></msubsup><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">L_{d}^{\text{Trend}} = 1</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>α</mi><mrow><mi>t</mi><mo>,</mo><mi>d</mi></mrow><mrow><mi>s</mi><mo>,</mo><mtext mathvariant="normal">Trend</mtext></mrow></msubsup><mo>=</mo><msubsup><mi>α</mi><mrow><mi>t</mi><mo>,</mo><mi>d</mi></mrow><mi>s</mi></msubsup></mrow><annotation encoding="application/x-tex">\alpha_{t,d}^{s,\text{Trend}} = \alpha_{t,d}^s</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>A</mi><mi>d</mi><mtext mathvariant="normal">Trend</mtext></msubsup><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">A_{d}^{\text{Trend}} = 1</annotation></semantics></math>,
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>R</mi><mi>d</mi><mtext mathvariant="normal">Trend</mtext></msubsup><mo>∈</mo><mo stretchy="false" form="prefix">{</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">R_d^{\text{Trend}} \in\{0,1\}</annotation></semantics></math>.
Notice that if
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>R</mi><mi>d</mi></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">R_d = 0</annotation></semantics></math>
we recover the constant trend model.</p>
</div>
<div class="callout">
<h5 id="local-trend-of-degree-k">Local trend of degree
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>
</h5>
<p>In general (for smoothing purposes), we can adjust the local linear
trend of degree
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>
by fitting the model:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><msubsup><mo>ℓ</mo><mrow><mi>t</mi><mo>,</mo><mi>d</mi></mrow><mi>s</mi></msubsup></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msubsup><mi>α</mi><mrow><mi>t</mi><mo>,</mo><mi>d</mi></mrow><mi>s</mi></msubsup><mo>+</mo><msubsup><mi>ϵ</mi><mrow><mi>t</mi><mo>,</mo><mi>d</mi></mrow><mi>s</mi></msubsup></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msup><mi>Δ</mi><mi>k</mi></msup><msubsup><mi>α</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn><mo>,</mo><mi>d</mi></mrow><mi>s</mi></msubsup></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msub><mi>R</mi><mi>d</mi></msub><msubsup><mi>ξ</mi><mrow><mi>t</mi><mo>,</mo><mi>d</mi></mrow><mi>s</mi></msubsup></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{equation}
\begin{aligned}
\ell_{t,d}^s &amp; = \alpha_{t,d}^s + \epsilon_{t,d}^s \\
\Delta^{k} \alpha_{t+1,d}^s &amp; = R_d\xi_{t,d}^s
\end{aligned}  
\end{equation}</annotation></semantics></math> where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Δ</mi><msub><mi>α</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><msub><mi>α</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>−</mo><msub><mi>α</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">\Delta \alpha_{t+1} = \alpha_{t+1} - \alpha_{t}</annotation></semantics></math>
and in general
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>Δ</mi><mi>k</mi></msup><msub><mi>α</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><mi>Δ</mi><mo minsize="1.2" maxsize="1.2" stretchy="false" form="prefix">(</mo><msup><mi>Δ</mi><mrow><mi>k</mi><mo>−</mo><mn>1</mn></mrow></msup><msub><mi>α</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo minsize="1.2" maxsize="1.2" stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">\Delta^k \alpha_{t+1} = \Delta\big(\Delta^{k-1} \alpha_{t+1}\big)</annotation></semantics></math>.
The model can be rewritten using <a href="https://en.wikipedia.org/wiki/Finite_difference#Higher-order_differences" class="external-link">the
general formula for higher order (backward) differences</a> as:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><msubsup><mo>ℓ</mo><mrow><mi>t</mi><mo>,</mo><mi>d</mi></mrow><mi>s</mi></msubsup></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msubsup><mi>α</mi><mrow><mi>t</mi><mo>,</mo><mi>d</mi></mrow><mi>s</mi></msubsup><mo>+</mo><msubsup><mi>ϵ</mi><mrow><mi>t</mi><mo>,</mo><mi>d</mi></mrow><mi>s</mi></msubsup></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msubsup><mi>α</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn><mo>,</mo><mi>d</mi></mrow><mi>s</mi></msubsup></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>k</mi></munderover><msup><mrow><mo stretchy="true" form="prefix">(</mo><mo>−</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mi>j</mi><mo>+</mo><mn>1</mn></mrow></msup><mrow><mo stretchy="true" form="prefix">(</mo><mfrac linethickness="0"><mi>k</mi><mi>j</mi></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><msubsup><mi>α</mi><mrow><mi>t</mi><mo>−</mo><mi>j</mi><mo>,</mo><mi>d</mi></mrow><mi>s</mi></msubsup><mo>+</mo><msub><mi>R</mi><mi>d</mi></msub><msubsup><mi>ξ</mi><mrow><mi>t</mi><mo>,</mo><mi>d</mi></mrow><mi>s</mi></msubsup></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{equation}
\begin{aligned}
\ell_{t,d}^s &amp; = \alpha_{t,d}^s + \epsilon_{t,d}^s \\
\alpha_{t+1,d}^s &amp; = \sum\limits_{j=1}^{k} (-1)^{j+1} \binom{k}{j} \alpha_{t - j,d}^s  + R_d\xi_{t,d}^s
\end{aligned}  
\end{equation}</annotation></semantics></math> where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>α</mi><mrow><mi>t</mi><mo>,</mo><mi>d</mi></mrow><mrow><mi>s</mi><mo>,</mo><mtext mathvariant="normal">Trend</mtext></mrow></msubsup><mo>=</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>α</mi><mi>t</mi><mi>s</mi></msubsup><mo>,</mo><msubsup><mi>α</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow><mi>s</mi></msubsup><mo>,</mo><mi>…</mi><mo>,</mo><msubsup><mi>α</mi><mrow><mi>t</mi><mo>−</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>k</mi><mo>−</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mi>s</mi></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mi>⊤</mi></msup></mrow><annotation encoding="application/x-tex">\alpha_{t,d}^{s,\text{Trend}} = (\alpha_t^s,\alpha_{t-1}^s,\dots,\alpha_{t-(k-1)}^s)^{\top}</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>R</mi><mi>d</mi><mtext mathvariant="normal">Trend</mtext></msubsup><mo>=</mo><mtext mathvariant="normal">diag</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo>,</mo><mi>…</mi><mo>,</mo><mn>0</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">R_d^{\text{Trend}} = \textrm{diag}(1,0,0,\dots,0)</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>L</mi><mi>d</mi><mtext mathvariant="normal">Trend</mtext></msubsup><mo>=</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo>,</mo><mi>…</mi><mo>,</mo><mn>0</mn><mo stretchy="true" form="postfix">)</mo></mrow><mi>⊤</mi></msup></mrow><annotation encoding="application/x-tex">L_{d}^{\text{Trend}} = (1, 0, 0, \dots, 0)^{\top}</annotation></semantics></math>
is a vector of zeroes with a one in the first entry, and
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>A</mi><mi>d</mi><mtext mathvariant="normal">Trend</mtext></msubsup><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mrow><mo stretchy="true" form="prefix">(</mo><mfrac linethickness="0"><mi>k</mi><mn>1</mn></mfrac><mo stretchy="true" form="postfix">)</mo></mrow></mtd><mtd columnalign="center" style="text-align: center"><mo>−</mo><mrow><mo stretchy="true" form="prefix">(</mo><mfrac linethickness="0"><mi>k</mi><mn>2</mn></mfrac><mo stretchy="true" form="postfix">)</mo></mrow></mtd><mtd columnalign="center" style="text-align: center"><mi>…</mi></mtd><mtd columnalign="center" style="text-align: center"><msup><mrow><mo stretchy="true" form="prefix">(</mo><mo>−</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mi>j</mi><mo>+</mo><mn>1</mn></mrow></msup><mrow><mo stretchy="true" form="prefix">(</mo><mfrac linethickness="0"><mi>k</mi><mi>j</mi></mfrac><mo stretchy="true" form="postfix">)</mo></mrow></mtd><mtd columnalign="center" style="text-align: center"><mi>…</mi></mtd><mtd columnalign="center" style="text-align: center"><msup><mrow><mo stretchy="true" form="prefix">(</mo><mo>−</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mi>k</mi></msup><mrow><mo stretchy="true" form="prefix">(</mo><mfrac linethickness="0"><mi>k</mi><mrow><mi>k</mi><mo>−</mo><mn>1</mn></mrow></mfrac><mo stretchy="true" form="postfix">)</mo></mrow></mtd><mtd columnalign="center" style="text-align: center"><msup><mrow><mo stretchy="true" form="prefix">(</mo><mo>−</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msup><mrow><mo stretchy="true" form="prefix">(</mo><mfrac linethickness="0"><mi>k</mi><mi>k</mi></mfrac><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mi>…</mi></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mi>…</mi></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mi>…</mi></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mi>…</mi></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mi>⋮</mi></mtd><mtd columnalign="center" style="text-align: center"></mtd><mtd columnalign="center" style="text-align: center"></mtd><mtd columnalign="center" style="text-align: center"></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mi>…</mi></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mi>…</mi></mtd><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
A_{d}^{\text{Trend}} = \begin{pmatrix}
0 &amp; \binom{k}{1} &amp;  -\binom{k}{2} &amp; \dots &amp; (-1)^{j + 1} \binom{k}{j} &amp; \dots &amp; (-1)^{k} \binom{k}{k-1} &amp; (-1)^{k + 1} \binom{k}{k} \\
1 &amp; 0 &amp; 0 &amp; \dots &amp; 0 &amp; \dots &amp; 0 &amp; 0\\
0 &amp; 1 &amp; 0 &amp; \dots &amp; 0 &amp; \dots &amp; 0 &amp; 0\\
\vdots &amp; &amp; &amp; \\
0 &amp; 0 &amp; 0 &amp; \dots &amp; 0 &amp; \dots &amp; 1 &amp; 0\\
\end{pmatrix}
</annotation></semantics></math></p>
</div>
</blockquote>
<div class="callout-note">
<p><strong>Delvelopers</strong> The <em>Local trend of degree
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math></em>
encompasses both the constant trend when
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>R</mi><mi>d</mi></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">R_d = 0</annotation></semantics></math>
and the local linear trend when
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">k = 1</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>R</mi><mi>d</mi></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">R_d = 1</annotation></semantics></math>.
As this is the general option this is the one programmed.</p>
</div>
<blockquote>
<h4 id="seasonality">Seasonality</h4>
<p>There are two types of seasonality considered in this model:</p>
<ul>
<li><a href="#discrete-seasonality">Discrete</a></li>
<li><a href="#trigonometric-seasonality">Trigonometric</a></li>
</ul>
<h5 id="discrete-seasonality">Discrete seasonality</h5>
<p>We assume that there are
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>z</mi><annotation encoding="application/x-tex">z</annotation></semantics></math>
given seasons of length
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>l</mi><annotation encoding="application/x-tex">l</annotation></semantics></math>.
For example if
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>
represents days we can have
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>z</mi><mo>=</mo><mn>52</mn></mrow><annotation encoding="application/x-tex">z = 52</annotation></semantics></math>
(weekly) seasons each of length
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>7</mn><annotation encoding="application/x-tex">7</annotation></semantics></math>
(as each week contains
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>7</mn><annotation encoding="application/x-tex">7</annotation></semantics></math>
days). This is represented in the following baseline model:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><msubsup><mo>ℓ</mo><mrow><mi>t</mi><mo>,</mo><mi>d</mi></mrow><mi>s</mi></msubsup></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msubsup><mi>α</mi><mrow><mi>t</mi><mo>,</mo><mi>d</mi></mrow><mi>s</mi></msubsup><mo>+</mo><msubsup><mi>ϵ</mi><mrow><mi>t</mi><mo>,</mo><mi>d</mi></mrow><mi>s</mi></msubsup></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msubsup><mi>γ</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn><mo>,</mo><mi>d</mi></mrow><mi>s</mi></msubsup></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mo>−</mo><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>z</mi><mo>−</mo><mn>1</mn></mrow></munderover><msubsup><mi>γ</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn><mo>−</mo><mi>j</mi><mo>,</mo><mi>d</mi></mrow><mi>s</mi></msubsup><mo>+</mo><msub><mi>w</mi><mi>k</mi></msub></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msubsup><mi>α</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn><mo>,</mo><mi>d</mi></mrow><mi>s</mi></msubsup></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msubsup><mi>γ</mi><mrow><mo stretchy="false" form="prefix">⌈</mo><mfrac><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow><mi>l</mi></mfrac><mo stretchy="false" form="postfix">⌉</mo><mo>,</mo><mi>d</mi></mrow><mi>s</mi></msubsup></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{equation}
\begin{aligned}
\ell_{t,d}^s &amp; = \alpha_{t,d}^s + \epsilon_{t,d}^s \\
\gamma_{k+1,d}^s &amp; = - \sum\limits_{j=1}^{z-1} \gamma_{k+1-j, d}^s + w_k\\
\alpha_{t+1,d}^s &amp; = \gamma_{\lceil \frac{t+1}{l} \rceil,d}^s
\end{aligned}  
\end{equation}</annotation></semantics></math> where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>w</mi><mi>k</mi></msub><annotation encoding="application/x-tex">w_k</annotation></semantics></math>
is a gaussian white noise. This expression can be represented in matrix
form with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>L</mi><mi>d</mi><mtext mathvariant="normal">Season</mtext></msubsup><mo>=</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo>,</mo><mi>…</mi><mo>,</mo><mn>0</mn><mo stretchy="true" form="postfix">)</mo></mrow><mi>⊤</mi></msup></mrow><annotation encoding="application/x-tex">L_{d}^{\text{Season}} = (1,0,0,\dots,0)^{\top}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>R</mi><mi>d</mi></msub><mo>=</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo>,</mo><mi>…</mi><mo>,</mo><mn>0</mn><mo>,</mo><msub><mi>r</mi><mi>t</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>⊤</mi></msup></mrow><annotation encoding="application/x-tex">R_d = (0, 0, \dots, 0,r_t)^{\top}</annotation></semantics></math>
with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>r</mi><mi>t</mi></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">r_t = 1</annotation></semantics></math>
if
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mfrac><mi>t</mi><mi>l</mi></mfrac><annotation encoding="application/x-tex">\frac{t}{l}</annotation></semantics></math>
is an integer and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>0</mn><annotation encoding="application/x-tex">0</annotation></semantics></math>
otherwise. The vector
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>α</mi><mrow><mi>t</mi><mo>,</mo><mi>d</mi></mrow><mrow><mi>s</mi><mo>,</mo><mtext mathvariant="normal">Season</mtext></mrow></msubsup><annotation encoding="application/x-tex">\alpha_{t,d}^{s,\text{Season}}</annotation></semantics></math>
has length
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>z</mi><mi>l</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">z l + 1</annotation></semantics></math>.
It is defined initially for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>
such that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">⌈</mo><mi>t</mi><mi>/</mi><mi>l</mi><mo stretchy="false" form="postfix">⌉</mo><mo>=</mo><mi>z</mi></mrow><annotation encoding="application/x-tex">\lceil t/l \rceil = z</annotation></semantics></math></p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>α</mi><mrow><mi>t</mi><mo>,</mo><mi>d</mi></mrow><mrow><mi>s</mi><mo>,</mo><mtext mathvariant="normal">Season</mtext></mrow></msubsup><mo>=</mo><mo minsize="1.8" maxsize="1.8" stretchy="false" form="prefix">(</mo><munder><munder><mrow><msub><mi>γ</mi><mi>z</mi></msub><mo>,</mo><msub><mi>γ</mi><mi>z</mi></msub><mo>,</mo><mi>…</mi><mo>,</mo><msub><mi>γ</mi><mi>z</mi></msub></mrow><mo accent="true">⏟</mo></munder><mrow><mi>l</mi><mrow><mspace width="0.333em"></mspace><mtext mathvariant="normal"> times</mtext></mrow></mrow></munder><mo>,</mo><munder><munder><mrow><msub><mi>γ</mi><mrow><mi>z</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>,</mo><msub><mi>γ</mi><mrow><mi>z</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>,</mo><mi>…</mi><mo>,</mo><msub><mi>γ</mi><mrow><mi>z</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow><mo accent="true">⏟</mo></munder><mrow><mi>l</mi><mrow><mspace width="0.333em"></mspace><mtext mathvariant="normal"> times</mtext></mrow></mrow></munder><mo>,</mo><mi>…</mi><munder><munder><mrow><msub><mi>γ</mi><mn>1</mn></msub><mo>,</mo><mi>…</mi><mo>,</mo><msub><mi>γ</mi><mn>1</mn></msub></mrow><mo accent="true">⏟</mo></munder><mrow><mi>l</mi><mrow><mspace width="0.333em"></mspace><mtext mathvariant="normal"> times</mtext></mrow></mrow></munder><mo>,</mo><msub><mi>w</mi><mn>1</mn></msub><msup><mo minsize="1.8" maxsize="1.8" stretchy="false" form="postfix">)</mo><mi>⊤</mi></msup><mi>.</mi></mrow><annotation encoding="application/x-tex">
\alpha_{t,d}^{s,\text{Season}} = \Big( \underbrace{\gamma_{z}, \gamma_{z}, \dots,  \gamma_{z}}_{l\text{ times}},  \underbrace{\gamma_{z-1}, \gamma_{z-1},\dots,\gamma_{z-1}}_{l\text{ times}}, \dots \underbrace{\gamma_{1}, \dots, \gamma_{1}}_{l\text{ times}}, w_1 \Big)^{\top}.
</annotation></semantics></math></p>
<p>Matrix
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>A</mi><mi>d</mi><mtext mathvariant="normal">Season</mtext></msubsup><annotation encoding="application/x-tex">A_d^{\text{Season}}</annotation></semantics></math>
is given by the following expression:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mi>d</mi></msub><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mi>…</mi></mtd><mtd columnalign="center" style="text-align: center"><mo>−</mo><mn>1</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mi>…</mi></mtd><mtd columnalign="center" style="text-align: center"><mo>−</mo><mn>1</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mi>…</mi></mtd><mtd columnalign="center" style="text-align: center"><mo>−</mo><mn>1</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mi>…</mi></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mi>…</mi></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mi>…</mi></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mi>…</mi></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mi>…</mi></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mi>…</mi></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mi>…</mi></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mi>…</mi></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mi>…</mi></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd><mtd columnalign="center" style="text-align: center"><mi>…</mi></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mi>…</mi></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mi>…</mi></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mi>…</mi></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mi>⋮</mi></mtd><mtd columnalign="center" style="text-align: center"></mtd><mtd columnalign="center" style="text-align: center"></mtd><mtd columnalign="center" style="text-align: center"></mtd><mtd columnalign="center" style="text-align: center"></mtd><mtd columnalign="center" style="text-align: center"></mtd><mtd columnalign="center" style="text-align: center"></mtd><mtd columnalign="center" style="text-align: center"></mtd><mtd columnalign="center" style="text-align: center"><mi>⋮</mi></mtd><mtd columnalign="center" style="text-align: center"></mtd><mtd columnalign="center" style="text-align: center"></mtd><mtd columnalign="center" style="text-align: center"></mtd><mtd columnalign="center" style="text-align: center"></mtd><mtd columnalign="center" style="text-align: center"></mtd><mtd columnalign="center" style="text-align: center"><mi>⋮</mi></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mi>…</mi></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mi>…</mi></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mi>…</mi></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mi>…</mi></mtd><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mi>…</mi></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mi>…</mi></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mi>…</mi></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mi>…</mi></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
A_d = \begin{pmatrix}
0 &amp; 0 &amp; 0 &amp; \dots &amp; -1 &amp; 0  &amp; 0 &amp; \dots &amp; -1 &amp; 0 &amp; 0 &amp; \dots &amp; -1 &amp; 0 &amp; 0 &amp; \dots &amp; 0 &amp; 0 &amp; 1\\
1 &amp; 0 &amp; 0 &amp; \dots &amp; 0 &amp; 0 &amp; 0 &amp; \dots &amp; 0 &amp; 0 &amp; 0 &amp; \dots &amp; 0 &amp; 0 &amp; 0 &amp; \dots &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; 1 &amp; 0 &amp; \dots &amp; 0 &amp; 0 &amp; 0 &amp; \dots &amp; 0 &amp; 0 &amp; 0 &amp; \dots &amp; 0 &amp; 0 &amp; 0 &amp; \dots &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 1 &amp; \dots &amp; 0 &amp; 0 &amp; 0 &amp; \dots &amp; 0 &amp; 0 &amp; 0 &amp; \dots &amp; 0 &amp; 0 &amp; 0 &amp; \dots &amp; 0 &amp; 0 &amp; 0 \\
\vdots &amp; &amp;&amp;&amp; &amp;&amp;&amp;&amp; \vdots &amp;&amp;&amp;&amp;&amp;&amp; \vdots\\
0 &amp; 0 &amp; 0 &amp; \dots &amp; 0 &amp; 0 &amp; 0 &amp; \dots &amp; 0 &amp; 0 &amp; 0 &amp; \dots &amp; 0 &amp; 0 &amp; 0 &amp; \dots &amp; 1 &amp; 0 &amp; 0\\
0 &amp; 0 &amp; 0 &amp; \dots &amp; 0 &amp; 0 &amp; 0 &amp; \dots &amp; 0 &amp; 0 &amp; 0 &amp; \dots &amp; 0 &amp; 0 &amp; 0 &amp; \dots &amp; 0 &amp; 0 &amp; 1\\
\end{pmatrix}
</annotation></semantics></math> where the first row of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>A</mi><mi>d</mi></msub><annotation encoding="application/x-tex">A_d</annotation></semantics></math>
has a
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">-1</annotation></semantics></math>
every
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>l</mi><annotation encoding="application/x-tex">l</annotation></semantics></math>th
column starting from column
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>l</mi><annotation encoding="application/x-tex">l</annotation></semantics></math>
until column
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mo>×</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo>−</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">l\times (z-1)</annotation></semantics></math>.
The last entry of the first row of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>A</mi><mi>d</mi></msub><annotation encoding="application/x-tex">A_d</annotation></semantics></math>
is
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>1</mn><annotation encoding="application/x-tex">1</annotation></semantics></math>.
For the rest of the entries,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>A</mi><mi>d</mi></msub><annotation encoding="application/x-tex">A_d</annotation></semantics></math>
has zeroes except in the entries
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>A</mi><mrow><mi>i</mi><mo>,</mo><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msub><annotation encoding="application/x-tex">A_{i,i-1}</annotation></semantics></math>
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>&gt;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">i &gt; 1</annotation></semantics></math>)
where it has value
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>1</mn><annotation encoding="application/x-tex">1</annotation></semantics></math>.
And the last entry of the last row column of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>A</mi><mi>d</mi></msub><annotation encoding="application/x-tex">A_d</annotation></semantics></math>
is also
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>1</mn><annotation encoding="application/x-tex">1</annotation></semantics></math>.</p>
<h6 id="example">Example</h6>
<p>Consider a seasonality of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>z</mi><mo>=</mo><mn>3</mn></mrow><annotation encoding="application/x-tex">z = 3</annotation></semantics></math>
seasons each of length
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mo>=</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">l = 2</annotation></semantics></math>.
We then have
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>α</mi><mn>6</mn></msub><mo>=</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>γ</mi><mn>3</mn></msub><mo>,</mo><msub><mi>γ</mi><mn>3</mn></msub><mo>,</mo><msub><mi>γ</mi><mn>2</mn></msub><mo>,</mo><msub><mi>γ</mi><mn>2</mn></msub><mo>,</mo><msub><mi>γ</mi><mn>1</mn></msub><mo>,</mo><msub><mi>γ</mi><mn>1</mn></msub><mo>,</mo><mn>0</mn><mo stretchy="true" form="postfix">)</mo></mrow><mi>⊤</mi></msup></mrow><annotation encoding="application/x-tex">
\alpha_6 = (\gamma_3, \gamma_3, \gamma_2, \gamma_2, \gamma_1, \gamma_1, 0)^{\top}
</annotation></semantics></math> and
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mi>d</mi></msub><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mo>−</mo><mn>1</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mo>−</mo><mn>1</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
A_d = \begin{pmatrix}
0 &amp; -1 &amp; 0 &amp; -1 &amp; 0 &amp; 0 &amp; 1\\
1 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; 1 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 1 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; 1 &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; 0 &amp; 1 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 1 \\
\end{pmatrix}
</annotation></semantics></math> then:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>α</mi><mn>7</mn></msub><mo>=</mo><munder><munder><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mo>−</mo><mn>1</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mo>−</mo><mn>1</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mo accent="true">⏟</mo></munder><msub><mi>A</mi><mi>d</mi></msub></munder><munder><munder><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>γ</mi><mn>3</mn></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>γ</mi><mn>3</mn></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>γ</mi><mn>2</mn></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>γ</mi><mn>2</mn></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>γ</mi><mn>1</mn></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>γ</mi><mn>1</mn></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>w</mi><mn>1</mn></msub></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mo accent="true">⏟</mo></munder><msub><mi>α</mi><mn>6</mn></msub></munder><mo>+</mo><munder><munder><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mo accent="true">⏟</mo></munder><msub><mi>R</mi><mi>d</mi></msub></munder><msub><mi>ξ</mi><mrow><mn>6</mn><mo>,</mo><mi>d</mi></mrow></msub><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mo>−</mo><msub><mi>γ</mi><mn>3</mn></msub><mo>−</mo><msub><mi>γ</mi><mn>2</mn></msub><mo>+</mo><msub><mi>w</mi><mn>1</mn></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>γ</mi><mn>3</mn></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>γ</mi><mn>3</mn></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>γ</mi><mn>2</mn></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>γ</mi><mn>2</mn></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>γ</mi><mn>1</mn></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>w</mi><mn>1</mn></msub></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
\alpha_7 =\underbrace{\begin{pmatrix}
0 &amp; -1 &amp; 0 &amp; -1 &amp; 0 &amp; 0 &amp; 1\\
1 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; 1 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 1 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; 1 &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; 0 &amp; 1 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 1 \\
\end{pmatrix}}_{A_d}
\underbrace{\begin{pmatrix}
\gamma_3\\ 
\gamma_3\\ 
\gamma_2\\ 
\gamma_2\\ 
\gamma_1\\ 
\gamma_1\\
w_1 
\end{pmatrix}}_{ \alpha_6} +
\underbrace{\begin{pmatrix}
0 \\
0 \\
0 \\
0 \\
0 \\
0 \\
0 \\
\end{pmatrix}}_{R_d} \xi_{6,d}
= \begin{pmatrix}
-\gamma_3 - \gamma_2 + w_1\\ 
\gamma_3\\ 
\gamma_3\\ 
\gamma_2\\ 
\gamma_2\\ 
\gamma_1\\ 
w_1 
\end{pmatrix}
</annotation></semantics></math> Substituting
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>γ</mi><mn>4</mn></msub><mo>=</mo><mo>−</mo><msub><mi>γ</mi><mn>3</mn></msub><mo>−</mo><msub><mi>γ</mi><mn>2</mn></msub><mo>+</mo><msub><mi>w</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">\gamma_4 = -\gamma_3 - \gamma_2 + w_1</annotation></semantics></math>
we obtain that next component is:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>α</mi><mn>8</mn></msub><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mo>−</mo><mn>1</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mo>−</mo><mn>1</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>γ</mi><mn>4</mn></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>γ</mi><mn>3</mn></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>γ</mi><mn>3</mn></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>γ</mi><mn>2</mn></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>γ</mi><mn>2</mn></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>γ</mi><mn>1</mn></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>w</mi><mn>1</mn></msub></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><munder><munder><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mo accent="true">⏟</mo></munder><msub><mi>R</mi><mi>d</mi></msub></munder><msub><mi>ξ</mi><mrow><mn>7</mn><mo>,</mo><mi>d</mi></mrow></msub><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mo>−</mo><msub><mi>γ</mi><mn>3</mn></msub><mo>−</mo><msub><mi>γ</mi><mn>2</mn></msub><mo>+</mo><msub><mi>w</mi><mn>1</mn></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>γ</mi><mn>4</mn></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>γ</mi><mn>3</mn></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>γ</mi><mn>3</mn></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>γ</mi><mn>2</mn></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>γ</mi><mn>2</mn></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>w</mi><mn>1</mn></msub><mo>+</mo><msub><mi>ξ</mi><mrow><mn>7</mn><mo>,</mo><mi>d</mi></mrow></msub></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
\alpha_8 =\begin{pmatrix}
0 &amp; -1 &amp; 0 &amp; -1 &amp; 0 &amp; 0 &amp; 1\\
1 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; 1 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 1 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; 1 &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; 0 &amp; 1 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 1 \\
\end{pmatrix}
\begin{pmatrix}
\gamma_4 \\ 
\gamma_3\\ 
\gamma_3\\ 
\gamma_2\\ 
\gamma_2\\ 
\gamma_1\\ 
w_1 
\end{pmatrix} +
\underbrace{\begin{pmatrix}
0 \\
0 \\
0 \\
0 \\
0 \\
0 \\
1 \\
\end{pmatrix}}_{R_d} \xi_{7,d}
= \begin{pmatrix}
-\gamma_3 - \gamma_2 + w_1\\ 
\gamma_4 \\
\gamma_3\\ 
\gamma_3\\ 
\gamma_2\\ 
\gamma_2\\ 
w_1 + \xi_{7,d}
\end{pmatrix}
</annotation></semantics></math> defining
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mn>2</mn></msub><mo>=</mo><msub><mi>w</mi><mn>1</mn></msub><mo>+</mo><msub><mi>ξ</mi><mrow><mn>7</mn><mo>,</mo><mi>d</mi></mrow></msub></mrow><annotation encoding="application/x-tex">w_2 = w_1 + \xi_{7,d}</annotation></semantics></math>
and using the fact that the sum of independent gaussians is independent
from one of its summands we recover the original expression.</p>
<h5 id="trigonometric-seasonality">Trigonometric seasonality</h5>
<p>A different approach is to use harmonic functions. In particular, let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>l</mi><annotation encoding="application/x-tex">l</annotation></semantics></math>
define the period (number of time frames in a cycle) and define
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>λ</mi><mi>k</mi></msub><mo>=</mo><mfrac><mrow><mn>2</mn><mi>π</mi><mi>k</mi></mrow><mi>l</mi></mfrac></mrow><annotation encoding="application/x-tex">\lambda_k = \frac{2\pi k}{l}</annotation></semantics></math>
and use the following baseline model
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><msubsup><mo>ℓ</mo><mrow><mi>t</mi><mo>,</mo><mi>d</mi></mrow><mi>s</mi></msubsup></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msubsup><mi>α</mi><mrow><mi>t</mi><mo>,</mo><mi>d</mi></mrow><mi>s</mi></msubsup><mo>+</mo><msubsup><mi>ϵ</mi><mrow><mi>t</mi><mo>,</mo><mi>d</mi></mrow><mi>s</mi></msubsup></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msubsup><mi>α</mi><mrow><mi>t</mi><mo>,</mo><mi>d</mi></mrow><mi>s</mi></msubsup></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mrow><mo stretchy="false" form="prefix">⌊</mo><mfrac><mi>l</mi><mn>2</mn></mfrac><mo stretchy="false" form="postfix">⌋</mo></mrow></munderover><msubsup><mi>γ</mi><mrow><mi>t</mi><mo>,</mo><mi>d</mi></mrow><mrow><mi>s</mi><mo>,</mo><mi>j</mi></mrow></msubsup></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msubsup><mi>γ</mi><mrow><mi>t</mi><mo>,</mo><mi>d</mi></mrow><mrow><mi>s</mi><mo>,</mo><mi>j</mi></mrow></msubsup></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msubsup><mi>γ</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn><mo>,</mo><mi>d</mi></mrow><mrow><mi>s</mi><mo>,</mo><mi>j</mi></mrow></msubsup><mo>cos</mo><msub><mi>λ</mi><mi>j</mi></msub><mo>+</mo><msubsup><mover><mi>γ</mi><mo accent="true">̃</mo></mover><mrow><mi>t</mi><mo>,</mo><mi>d</mi></mrow><mrow><mi>s</mi><mo>,</mo><mi>j</mi></mrow></msubsup><mo>sin</mo><msub><mi>λ</mi><mi>j</mi></msub><mo>+</mo><msubsup><mi>w</mi><mrow><mi>t</mi><mo>,</mo><mi>d</mi></mrow><mrow><mi>s</mi><mo>,</mo><mi>j</mi></mrow></msubsup></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msubsup><mover><mi>γ</mi><mo accent="true">̃</mo></mover><mrow><mi>t</mi><mo>,</mo><mi>d</mi></mrow><mrow><mi>s</mi><mo>,</mo><mi>j</mi></mrow></msubsup></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mo>−</mo><msubsup><mi>γ</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn><mo>,</mo><mi>d</mi></mrow><mrow><mi>s</mi><mo>,</mo><mi>j</mi></mrow></msubsup><mo>sin</mo><msub><mi>λ</mi><mi>j</mi></msub><mo>+</mo><msubsup><mover><mi>γ</mi><mo accent="true">̃</mo></mover><mrow><mi>t</mi><mo>,</mo><mi>d</mi></mrow><mrow><mi>s</mi><mo>,</mo><mi>j</mi></mrow></msubsup><mo>cos</mo><msub><mi>λ</mi><mi>j</mi></msub><mo>+</mo><msubsup><mover><mi>w</mi><mo accent="true">̃</mo></mover><mrow><mi>t</mi><mo>,</mo><mi>d</mi></mrow><mrow><mi>s</mi><mo>,</mo><mi>j</mi></mrow></msubsup></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{equation}
\begin{aligned}
\ell_{t,d}^s &amp; = \alpha_{t,d}^s + \epsilon_{t,d}^s \\
\alpha_{t,d}^s &amp; = \sum\limits_{j=1}^{\lfloor \frac{l}{2} \rfloor} \gamma_{t,d}^{s,j}\\
\gamma_{t,d}^{s,j} &amp; = \gamma_{t-1,d}^{s,j}\cos\lambda_j + \tilde{\gamma}_{t,d}^{s,j}\sin\lambda_j + w_{t,d}^{s,j}\\
\tilde{\gamma}_{t,d}^{s,j} &amp; = -\gamma_{t-1,d}^{s,j}\sin\lambda_j + \tilde{\gamma}_{t,d}^{s,j}\cos\lambda_j + \tilde{w}_{t,d}^{s,j}\\
\end{aligned}  
\end{equation}</annotation></semantics></math> Following <span class="citation">Durbin and Koopman (2012)</span> we can write:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>α</mi><mrow><mi>t</mi><mo>,</mo><mi>d</mi></mrow><mi>s</mi></msubsup><mo>=</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>γ</mi><mrow><mi>t</mi><mo>,</mo><mi>d</mi></mrow><mrow><mi>s</mi><mo>,</mo><mn>1</mn></mrow></msubsup><mo>,</mo><msubsup><mover><mi>γ</mi><mo accent="true">̃</mo></mover><mrow><mi>t</mi><mo>,</mo><mi>d</mi></mrow><mrow><mi>s</mi><mo>,</mo><mn>1</mn></mrow></msubsup><mo>,</mo><msubsup><mi>γ</mi><mrow><mi>t</mi><mo>,</mo><mi>d</mi></mrow><mrow><mi>s</mi><mo>,</mo><mn>2</mn></mrow></msubsup><mo>,</mo><msubsup><mover><mi>γ</mi><mo accent="true">̃</mo></mover><mrow><mi>t</mi><mo>,</mo><mi>d</mi></mrow><mrow><mi>s</mi><mo>,</mo><mn>2</mn></mrow></msubsup><mo>,</mo><mi>…</mi><mo>,</mo><msubsup><mi>γ</mi><mrow><mi>t</mi><mo>,</mo><mi>d</mi></mrow><mrow><mi>s</mi><mo>,</mo><mi>l</mi></mrow></msubsup><mo>,</mo><msubsup><mover><mi>γ</mi><mo accent="true">̃</mo></mover><mrow><mi>t</mi><mo>,</mo><mi>d</mi></mrow><mrow><mi>s</mi><mo>,</mo><mi>l</mi></mrow></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mi>⊤</mi></msup></mrow><annotation encoding="application/x-tex">
\alpha_{t,d}^s = (\gamma_{t,d}^{s,1},\tilde{\gamma}_{t,d}^{s,1},\gamma_{t,d}^{s,2},\tilde{\gamma}_{t,d}^{s,2},\dots, \gamma_{t,d}^{s,l},\tilde{\gamma}_{t,d}^{s,l})^{\top}
</annotation></semantics></math> with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mi>d</mi></msub><mo>=</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo>,</mo><mn>0</mn><mo>,</mo><mi>…</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>⊤</mi></msup></mrow><annotation encoding="application/x-tex">L_d = (1,0,1,0,1,0,\dots)^{\top}</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>R</mi><mi>d</mi></msub><mo>=</mo><msub><mi>I</mi><mrow><mi>l</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">R_d = I_{l-1}</annotation></semantics></math>
the identity, and
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mi>d</mi></msub><mo>=</mo><mrow><mo stretchy="true" form="prefix">{</mo><mtable><mtr><mtd columnalign="left" style="text-align: left"><mtext mathvariant="normal">diag</mtext><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>C</mi><mn>1</mn></msub><mo>,</mo><msub><mi>C</mi><mn>2</mn></msub><mo>,</mo><mi>…</mi><mo>,</mo><msub><mi>C</mi><msup><mi>l</mi><mo>*</mo></msup></msub><mo>,</mo><mo>−</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mtd><mtd columnalign="left" style="text-align: left"><mrow><mtext mathvariant="normal">if </mtext><mspace width="0.333em"></mspace></mrow><mi>l</mi><mrow><mspace width="0.333em"></mspace><mtext mathvariant="normal"> is even,</mtext></mrow></mtd></mtr><mtr><mtd columnalign="left" style="text-align: left"><mtext mathvariant="normal">diag</mtext><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>C</mi><mn>1</mn></msub><mo>,</mo><msub><mi>C</mi><mn>2</mn></msub><mo>,</mo><mi>…</mi><mo>,</mo><msub><mi>C</mi><msup><mi>l</mi><mo>*</mo></msup></msub><mo stretchy="true" form="postfix">)</mo></mrow></mtd><mtd columnalign="left" style="text-align: left"><mrow><mtext mathvariant="normal">if </mtext><mspace width="0.333em"></mspace></mrow><mi>l</mi><mrow><mspace width="0.333em"></mspace><mtext mathvariant="normal"> is odd.</mtext></mrow></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">
A_d = \begin{cases}
\text{diag}(C_1, C_2, \dots, C_{l^*}, -1) &amp; \text{if } l \text{ is even,}\\
\text{diag}(C_1, C_2, \dots, C_{l^*}) &amp; \text{if } l \text{ is odd.}
\end{cases}
</annotation></semantics></math> where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>l</mi><mo>*</mo></msup><mo>=</mo><mo stretchy="false" form="prefix">⌊</mo><mi>z</mi><mi>/</mi><mn>2</mn><mo stretchy="false" form="postfix">⌋</mo></mrow><annotation encoding="application/x-tex">l^* = \lfloor z/2 \rfloor</annotation></semantics></math>
and
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>C</mi><mi>j</mi></msub><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mo>cos</mo><msub><mi>λ</mi><mi>j</mi></msub></mtd><mtd columnalign="center" style="text-align: center"><mo>sin</mo><msub><mi>λ</mi><mi>j</mi></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mo>−</mo><mo>sin</mo><msub><mi>λ</mi><mi>j</mi></msub></mtd><mtd columnalign="center" style="text-align: center"><mo>cos</mo><msub><mi>λ</mi><mi>j</mi></msub></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
C_j = \begin{pmatrix}
\cos \lambda_j &amp; \sin \lambda_j \\
- \sin \lambda_j &amp; \cos\lambda_j
\end{pmatrix}
</annotation></semantics></math></p>
<h5 id="multiple-seasons">Multiple seasons</h5>
<p>Multiple seasonalities can be adjusted into blocks to construct the
seasonal block:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><msubsup><mi>L</mi><mi>d</mi><mtext mathvariant="normal">Season</mtext></msubsup></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>L</mi><mi>d</mi><msub><mtext mathvariant="normal">Season</mtext><mn>1</mn></msub></msubsup><mo>,</mo><msubsup><mi>L</mi><mi>d</mi><msub><mtext mathvariant="normal">Season</mtext><mn>2</mn></msub></msubsup><mo>,</mo><mi>…</mi><mo>,</mo><msubsup><mi>L</mi><mi>d</mi><msub><mtext mathvariant="normal">Season</mtext><mi>k</mi></msub></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mi>⊤</mi></msup><mo>,</mo></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msubsup><mi>A</mi><mi>d</mi><mtext mathvariant="normal">Season</mtext></msubsup></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mtext mathvariant="normal">diag</mtext><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>A</mi><mi>d</mi><msub><mtext mathvariant="normal">Season</mtext><mn>1</mn></msub></msubsup><mo>,</mo><msubsup><mi>A</mi><mi>d</mi><msub><mtext mathvariant="normal">Season</mtext><mn>2</mn></msub></msubsup><mo>,</mo><mi>…</mi><mo>,</mo><msubsup><mi>A</mi><mi>d</mi><msub><mtext mathvariant="normal">Season</mtext><mi>k</mi></msub></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msubsup><mi>R</mi><mi>d</mi><mtext mathvariant="normal">Season</mtext></msubsup></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mtext mathvariant="normal">diag</mtext><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>R</mi><mi>d</mi><msub><mtext mathvariant="normal">Season</mtext><mn>1</mn></msub></msubsup><mo>,</mo><msubsup><mi>R</mi><mi>d</mi><msub><mtext mathvariant="normal">Season</mtext><mn>2</mn></msub></msubsup><mo>,</mo><mi>…</mi><mo>,</mo><msubsup><mi>R</mi><mi>d</mi><msub><mtext mathvariant="normal">Season</mtext><mi>k</mi></msub></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msubsup><mi>α</mi><mrow><mi>t</mi><mo>,</mo><mi>d</mi></mrow><mrow><mi>s</mi><mo>,</mo><mtext mathvariant="normal">Season</mtext></mrow></msubsup></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>α</mi><mrow><mi>t</mi><mo>,</mo><mi>d</mi></mrow><mrow><mi>s</mi><mo>,</mo><msub><mtext mathvariant="normal">Season</mtext><mn>1</mn></msub></mrow></msubsup><mo>,</mo><msubsup><mi>α</mi><mrow><mi>t</mi><mo>,</mo><mi>d</mi></mrow><mrow><mi>s</mi><mo>,</mo><msub><mtext mathvariant="normal">Season</mtext><mn>2</mn></msub></mrow></msubsup><mo>,</mo><mi>…</mi><mo>,</mo><msubsup><mi>α</mi><mrow><mi>t</mi><mo>,</mo><mi>d</mi></mrow><mrow><mi>s</mi><mo>,</mo><msub><mtext mathvariant="normal">Season</mtext><mi>k</mi></msub></mrow></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mi>⊤</mi></msup><mi>.</mi></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{equation}
\begin{aligned}
L_{d}^{\text{Season}} &amp; = \left(L_{d}^{\text{Season}_1}, L_{d}^{\text{Season}_2}, \dots, L_{d}^{\text{Season}_k} \right)^{\top}, \\
A_{d}^{\text{Season}} &amp; = \text{diag}\left(A_{d}^{\text{Season}_1}, A_{d}^{\text{Season}_2}, \dots, A_{d}^{\text{Season}_k}\right),\\
R_{d}^{\text{Season}} &amp; = \text{diag}\left(R_{d}^{\text{Season}_1}, R_{d}^{\text{Season}_2}, \dots, R_{d}^{\text{Season}_k}\right), \\
\alpha_{t,d}^{s,\text{Season}} &amp; = \left(\alpha_{t,d}^{s,\text{Season}_1}, \alpha_{t,d}^{s,\text{Season}_2}, \dots, \alpha_{t,d}^{s,\text{Season}_k}\right)^{\top}.
\end{aligned}
\end{equation}</annotation></semantics></math></p>
<p>which are then used in the definitions of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mi>d</mi></msub><mo>,</mo><msub><mi>A</mi><mi>d</mi></msub><mo>,</mo><msub><mi>R</mi><mi>d</mi></msub></mrow><annotation encoding="application/x-tex">L_d, A_d, R_d</annotation></semantics></math>,
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>α</mi><mrow><mi>t</mi><mo>,</mo><mi>d</mi></mrow><mi>s</mi></msubsup><annotation encoding="application/x-tex">\alpha_{t,d}^{s}</annotation></semantics></math>
respectively.</p>
</blockquote>
<blockquote>
<h4 id="cycle">Cycle</h4>
<p>Cycles represent fluctuations of rises and falls which are not of
fixed period. Usually they are of greater length than seasonal cycles.
For example an epidemic wave might be a cycle while daily effects are
seasonal. A cycle is modelled as trigonometric seasons with unknown
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>λ</mi><mi>c</mi></msub><annotation encoding="application/x-tex">\lambda_c</annotation></semantics></math>
and a damping factor
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ρ</mi><mi>c</mi></msub><annotation encoding="application/x-tex">\rho_c</annotation></semantics></math>.
Hence:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mi>d</mi></msub><mo>=</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>,</mo><mn>0</mn><mo stretchy="true" form="postfix">)</mo></mrow><mi>⊤</mi></msup><mo>,</mo><mspace width="1.0em"></mspace><msub><mi>A</mi><mi>d</mi></msub><mo>=</mo><msub><mi>C</mi><mi>c</mi></msub><mo>,</mo><mspace width="1.0em"></mspace><msub><mi>R</mi><mi>d</mi></msub><mo>=</mo><msub><mi>I</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">
L_d = (1,0)^{\top}, \quad A_d = C_c, \quad R_d = I_2
</annotation></semantics></math> with
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>C</mi><mi>c</mi></msub><mo>=</mo><msub><mi>ρ</mi><mi>c</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mo>cos</mo><msub><mi>λ</mi><mi>c</mi></msub></mtd><mtd columnalign="center" style="text-align: center"><mo>sin</mo><msub><mi>λ</mi><mi>c</mi></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mo>−</mo><mo>sin</mo><msub><mi>λ</mi><mi>c</mi></msub></mtd><mtd columnalign="center" style="text-align: center"><mo>cos</mo><msub><mi>λ</mi><mi>c</mi></msub></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
C_c = \rho_c \begin{pmatrix}
\cos \lambda_c &amp; \sin \lambda_c \\
-\sin\lambda_c &amp; \cos\lambda_c
\end{pmatrix}
</annotation></semantics></math></p>
</blockquote>
</div>
</div>
<div class="section level2">
<h2 id="examples">Examples<a class="anchor" aria-label="anchor" href="#examples"></a>
</h2>
<div class="section level3">
<h3 id="example-1-replicating-xxx-paper">Example 1 (replicating XXX paper)<a class="anchor" aria-label="anchor" href="#example-1-replicating-xxx-paper"></a>
</h3>
</div>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-durbin2012time" class="csl-entry">
Durbin, James, and Siem Jan Koopman. 2012. <em>Time Series Analysis by
State Space Methods</em>. Vol. 38. OUP Oxford.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by The package maintainer.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
